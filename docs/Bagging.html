<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Young Eun Jeon, Jeong-Wook Lee, and Jung-In Seo">

<title>12&nbsp; Bootstrap and Bagging – Time Series Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ensemble.html" rel="next">
<link href="./TBATS.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ef31e3f4d9d6eef55c54bdf6b9cd68ca.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Regression.html">Advanced Model</a></li><li class="breadcrumb-item"><a href="./Bagging.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JJJJYE/TS" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Autoregressive Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Seasonal Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DHR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Harmonic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./STLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">STLM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BSTS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dynamic Linear Model and Bayesian Structural Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TBATS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">TBATS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bagging.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ensemble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ensemble</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Neuron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Neural Network Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ML &amp; DL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Imputation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imputation using Kalman Smoothing</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#amtrak" id="toc-amtrak" class="nav-link active" data-scroll-target="#amtrak"><span class="header-section-number">12.1</span> Amtrak</a>
  <ul class="collapse">
  <li><a href="#데이터-불러오기" id="toc-데이터-불러오기" class="nav-link" data-scroll-target="#데이터-불러오기"><span class="header-section-number">12.1.1</span> 데이터 불러오기</a></li>
  <li><a href="#데이터-전처리" id="toc-데이터-전처리" class="nav-link" data-scroll-target="#데이터-전처리"><span class="header-section-number">12.1.2</span> 데이터 전처리</a></li>
  <li><a href="#데이터-분할" id="toc-데이터-분할" class="nav-link" data-scroll-target="#데이터-분할"><span class="header-section-number">12.1.3</span> 데이터 분할</a></li>
  </ul></li>
  <li><a href="#붓스트랩-시계열-생성" id="toc-붓스트랩-시계열-생성" class="nav-link" data-scroll-target="#붓스트랩-시계열-생성"><span class="header-section-number">12.2</span> 붓스트랩 시계열 생성</a></li>
  <li><a href="#배깅-기반의-시계열-예측" id="toc-배깅-기반의-시계열-예측" class="nav-link" data-scroll-target="#배깅-기반의-시계열-예측"><span class="header-section-number">12.3</span> 배깅 기반의 시계열 예측</a>
  <ul class="collapse">
  <li><a href="#ets-모형을-이용한-예측" id="toc-ets-모형을-이용한-예측" class="nav-link" data-scroll-target="#ets-모형을-이용한-예측"><span class="header-section-number">12.3.1</span> ETS 모형을 이용한 예측</a></li>
  <li><a href="#arima-모형을-이용한-예측" id="toc-arima-모형을-이용한-예측" class="nav-link" data-scroll-target="#arima-모형을-이용한-예측"><span class="header-section-number">12.3.2</span> ARIMA 모형을 이용한 예측</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Regression.html">Advanced Model</a></li><li class="breadcrumb-item"><a href="./Bagging.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="amtrak" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="amtrak"><span class="header-section-number">12.1</span> Amtrak</h2>
<p>예제 데이터로 사용하는 <code>"Amtrak.csv"</code>은 1991년 1월부터 2004년 3월까지 미국 철도 회사인 암트랙에서 제공한 월간 승객 수(단위 : 1,000명)가 기록되어져 있다.</p>
<section id="데이터-불러오기" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="데이터-불러오기"><span class="header-section-number">12.1.1</span> 데이터 불러오기</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"forecast"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"dplyr"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ggplot2"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"doParallel"</span>, <span class="st">"parallel"</span>)           <span class="co"># For 병렬 처리</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="at">cores=</span><span class="fu">detectCores</span>())            <span class="co"># 사용할 Core 개수 지정     </span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">".../Amtrak.csv"</span>)          <span class="co"># 데이터 불러오기</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 2
   Month      Ridership
   &lt;chr&gt;          &lt;dbl&gt;
 1 01/01/1991     1709.
 2 01/02/1991     1621.
 3 01/03/1991     1973.
 4 01/04/1991     1812.
 5 01/05/1991     1975.
 6 01/06/1991     1862.
 7 01/07/1991     1940.
 8 01/08/1991     2013.
 9 01/09/1991     1596.
10 01/10/1991     1725.
# ℹ 149 more rows</code></pre>
</div>
</div>
</section>
<section id="데이터-전처리" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="데이터-전처리"><span class="header-section-number">12.1.2</span> 데이터 전처리</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Convert to ts for Target</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ridership.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(Amtrak.data<span class="sc">$</span>Ridership, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">1</span>),            <span class="co"># 시계열의 시작 연도 / c(1991, 1) : 1991년 1월</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">12</span>)                <span class="co"># 주기 / 월별 시계열로 1년에 12번 관측</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridership.ts, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Ridership (in 000s)"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Caution!</code> CSV 파일로 불러온 데이터를 살펴보면 승객 수를 포함하는 변수 <code>Ridership</code>가 수치형임을 알 수 있다. 시계열 데이터 분석을 위해 함수 <code>ts()</code>를 이용하여 해당 변수를 시계열 객체로 변환해야 한다.<br>
<code>Result!</code> 시계열 그림을 살펴보면 <code>Amtrak</code> 데이터는 U자 형태의 추세를 발견할 수 있으며, 여름(7월과 8월) 동안에 승객이 급증하는 뚜렷한 계절변동도 볼 수 있다.</p>
</section>
<section id="데이터-분할" class="level3" data-number="12.1.3">
<h3 data-number="12.1.3" class="anchored" data-anchor-id="데이터-분할"><span class="header-section-number">12.1.3</span> 데이터 분할</h3>
<p><code>Caution!</code> 시계열 데이터 분석 시 모형의 과적합을 피하고 미래 데이터에 대한 예측력을 계산하기 위해 <code>Training Dataset</code>과 <code>Test Dataset</code>으로 분할해야 한다. 시계열 데이터의 경우, 시간에 의존하기 때문에 시간 순서를 고려하여 데이터를 분할해야 한다. 즉, 앞 시점의 데이터를 <code>Training Dataset</code>로 사용하여 모형을 구축하고, 뒷 시점의 데이터를 <code>Test Dataset</code>로 사용하여 구축된 모형의 성능을 평가한다. 여기서는 데이터 분할을 위해 함수 <code>window()</code>를 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition for Target</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>train.ts <span class="ot">&lt;-</span> <span class="fu">window</span>(ridership.ts, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">1</span>),            <span class="co"># 분할하고자 하는 시계열의 시작 연도 / c(1991, 1) : 1991년 1월</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">3</span>))              <span class="co"># 분할하고자 하는 시계열의 마지막 연도 / c(2001, 3) : 2001년 3월</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>test.ts <span class="ot">&lt;-</span> <span class="fu">window</span>(ridership.ts,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">4</span>))            <span class="co"># 분할하고자 하는 시계열의 시작 연도 / c(2001, 4) : 2001년 4월</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>nTrain   <span class="ot">&lt;-</span> <span class="fu">length</span>(train.ts)                      <span class="co"># Training Dataset의 데이터 포인트 개수</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>nTest   <span class="ot">&lt;-</span> <span class="fu">length</span>(test.ts)                        <span class="co"># Test Dataset의 데이터 포인트 개수</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>train.ts <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 123 × 1
       x
   &lt;dbl&gt;
 1 1709.
 2 1621.
 3 1973.
 4 1812.
 5 1975.
 6 1862.
 7 1940.
 8 2013.
 9 1596.
10 1725.
# ℹ 113 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test.ts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 1
       x
   &lt;dbl&gt;
 1 2024.
 2 2047.
 3 2073.
 4 2127.
 5 2203.
 6 1708.
 7 1951.
 8 1974.
 9 1985.
10 1760.
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nTrain</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>nTest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
</div>
</section>
</section>
<section id="붓스트랩-시계열-생성" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="붓스트랩-시계열-생성"><span class="header-section-number">12.2</span> 붓스트랩 시계열 생성</h2>
<ul>
<li><code>배깅(Bagging)</code>은 “Bootstrap Aggregation”의 약어로 예측 성능을 향상시키기 위해 머신러닝 분야에서 널리 사용하고 있는 기법이다.</li>
<li><code>배깅</code>은 Original Dataset으로부터 크기가 동일한 Bootstrap Dataset을 생성한 후, 각 Dataset에 독립적으로 모형 구축을 수행한다.
<ul>
<li>그러고나서, 각 모형의 예측 결과를 결합함으로써 예측 성능을 향상시킨다.</li>
</ul></li>
<li><code>배깅</code>의 장점은 예측 구간(Predictive Interval)을 생성할 수 있으며, 예측 성능을 향상시킬 수 있다는 점이다.</li>
<li>시계열에 <code>배깅</code> 기법을 적용하기 위해서 주의해야할 점은 Bootstrap Dataset을 생성할 때 <code>시계열의 의존성을 고려</code>해야 한다는 것이다.
<ul>
<li>일반적인 Bootstrap 기법은 Data Point가 서로 독립이라는 가정하에서 수행된다.</li>
<li>하지만 시계열은 의존성(의존 구조, 자기상관관계)이 존재하기 때문에 일반적인 Bootstrap 기법은 적용할 수 있다.</li>
<li>의존 구조를 가지는 Dataset에 적용할 수 있는 다양한 Bootstrap 기법이 있으며, 그중 Moving Block Bootstrap (MBB) 방법을 이용하고자 한다.</li>
<li>MBB 기법은 정상성 이외의 다른 모형 가정은 필요하지 않다는 장점이 있다.
<ul>
<li>실생활에서 관측되는 시계열은 추세 또는 계절성이 존재하는 비정상 시계열이므로 MBB를 적용하기 위해 <a href="https://isidl.com/wp-content/uploads/2017/06/E4026-ISIDL.pdf">Bergmeir et al.&nbsp;(2016)</a>은 새로운 아이디어를 제안했다.
<ol type="1">
<li>원 시계열에 Box-Cox 변환을 적용</li>
<li>변환된 시계열을 seasonal and trend decomposition using loess (STL) 또는 loess를 이용하여 추세(Trend), 계절성(Seasonal), 나머지(Remainder) 성분으로 분해</li>
<li>나머지 성분에 MBB 방법을 적용</li>
<li>생성한 붓스트랩 나머지 성분에 2번에서 분해된 추세와 계절성 성분을 더하여 새로운 시계열 생성</li>
<li>원래 스케일(Scale)로 역변환(1번에서 계산된 Box-Cox의 모수를 기반으로)</li>
</ol></li>
</ul></li>
</ul></li>
</ul>
<center>
<img src="./image/순서도_MBB.png" class="img-fluid" style="width:70.0%">
</center>
<p><br></p>
<ul>
<li><a href="https://isidl.com/wp-content/uploads/2017/06/E4026-ISIDL.pdf">Bergmeir et al.&nbsp;(2016)</a>에 의해 제안된 알고리듬은 package <code>"forecast"</code>에서 제공하는 함수 <code>bid.mbb.bootstrap()</code>를 통해 구현할 수 있다.
<ul>
<li><a href="https://github.com/robjhyndman/forecast/blob/master/R/bootstrap.R">함수 <code>bid.mbb.bootstrap()</code>에 대한 Github 참고</a></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)                                                  <span class="co"># Seed 고정 -&gt; 동일한 결과를 출력하기 위해</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>bootseries <span class="ot">&lt;-</span> <span class="fu">bld.mbb.bootstrap</span>(train.ts, <span class="dv">10</span>) <span class="sc">%&gt;%</span>             <span class="co"># 10개의 붓스트랩 시계열 생성 </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>                                         <span class="co"># Data Frame으로 변환</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="at">start =</span> <span class="dv">1991</span>, <span class="at">freq =</span> <span class="dv">12</span>)                                 <span class="co"># 시계열 객체 ts로 변환</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(train.ts, <span class="at">ylab =</span> <span class="st">"Bootstrapped series"</span>) <span class="sc">+</span>            <span class="co"># 원 시계열  </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(bootseries, <span class="at">colour =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>                      <span class="co"># 붓스트랩 시계열 </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(ridership.ts, <span class="at">colour =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>                   <span class="co"># 원 시계열을 한 번 더 지정해서 맨 앞으로 가져오기 </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="배깅-기반의-시계열-예측" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="배깅-기반의-시계열-예측"><span class="header-section-number">12.3</span> 배깅 기반의 시계열 예측</h2>
<ul>
<li>여기서는 붓스트랩 시계열에 예측 모형들을 적용하고, 그 예측 모형들로부터의 결과를 집약하여 하나의 예측 결과를 끌어내는 <code>배깅</code>을 이용하는 방법을 설명한다.</li>
<li>시계열에 대한 <code>배깅</code> 기법은 다음의 과정을 거쳐 예측을 수행한다.
<ol type="1">
<li>함수 <code>bid.mbb.bootstrap()</code>를 이용하여 <span class="math inline">\(B\)</span>개의 붓스트랩 시계열을 생성</li>
<li>각 붓스트랩 시계열에 대한 예측 모형을 생성
<ul>
<li><span class="math inline">\(B\)</span>개의 붓스트랩 시계열을 생성한 경우, <span class="math inline">\(B\)</span>개의 예측 모형을 생성할 수 있다.</li>
</ul></li>
<li>생성한 각 예측 모형에서 예측값을 계산
<ul>
<li>미래 특정 시점에 대해 <span class="math inline">\(B\)</span>개의 예측값이 생성된다.</li>
</ul></li>
<li><span class="math inline">\(B\)</span>개의 예측값에 대해 평균 또는 중앙값 등을 이용하여 최종 예측값을 계산<br>
</li>
</ol></li>
<li><code>배깅</code>을 이용하면 단일 예측모형보다 더 나은 예측 결과를 얻을 수 있다.</li>
</ul>
<section id="ets-모형을-이용한-예측" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="ets-모형을-이용한-예측"><span class="header-section-number">12.3.1</span> ETS 모형을 이용한 예측</h3>
<blockquote class="blockquote">
<p>다음은 각 붓스트랩 시계열에 ETS 예측 모형을 적용하여 예측을 수행하는 방법이다.</p>
</blockquote>
<p><code>Caution!</code> 신뢰할 수 있는 결과를 얻기 위해 생성하고자 하는 붓스트랩 데이터셋의 개수는 1000개 이상이 되어야 한다. 여기서는 예시를 위해, 10개의 붓스트랩 시계열을 생성하여 예측을 수행한다.</p>
<section id="ver.-1" class="level4" data-number="12.3.1.1">
<h4 data-number="12.3.1.1" class="anchored" data-anchor-id="ver.-1"><span class="header-section-number">12.3.1.1</span> Ver. 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 10개의 붓스트랩 시계열 생성</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)                                                  <span class="co"># Seed 고정 -&gt; 동일한 결과를 출력하기 위해</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">bld.mbb.bootstrap</span>(train.ts, <span class="dv">10</span>) <span class="sc">%&gt;%</span>                    <span class="co"># 10개의 붓스트랩 시계열 생성                 </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>                                         <span class="co"># Data Frame으로 변환</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="dv">1991</span>)                            <span class="co"># 시계열 객체 ts로 변환</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         structure.c.1708.917..1620.586..1972.715..1811.665..1974.964.. structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
Jan 1991                                                       1708.917                                                           1622.427
Feb 1991                                                       1620.586                                                           1692.925
Mar 1991                                                       1972.715                                                           1917.878
Apr 1991                                                       1811.665                                                           1927.051
May 1991                                                       1974.964                                                           1896.977
Jun 1991                                                       1862.356                                                           1860.024
Jul 1991                                                       1939.860                                                           1920.411
Aug 1991                                                       2013.264                                                           1988.003
Sep 1991                                                       1595.657                                                           1593.912
Oct 1991                                                       1724.924                                                           1778.545
Nov 1991                                                       1675.667                                                           1811.236
Dec 1991                                                       1813.863                                                           1880.393
Jan 1992                                                       1614.827                                                           1649.308
Feb 1992                                                       1557.088                                                           1526.239
Mar 1992                                                       1891.223                                                           1857.970
Apr 1992                                                       1955.981                                                           1825.309
May 1992                                                       1884.714                                                           1888.040
Jun 1992                                                       1623.042                                                           1861.262
Jul 1992                                                       1903.309                                                           1863.242
Aug 1992                                                       1996.712                                                           1956.475
Sep 1992                                                       1703.897                                                           1706.606
Oct 1992                                                       1810.000                                                           1820.205
Nov 1992                                                       1861.601                                                           1840.053
Dec 1992                                                       1875.122                                                           1909.621
Jan 1993                                                       1705.259                                                           1571.520
Feb 1993                                                       1618.535                                                           1591.936
Mar 1993                                                       1836.709                                                           1890.402
Apr 1993                                                       1957.043                                                           1914.140
May 1993                                                       1917.185                                                           1931.129
Jun 1993                                                       1882.398                                                           1867.962
Jul 1993                                                       1933.009                                                           1873.961
Aug 1993                                                       1996.167                                                           1983.379
Sep 1993                                                       1672.841                                                           1701.722
Oct 1993                                                       1752.827                                                           1856.806
Nov 1993                                                       1720.377                                                           1856.825
Dec 1993                                                       1734.292                                                           1808.348
Jan 1994                                                       1563.365                                                           1589.769
Feb 1994                                                       1573.959                                                           1505.010
Mar 1994                                                       1902.639                                                           1830.286
Apr 1994                                                       1833.888                                                           1843.636
May 1994                                                       1831.049                                                           1761.098
Jun 1994                                                       1775.755                                                           1753.302
Jul 1994                                                       1867.508                                                           1931.264
Aug 1994                                                       1906.608                                                           1961.799
Sep 1994                                                       1685.632                                                           1659.449
Oct 1994                                                       1778.546                                                           1804.432
Nov 1994                                                       1775.995                                                           1686.923
Dec 1994                                                       1783.350                                                           1781.791
Jan 1995                                                       1548.415                                                           1529.807
Feb 1995                                                       1496.925                                                           1509.739
Mar 1995                                                       1798.316                                                           1797.566
Apr 1995                                                       1732.895                                                           1780.642
May 1995                                                       1772.345                                                           1796.128
Jun 1995                                                       1761.207                                                           1720.286
Jul 1995                                                       1791.655                                                           1791.655
Aug 1995                                                       1874.820                                                           1874.820
Sep 1995                                                       1571.309                                                           1571.309
Oct 1995                                                       1646.948                                                           1646.948
Nov 1995                                                       1672.631                                                           1672.631
Dec 1995                                                       1656.845                                                           1656.845
Jan 1996                                                       1381.758                                                           1381.758
Feb 1996                                                       1360.852                                                           1360.852
Mar 1996                                                       1558.575                                                           1558.575
Apr 1996                                                       1608.420                                                           1608.420
May 1996                                                       1696.696                                                           1696.696
Jun 1996                                                       1693.183                                                           1693.183
Jul 1996                                                       1835.516                                                           1835.516
Aug 1996                                                       1942.573                                                           1942.573
Sep 1996                                                       1551.401                                                           1551.401
Oct 1996                                                       1686.508                                                           1686.508
Nov 1996                                                       1576.204                                                           1576.204
Dec 1996                                                       1700.433                                                           1700.433
Jan 1997                                                       1396.588                                                           1396.588
Feb 1997                                                       1371.690                                                           1371.690
Mar 1997                                                       1707.522                                                           1707.522
Apr 1997                                                       1654.604                                                           1654.604
May 1997                                                       1762.903                                                           1762.903
Jun 1997                                                       1775.800                                                           1775.800
Jul 1997                                                       1934.219                                                           1879.459
Aug 1997                                                       2008.055                                                           1873.554
Sep 1997                                                       1615.924                                                           1573.191
Oct 1997                                                       1773.910                                                           1728.875
Nov 1997                                                       1732.368                                                           1662.009
Dec 1997                                                       1796.626                                                           1766.769
Jan 1998                                                       1570.330                                                           1574.412
Feb 1998                                                       1412.691                                                           1567.474
Mar 1998                                                       1754.641                                                           1885.200
Apr 1998                                                       1824.932                                                           1808.399
May 1998                                                       1843.289                                                           1871.755
Jun 1998                                                       1825.964                                                           1793.652
Jul 1998                                                       1968.172                                                           1935.587
Aug 1998                                                       1921.645                                                           2005.900
Sep 1998                                                       1669.597                                                           1576.111
Oct 1998                                                       1791.474                                                           1741.790
Nov 1998                                                       1816.714                                                           1803.500
Dec 1998                                                       1846.754                                                           1824.824
Jan 1999                                                       1599.427                                                           1607.221
Feb 1999                                                       1548.804                                                           1588.800
Mar 1999                                                       1832.333                                                           1787.614
Apr 1999                                                       1839.720                                                           1849.404
May 1999                                                       1846.498                                                           1874.599
Jun 1999                                                       1864.852                                                           1859.175
Jul 1999                                                       1965.743                                                           1968.708
Aug 1999                                                       1949.002                                                           1953.762
Sep 1999                                                       1607.373                                                           1680.764
Oct 1999                                                       1803.664                                                           1843.693
Nov 1999                                                       1850.309                                                           1806.174
Dec 1999                                                       1836.435                                                           1901.017
Jan 2000                                                       1541.660                                                           1624.734
Feb 2000                                                       1616.928                                                           1566.973
Mar 2000                                                       1919.538                                                           1906.078
Apr 2000                                                       1971.493                                                           1814.823
May 2000                                                       1992.301                                                           1909.074
Jun 2000                                                       2009.763                                                           1927.685
Jul 2000                                                       2053.996                                                           2087.675
Aug 2000                                                       2097.471                                                           2173.090
Sep 2000                                                       1823.706                                                           1909.370
Oct 2000                                                       1976.997                                                           1964.622
Nov 2000                                                       1981.408                                                           1968.509
Dec 2000                                                       2000.153                                                           1905.106
Jan 2001                                                       1683.148                                                           1752.476
Feb 2001                                                       1663.404                                                           1647.207
Mar 2001                                                       2007.928                                                           1966.341
         structure.c.1678.35741584976..1681.4922251051..2030.56516157946.. structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
Jan 1991                                                          1678.357                                                          1679.091
Feb 1991                                                          1681.492                                                          1582.976
Mar 1991                                                          2030.565                                                          1854.153
Apr 1991                                                          1909.715                                                          1824.543
May 1991                                                          1707.672                                                          1948.536
Jun 1991                                                          1814.613                                                          1884.080
Jul 1991                                                          1953.030                                                          1977.161
Aug 1991                                                          2018.897                                                          2012.104
Sep 1991                                                          1664.064                                                          1662.339
Oct 1991                                                          1837.319                                                          1789.657
Nov 1991                                                          1792.579                                                          1751.282
Dec 1991                                                          1890.302                                                          1849.137
Jan 1992                                                          1601.081                                                          1594.626
Feb 1992                                                          1471.881                                                          1480.169
Mar 1992                                                          1902.656                                                          1759.681
Apr 1992                                                          1843.294                                                          1828.779
May 1992                                                          1902.050                                                          1913.314
Jun 1992                                                          1812.347                                                          1810.883
Jul 1992                                                          1948.720                                                          1862.454
Aug 1992                                                          2009.130                                                          2022.809
Sep 1992                                                          1652.774                                                          1691.644
Oct 1992                                                          1764.466                                                          1859.573
Nov 1992                                                          1744.186                                                          1831.273
Dec 1992                                                          1864.154                                                          1928.531
Jan 1993                                                          1687.119                                                          1617.655
Feb 1993                                                          1647.772                                                          1561.623
Mar 1993                                                          2011.240                                                          1907.212
Apr 1993                                                          1895.509                                                          1923.698
May 1993                                                          1698.584                                                          1917.891
Jun 1993                                                          1805.908                                                          1774.831
Jul 1993                                                          1944.706                                                          1885.784
Aug 1993                                                          2012.618                                                          1894.410
Sep 1993                                                          1659.830                                                          1670.687
Oct 1993                                                          1833.486                                                          1835.852
Nov 1993                                                          1789.146                                                          1807.466
Dec 1993                                                          1884.937                                                          1869.565
Jan 1994                                                          1593.784                                                          1681.975
Feb 1994                                                          1461.151                                                          1526.627
Mar 1994                                                          1888.494                                                          1604.728
Apr 1994                                                          1824.016                                                          1768.493
May 1994                                                          1877.655                                                          1839.089
Jun 1994                                                          1781.841                                                          1817.476
Jul 1994                                                          1912.104                                                          1904.024
Aug 1994                                                          1964.604                                                          2005.660
Sep 1994                                                          1600.339                                                          1650.166
Oct 1994                                                          1701.164                                                          1833.994
Nov 1994                                                          1670.018                                                          1776.053
Dec 1994                                                          1777.971                                                          1722.051
Jan 1995                                                          1588.923                                                          1603.123
Feb 1995                                                          1452.095                                                          1487.476
Mar 1995                                                          1728.915                                                          1804.590
Apr 1995                                                          1710.934                                                          1744.815
May 1995                                                          1837.092                                                          1765.814
Jun 1995                                                          1753.859                                                          1740.908
Jul 1995                                                          1864.888                                                          1753.852
Aug 1995                                                          1878.693                                                          1802.717
Sep 1995                                                          1556.252                                                          1433.929
Oct 1995                                                          1668.300                                                          1651.517
Nov 1995                                                          1653.503                                                          1677.050
Dec 1995                                                          1628.933                                                          1693.512
Jan 1996                                                          1398.977                                                          1476.946
Feb 1996                                                          1401.229                                                          1492.910
Mar 1996                                                          1635.065                                                          1687.493
Apr 1996                                                          1681.681                                                          1467.500
May 1996                                                          1745.835                                                          1664.799
Jun 1996                                                          1666.100                                                          1660.405
Jul 1996                                                          1826.137                                                          1798.654
Aug 1996                                                          1834.947                                                          1830.058
Sep 1996                                                          1490.499                                                          1567.830
Oct 1996                                                          1640.832                                                          1665.250
Nov 1996                                                          1530.071                                                          1724.462
Dec 1996                                                          1618.318                                                          1720.493
Jan 1997                                                          1434.740                                                          1396.521
Feb 1997                                                          1342.755                                                          1487.072
Mar 1997                                                          1736.512                                                          1732.076
Apr 1997                                                          1681.170                                                          1763.915
May 1997                                                          1735.585                                                          1723.959
Jun 1997                                                          1727.544                                                          1817.264
Jul 1997                                                          1786.679                                                          1875.023
Aug 1997                                                          1912.432                                                          1956.299
Sep 1997                                                          1647.110                                                          1594.113
Oct 1997                                                          1812.625                                                          1743.318
Nov 1997                                                          1823.076                                                          1745.173
Dec 1997                                                          1782.184                                                          1744.885
Jan 1998                                                          1571.190                                                          1486.986
Feb 1998                                                          1490.295                                                          1426.740
Mar 1998                                                          1819.434                                                          1806.552
Apr 1998                                                          1835.503                                                          1866.848
May 1998                                                          1755.685                                                          1930.585
Jun 1998                                                          1753.802                                                          1821.509
Jul 1998                                                          1937.678                                                          1902.990
Aug 1998                                                          1978.295                                                          1950.898
Sep 1998                                                          1686.027                                                          1616.993
Oct 1998                                                          1839.168                                                          1736.449
Nov 1998                                                          1729.816                                                          1834.961
Dec 1998                                                          1830.707                                                          1846.467
Jan 1999                                                          1584.744                                                          1617.332
Feb 1999                                                          1499.040                                                          1548.713
Mar 1999                                                          1827.695                                                          1862.706
Apr 1999                                                          1763.164                                                          1860.957
May 1999                                                          1859.851                                                          1787.161
Jun 1999                                                          1860.614                                                          1779.077
Jul 1999                                                          2006.899                                                          1956.752
Aug 1999                                                          2075.282                                                          1994.572
Sep 1999                                                          1677.697                                                          1699.509
Oct 1999                                                          1838.659                                                          1857.722
Nov 1999                                                          1800.092                                                          1753.442
Dec 1999                                                          1874.152                                                          1865.091
Jan 2000                                                          1657.656                                                          1629.886
Feb 2000                                                          1512.841                                                          1630.692
Mar 2000                                                          1867.616                                                          1939.396
Apr 2000                                                          1949.159                                                          1946.643
May 2000                                                          1978.768                                                          1986.300
Jun 2000                                                          1965.637                                                          1931.394
Jul 2000                                                          2112.039                                                          2060.708
Aug 2000                                                          2065.252                                                          2093.635
Sep 2000                                                          1812.944                                                          1842.987
Oct 2000                                                          1937.025                                                          1963.216
Nov 2000                                                          1964.469                                                          1888.650
Dec 2000                                                          1998.205                                                          1906.451
Jan 2001                                                          1754.572                                                          1733.525
Feb 2001                                                          1664.201                                                          1741.216
Mar 2001                                                          1952.834                                                          1985.800
         structure.c.1706.53385960804..1641.70380329126..1924.41014476705.. structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
Jan 1991                                                           1706.534                                                           1716.503
Feb 1991                                                           1641.704                                                           1597.001
Mar 1991                                                           1924.410                                                           1821.500
Apr 1991                                                           1905.629                                                           1914.582
May 1991                                                           1906.356                                                           1920.359
Jun 1991                                                           1858.348                                                           1901.518
Jul 1991                                                           1934.376                                                           1976.176
Aug 1991                                                           2040.498                                                           2071.011
Sep 1991                                                           1700.295                                                           1663.756
Oct 1991                                                           1747.889                                                           1769.028
Nov 1991                                                           1709.726                                                           1796.584
Dec 1991                                                           1806.682                                                           1813.211
Jan 1992                                                           1608.817                                                           1590.912
Feb 1992                                                           1502.965                                                           1573.266
Mar 1992                                                           1741.113                                                           1772.855
Apr 1992                                                           1851.792                                                           1841.191
May 1992                                                           1875.168                                                           1872.931
Jun 1992                                                           1873.024                                                           1863.905
Jul 1992                                                           1964.379                                                           1972.776
Aug 1992                                                           2072.764                                                           2020.843
Sep 1992                                                           1679.058                                                           1697.104
Oct 1992                                                           1837.640                                                           1808.275
Nov 1992                                                           1840.420                                                           1813.938
Dec 1992                                                           1828.862                                                           1833.825
Jan 1993                                                           1611.918                                                           1664.095
Feb 1993                                                           1615.044                                                           1612.079
Mar 1993                                                           1849.757                                                           1844.997
Apr 1993                                                           1887.459                                                           1814.068
May 1993                                                           1942.699                                                           1902.670
Jun 1993                                                           1849.527                                                           1893.662
Jul 1993                                                           1996.128                                                           1931.545
Aug 1993                                                           1992.976                                                           1909.901
Sep 1993                                                           1636.564                                                           1686.519
Oct 1993                                                           1778.238                                                           1791.697
Nov 1993                                                           1658.815                                                           1798.796
Dec 1993                                                           1738.153                                                           1774.617
Jan 1994                                                           1545.664                                                           1545.052
Feb 1994                                                           1538.174                                                           1543.999
Mar 1994                                                           1866.530                                                           1774.532
Apr 1994                                                           1918.339                                                           1819.598
May 1994                                                           1876.133                                                           1882.201
Jun 1994                                                           1837.440                                                           1799.234
Jul 1994                                                           1843.061                                                           1956.038
Aug 1994                                                           1974.220                                                           1956.482
Sep 1994                                                           1583.345                                                           1603.665
Oct 1994                                                           1789.385                                                           1745.516
Nov 1994                                                           1689.714                                                           1626.271
Dec 1994                                                           1849.061                                                           1706.215
Jan 1995                                                           1537.958                                                           1514.334
Feb 1995                                                           1508.444                                                           1502.656
Mar 1995                                                           1754.326                                                           1826.824
Apr 1995                                                           1763.999                                                           1868.433
May 1995                                                           1791.402                                                           1816.028
Jun 1995                                                           1695.419                                                           1766.505
Jul 1995                                                           1776.726                                                           1761.297
Aug 1995                                                           1797.698                                                           1883.674
Sep 1995                                                           1539.872                                                           1484.019
Oct 1995                                                           1709.816                                                           1608.633
Nov 1995                                                           1718.119                                                           1659.813
Dec 1995                                                           1680.020                                                           1621.352
Jan 1996                                                           1397.576                                                           1418.796
Feb 1996                                                           1344.844                                                           1405.738
Mar 1996                                                           1629.154                                                           1671.958
Apr 1996                                                           1622.923                                                           1719.922
May 1996                                                           1760.831                                                           1707.018
Jun 1996                                                           1691.660                                                           1636.546
Jul 1996                                                           1816.751                                                           1772.941
Aug 1996                                                           1847.705                                                           1722.963
Sep 1996                                                           1542.412                                                           1454.277
Oct 1996                                                           1655.025                                                           1636.581
Nov 1996                                                           1610.574                                                           1670.537
Dec 1996                                                           1632.273                                                           1739.199
Jan 1997                                                           1376.825                                                           1552.686
Feb 1997                                                           1415.983                                                           1441.353
Mar 1997                                                           1783.041                                                           1758.379
Apr 1997                                                           1822.258                                                           1663.794
May 1997                                                           1795.675                                                           1790.238
Jun 1997                                                           1726.460                                                           1690.321
Jul 1997                                                           1839.641                                                           1824.805
Aug 1997                                                           1880.624                                                           1910.777
Sep 1997                                                           1560.233                                                           1535.065
Oct 1997                                                           1793.940                                                           1730.530
Nov 1997                                                           1764.010                                                           1784.176
Dec 1997                                                           1814.106                                                           1776.366
Jan 1998                                                           1550.166                                                           1509.254
Feb 1998                                                           1518.736                                                           1488.906
Mar 1998                                                           1821.925                                                           1687.189
Apr 1998                                                           1830.578                                                           1738.204
May 1998                                                           1810.060                                                           1827.650
Jun 1998                                                           1787.400                                                           1826.817
Jul 1998                                                           1949.634                                                           1971.831
Aug 1998                                                           1937.484                                                           2080.604
Sep 1998                                                           1667.282                                                           1691.146
Oct 1998                                                           1768.856                                                           1825.928
Nov 1998                                                           1795.157                                                           1715.297
Dec 1998                                                           1746.211                                                           1837.246
Jan 1999                                                           1516.375                                                           1531.118
Feb 1999                                                           1437.391                                                           1499.040
Mar 1999                                                           1844.915                                                           1827.695
Apr 1999                                                           1889.750                                                           1763.164
May 1999                                                           1906.115                                                           1859.851
Jun 1999                                                           1890.645                                                           1860.614
Jul 1999                                                           2060.390                                                           2006.899
Aug 1999                                                           2006.190                                                           2075.282
Sep 1999                                                           1466.583                                                           1677.697
Oct 1999                                                           1762.656                                                           1838.659
Nov 1999                                                           1800.479                                                           1807.965
Dec 1999                                                           1873.534                                                           1862.014
Jan 2000                                                           1619.846                                                           1593.253
Feb 2000                                                           1644.304                                                           1544.705
Mar 2000                                                           1930.496                                                           1843.911
Apr 2000                                                           2009.216                                                           1934.187
May 2000                                                           2011.250                                                           2037.719
Jun 2000                                                           1889.466                                                           2030.621
Jul 2000                                                           2137.662                                                           2082.368
Aug 2000                                                           2129.888                                                           2104.249
Sep 2000                                                           1836.015                                                           1779.665
Oct 2000                                                           1969.672                                                           1890.469
Nov 2000                                                           1880.362                                                           1879.030
Dec 2000                                                           2049.427                                                           2024.771
Jan 2001                                                           1748.040                                                           1761.697
Feb 2001                                                           1729.952                                                           1733.421
Mar 2001                                                           1987.263                                                           2016.014
         structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1 structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
Jan 1991                                                            1679.091                                                           1678.357
Feb 1991                                                            1582.976                                                           1659.142
Mar 1991                                                            1854.153                                                           1922.314
Apr 1991                                                            1824.543                                                           1844.306
May 1991                                                            1920.349                                                           1876.054
Jun 1991                                                            1921.101                                                           1845.581
Jul 1991                                                            2049.940                                                           1882.285
Aug 1991                                                            2022.430                                                           1989.658
Sep 1991                                                            1656.617                                                           1705.957
Oct 1991                                                            1766.063                                                           1860.640
Nov 1991                                                            1732.828                                                           1860.258
Dec 1991                                                            1758.021                                                           1813.713
Jan 1992                                                            1617.095                                                           1597.066
Feb 1992                                                            1547.381                                                           1515.739
Mar 1992                                                            1861.927                                                           1844.448
Apr 1992                                                            1842.749                                                           1862.914
May 1992                                                            1891.539                                                           1785.492
Jun 1992                                                            1851.091                                                           1783.807
Jul 1992                                                            1973.526                                                           1967.880
Aug 1992                                                            1973.095                                                           2006.325
Sep 1992                                                            1673.320                                                           1711.884
Oct 1992                                                            1849.196                                                           1867.734
Nov 1992                                                            1776.930                                                           1761.091
Dec 1992                                                            1865.659                                                           1867.974
Jan 1993                                                            1600.773                                                           1628.004
Feb 1993                                                            1539.333                                                           1616.302
Mar 1993                                                            1835.377                                                           2011.240
Apr 1993                                                            1932.387                                                           1895.509
May 1993                                                            1930.842                                                           1698.584
Jun 1993                                                            1885.867                                                           1805.908
Jul 1993                                                            1961.760                                                           1944.706
Aug 1993                                                            2016.736                                                           2012.618
Sep 1993                                                            1687.470                                                           1659.830
Oct 1993                                                            1812.305                                                           1833.486
Nov 1993                                                            1742.887                                                           1789.146
Dec 1993                                                            1791.595                                                           1884.937
Jan 1994                                                            1590.293                                                           1593.784
Feb 1994                                                            1474.199                                                           1461.151
Mar 1994                                                            1818.910                                                           1888.494
Apr 1994                                                            1849.530                                                           1824.016
May 1994                                                            1844.784                                                           1877.655
Jun 1994                                                            1844.960                                                           1781.841
Jul 1994                                                            1908.913                                                           1912.104
Aug 1994                                                            1928.327                                                           1964.604
Sep 1994                                                            1625.749                                                           1600.339
Oct 1994                                                            1639.603                                                           1701.164
Nov 1994                                                            1673.879                                                           1670.018
Dec 1994                                                            1760.270                                                           1777.971
Jan 1995                                                            1473.324                                                           1588.923
Feb 1995                                                            1485.373                                                           1566.786
Mar 1995                                                            1775.471                                                           1808.118
Apr 1995                                                            1796.373                                                           1712.266
May 1995                                                            1810.526                                                           1861.748
Jun 1995                                                            1746.735                                                           1740.202
Jul 1995                                                            1839.997                                                           1861.419
Aug 1995                                                            1859.322                                                           1849.942
Sep 1995                                                            1534.008                                                           1535.684
Oct 1995                                                            1622.599                                                           1653.671
Nov 1995                                                            1666.748                                                           1594.025
Dec 1995                                                            1688.187                                                           1606.423
Jan 1996                                                            1369.659                                                           1341.676
Feb 1996                                                            1302.417                                                           1374.301
Mar 1996                                                            1669.346                                                           1734.826
Apr 1996                                                            1718.331                                                           1765.409
May 1996                                                            1689.562                                                           1730.193
Jun 1996                                                            1581.626                                                           1652.365
Jul 1996                                                            1800.813                                                           1756.932
Aug 1996                                                            1842.336                                                           1793.542
Sep 1996                                                            1563.337                                                           1468.780
Oct 1996                                                            1665.752                                                           1700.715
Nov 1996                                                            1713.810                                                           1669.014
Dec 1996                                                            1677.498                                                           1720.434
Jan 1997                                                            1497.907                                                           1457.820
Feb 1997                                                            1357.273                                                           1432.364
Mar 1997                                                            1729.973                                                           1724.091
Apr 1997                                                            1734.796                                                           1757.274
May 1997                                                            1808.065                                                           1825.345
Jun 1997                                                            1766.042                                                           1687.464
Jul 1997                                                            1881.556                                                           1872.920
Aug 1997                                                            1934.877                                                           1927.180
Sep 1997                                                            1603.492                                                           1645.671
Oct 1997                                                            1741.642                                                           1767.374
Nov 1997                                                            1714.100                                                           1756.885
Dec 1997                                                            1817.608                                                           1789.215
Jan 1998                                                            1568.750                                                           1530.794
Feb 1998                                                            1454.724                                                           1496.492
Mar 1998                                                            1734.667                                                           1776.224
Apr 1998                                                            1801.369                                                           1843.823
May 1998                                                            1883.507                                                           1869.315
Jun 1998                                                            1780.878                                                           1758.081
Jul 1998                                                            1832.251                                                           1850.819
Aug 1998                                                            1994.779                                                           1971.765
Sep 1998                                                            1665.787                                                           1703.932
Oct 1998                                                            1831.007                                                           1768.866
Nov 1998                                                            1799.998                                                           1698.074
Dec 1998                                                            1891.263                                                           1841.308
Jan 1999                                                            1557.513                                                           1586.981
Feb 1999                                                            1494.551                                                           1580.640
Mar 1999                                                            1789.073                                                           1844.765
Apr 1999                                                            1892.018                                                           1871.988
May 1999                                                            1896.407                                                           1864.766
Jun 1999                                                            1861.349                                                           1843.870
Jul 1999                                                            1947.158                                                           1967.323
Aug 1999                                                            2013.015                                                           1906.968
Sep 1999                                                            1694.631                                                           1627.347
Oct 1999                                                            1832.873                                                           1827.227
Nov 1999                                                            1776.862                                                           1810.091
Dec 1999                                                            1842.957                                                           1881.521
Jan 2000                                                            1659.041                                                           1677.579
Feb 2000                                                            1559.634                                                           1543.795
Mar 2000                                                            1921.034                                                           1923.348
Apr 2000                                                            1965.625                                                           1931.960
May 2000                                                            1974.851                                                           2009.017
Jun 2000                                                            1985.133                                                           1965.254
Jul 2000                                                            2059.193                                                           2079.028
Aug 2000                                                            2088.430                                                           2129.434
Sep 2000                                                            1795.674                                                           1795.131
Oct 2000                                                            1819.889                                                           1933.388
Nov 2000                                                            1864.526                                                           1905.953
Dec 2000                                                            1960.636                                                           2012.201
Jan 2001                                                            1771.741                                                           1766.080
Feb 2001                                                            1768.180                                                           1655.429
Mar 2001                                                            2089.283                                                           2016.014
         structure.c.1749.43655465283..1627.75975450604..1938.84571798435.. structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
Jan 1991                                                           1749.437                                                           1708.708
Feb 1991                                                           1627.760                                                           1627.215
Mar 1991                                                           1938.846                                                           1928.335
Apr 1991                                                           1876.787                                                           1915.532
May 1991                                                           1916.161                                                           1940.967
Jun 1991                                                           1864.956                                                           1828.921
Jul 1991                                                           1925.845                                                           1946.391
Aug 1991                                                           1948.833                                                           2033.563
Sep 1991                                                           1600.716                                                           1633.460
Oct 1991                                                           1795.521                                                           1797.026
Nov 1991                                                           1838.500                                                           1723.810
Dec 1991                                                           1801.824                                                           1739.657
Jan 1992                                                           1451.300                                                           1570.662
Feb 1992                                                           1456.045                                                           1584.688
Mar 1992                                                           1813.865                                                           1916.801
Apr 1992                                                           1858.474                                                           1853.166
May 1992                                                           1924.284                                                           1855.443
Jun 1992                                                           1935.966                                                           1806.260
Jul 1992                                                           1978.278                                                           1904.124
Aug 1992                                                           2040.613                                                           1951.134
Sep 1992                                                           1618.404                                                           1738.067
Oct 1992                                                           1832.627                                                           1841.848
Nov 1992                                                           1763.949                                                           1850.163
Dec 1992                                                           1819.859                                                           1869.533
Jan 1993                                                           1611.600                                                           1646.612
Feb 1993                                                           1505.697                                                           1603.488
Mar 1993                                                           1875.653                                                           1913.247
Apr 1993                                                           1915.579                                                           1850.662
May 1993                                                           1976.381                                                           1892.948
Jun 1993                                                           1934.154                                                           1882.435
Jul 1993                                                           1954.820                                                           1913.508
Aug 1993                                                           2026.759                                                           2001.860
Sep 1993                                                           1660.036                                                           1703.535
Oct 1993                                                           1804.568                                                           1785.708
Nov 1993                                                           1803.722                                                           1707.581
Dec 1993                                                           1820.877                                                           1703.964
Jan 1994                                                           1638.393                                                           1561.955
Feb 1994                                                           1547.490                                                           1561.236
Mar 1994                                                           1761.484                                                           1846.693
Apr 1994                                                           1889.182                                                           1877.749
May 1994                                                           1856.687                                                           1969.375
Jun 1994                                                           1832.105                                                           1814.769
Jul 1994                                                           1892.920                                                           1703.615
Aug 1994                                                           1959.673                                                           1914.262
Sep 1994                                                           1639.942                                                           1627.524
Oct 1994                                                           1720.106                                                           1771.229
Nov 1994                                                           1687.833                                                           1733.367
Dec 1994                                                           1702.355                                                           1819.770
Jan 1995                                                           1532.035                                                           1543.003
Feb 1995                                                           1538.441                                                           1556.580
Mar 1995                                                           1862.932                                                           1808.118
Apr 1995                                                           1783.982                                                           1712.266
May 1995                                                           1770.944                                                           1861.748
Jun 1995                                                           1704.820                                                           1740.202
Jul 1995                                                           1785.744                                                           1861.419
Aug 1995                                                           1816.062                                                           1849.942
Sep 1995                                                           1586.305                                                           1535.684
Oct 1995                                                           1672.508                                                           1653.671
Nov 1995                                                           1663.246                                                           1588.591
Dec 1995                                                           1669.694                                                           1645.593
Jan 1996                                                           1403.298                                                           1334.872
Feb 1996                                                           1368.437                                                           1357.326
Mar 1996                                                           1647.609                                                           1707.563
Apr 1996                                                           1714.039                                                           1745.294
May 1996                                                           1738.361                                                           1793.044
Jun 1996                                                           1624.448                                                           1670.519
Jul 1996                                                           1714.505                                                           1812.794
Aug 1996                                                           1833.735                                                           1830.265
Sep 1996                                                           1564.187                                                           1538.913
Oct 1996                                                           1629.447                                                           1679.825
Nov 1996                                                           1558.981                                                           1559.768
Dec 1996                                                           1704.496                                                           1638.162
Jan 1997                                                           1452.451                                                           1467.413
Feb 1997                                                           1453.289                                                           1413.922
Mar 1997                                                           1737.623                                                           1746.403
Apr 1997                                                           1801.400                                                           1782.490
May 1997                                                           1767.303                                                           1721.168
Jun 1997                                                           1719.682                                                           1749.995
Jul 1997                                                           1883.682                                                           1866.872
Aug 1997                                                           1967.152                                                           1957.594
Sep 1997                                                           1662.610                                                           1637.352
Oct 1997                                                           1769.322                                                           1759.962
Nov 1997                                                           1685.461                                                           1738.450
Dec 1997                                                           1748.211                                                           1823.491
Jan 1998                                                           1531.337                                                           1537.408
Feb 1998                                                           1382.994                                                           1466.823
Mar 1998                                                           1734.797                                                           1793.103
Apr 1998                                                           1792.258                                                           1690.597
May 1998                                                           1866.455                                                           1773.595
Jun 1998                                                           1854.839                                                           1788.012
Jul 1998                                                           2022.953                                                           1943.809
Aug 1998                                                           2005.726                                                           2029.482
Sep 1998                                                           1698.003                                                           1766.023
Oct 1998                                                           1720.471                                                           1819.071
Nov 1998                                                           1798.887                                                           1820.754
Dec 1998                                                           1771.033                                                           1753.656
Jan 1999                                                           1542.677                                                           1597.331
Feb 1999                                                           1524.704                                                           1487.481
Mar 1999                                                           1763.905                                                           1802.031
Apr 1999                                                           1828.608                                                           1826.953
May 1999                                                           1906.452                                                           1794.407
Jun 1999                                                           1896.108                                                           1814.012
Jul 1999                                                           2020.427                                                           1971.405
Aug 1999                                                           1995.074                                                           2061.754
Sep 1999                                                           1705.662                                                           1757.905
Oct 1999                                                           1800.194                                                           1810.694
Nov 1999                                                           1825.035                                                           1897.388
Dec 1999                                                           1772.776                                                           1877.066
Jan 2000                                                           1686.728                                                           1612.398
Feb 2000                                                           1600.650                                                           1573.048
Mar 2000                                                           1894.683                                                           1870.744
Apr 2000                                                           1940.817                                                           1876.934
May 2000                                                           1900.155                                                           2027.264
Jun 2000                                                           1874.789                                                           1964.967
Jul 2000                                                           1960.627                                                           2096.933
Aug 2000                                                           2122.554                                                           2129.343
Sep 2000                                                           1853.289                                                           1825.504
Oct 2000                                                           1968.541                                                           1954.625
Nov 2000                                                           1995.939                                                           1956.900
Dec 2000                                                           2096.948                                                           1943.045
Jan 2001                                                           1751.672                                                           1723.803
Feb 2001                                                           1490.385                                                           1729.989
Mar 2001                                                           1961.036                                                           1967.763</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 각 붓스트랩 시계열에 대해 ETS 모형 적용</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fit.ets <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">function</span>(x) <span class="fu">ets</span>(x))                         <span class="co"># 함수 ets() : ETS 모형</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fit.ets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$structure.c.1708.917..1620.586..1972.715..1811.665..1974.964..
ETS(M,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.555 
    gamma = 1e-04 

  Initial states:
    l = 1807.9214 
    s = 27.0154 -11.2593 0.0101 -121.9422 199.759 149.5166
           37.7252 75.4579 59.7349 47.1898 -252.1883 -211.019

  sigma:  0.0342

     AIC     AICc      BIC 
1615.746 1620.232 1657.929 

$structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
ETS(A,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5886 
    gamma = 1e-04 

  Initial states:
    l = 1820.029 
    s = 48.0044 -4.4051 13.9424 -120.4869 199.0255 136.4745
           39.6509 63.2035 27.5956 44.533 -242.9376 -204.6001

  sigma:  51.7915

     AIC     AICc      BIC 
1578.053 1582.539 1620.236 

$structure.c.1678.35741584976..1681.4922251051..2030.56516157946..
ETS(M,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5722 
    gamma = 1e-04 

  Initial states:
    l = 1812.414 
    s = 39.244 -27.3364 18.7412 -124.4246 205.6108 158.6663
           30.0723 61.1789 40.0399 66.2689 -275.0331 -193.0281

  sigma:  0.0328

     AIC     AICc      BIC 
1605.062 1609.548 1647.245 

$structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
ETS(A,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.4037 
    gamma = 1e-04 

  Initial states:
    l = 1814.2406 
    s = 44.3045 8.6347 20.3252 -130.2983 187.9671 125.5879
           29.6437 76.5735 36.8099 30.0867 -243.3027 -186.3322

  sigma:  61.4745

     AIC     AICc      BIC 
1620.217 1624.703 1662.400 

$structure.c.1706.53385960804..1641.70380329126..1924.41014476705..
ETS(A,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5625 
    gamma = 1e-04 

  Initial states:
    l = 1815.808 
    s = 19.9874 -28.3351 8.237 -151.7746 199.1433 162.3617
           42.0646 101.0539 84.9383 43.7667 -253.8362 -227.607

  sigma:  56.2798

     AIC     AICc      BIC 
1598.498 1602.984 1640.681 

$structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
ETS(M,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5721 
    gamma = 1e-04 

  Initial states:
    l = 1820.7088 
    s = 19.1546 -11.981 -0.1149 -142.6133 208.2123 154.9857
           60.502 95.5317 38.9393 24.3711 -242.5745 -204.4131

  sigma:  0.0288

     AIC     AICc      BIC 
1572.530 1577.016 1614.713 

$structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1
ETS(A,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5689 
    gamma = 1e-04 

  Initial states:
    l = 1815.0945 
    s = 31.7731 -22.3832 -8.8311 -127.947 198.5839 157.5626
           54.5011 100.5841 75.694 34.8147 -287.9225 -206.4299

  sigma:  44.521

     AIC     AICc      BIC 
1540.842 1545.328 1583.025 

$structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
ETS(M,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.4525 
    gamma = 1e-04 

  Initial states:
    l = 1814.3012 
    s = 39.3974 -21.8034 18.4249 -127.9589 181.3757 137.2188
           14.3669 70.7385 65.8784 75.874 -252.1677 -201.3446

  sigma:  0.0302

     AIC     AICc      BIC 
1585.353 1589.839 1627.536 

$structure.c.1749.43655465283..1627.75975450604..1938.84571798435..
ETS(A,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5507 
    gamma = 1e-04 

  Initial states:
    l = 1809.207 
    s = 7.2392 -17.0861 -3.0939 -108.8207 201.9181 150.1434
           47.653 93.2531 77.755 32.4511 -270.4003 -211.0119

  sigma:  60.6588

     AIC     AICc      BIC 
1616.931 1621.417 1659.114 

$structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
ETS(M,N,A) 

Call:
 ets(y = x) 

  Smoothing parameters:
    alpha = 0.5731 
    gamma = 2e-04 

  Initial states:
    l = 1814.7208 
    s = 5.4728 -21.6853 12.0212 -98.8551 205.6608 131.325
           36.4825 91.0304 38.7781 61.0381 -245.1723 -216.0964

  sigma:  0.0312

     AIC     AICc      BIC 
1592.930 1597.416 1635.112 </code></pre>
</div>
</div>
<p><code>Caution!</code> ETS 모형 생성은 함수 <code>ets()</code>를 이용하며 각 붓스트랩 시계열에 ETS 모형을 적용하기 위해 함수 <code>lapply()</code>를 이용할 수 있다. 해당 함수는 붓스트랩 시계열 각각에 함수 <code>ets()</code>를 적용하며 리스트 형태로 출력한다.<br>
게다가, 맥(Mac)에서는 package <code>"parallel"</code>에서 제공하는 함수 <code>mclapply()</code>를 이용하면 병렬 처리가 가능하며, 옵션 <code>mc.core</code>에 사용할 코어 개수를 지정할 수 있다.<br>
<code>Result!</code> 총 10개의 ETS 예측 모형이 생성된 것을 알 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 예측</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>start  <span class="ot">&lt;-</span> <span class="fu">tsp</span>(train.ts)[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>                               <span class="co"># tsp(time series)[2] : Last Date +1/12 = First Date in Forecast</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 3-1. 각 ETS 모형의 예측 결과 생성</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fc  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(fit.ets, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>              <span class="cf">function</span>(x){ </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">forecast</span>(x, <span class="at">h =</span> nTest)[[<span class="st">"mean"</span>]]              <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                }) <span class="sc">%&gt;%</span>  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>                                         <span class="co"># Data Frame으로 변환</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> start)                           <span class="co"># 시계열 객체 ts로 변환</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>fc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         structure.c.1708.917..1620.586..1972.715..1811.665..1974.964.. structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
Apr 2001                                                       2003.205                                                           1944.027
May 2001                                                       2018.952                                                           1979.631
Jun 2001                                                       1981.205                                                           1956.072
Jul 2001                                                       2092.997                                                           2052.898
Aug 2001                                                       2143.241                                                           2115.450
Sep 2001                                                       1821.540                                                           1795.938
Oct 2001                                                       1943.494                                                           1930.367
Nov 2001                                                       1932.226                                                           1912.019
Dec 2001                                                       1970.498                                                           1964.421
Jan 2002                                                       1732.468                                                           1711.829
Feb 2002                                                       1691.293                                                           1673.494
Mar 2002                                                       1990.676                                                           1960.962
Apr 2002                                                       2003.205                                                           1944.027
May 2002                                                       2018.952                                                           1979.631
Jun 2002                                                       1981.205                                                           1956.072
Jul 2002                                                       2092.997                                                           2052.898
Aug 2002                                                       2143.241                                                           2115.450
Sep 2002                                                       1821.540                                                           1795.938
Oct 2002                                                       1943.494                                                           1930.367
Nov 2002                                                       1932.226                                                           1912.019
Dec 2002                                                       1970.498                                                           1964.421
Jan 2003                                                       1732.468                                                           1711.829
Feb 2003                                                       1691.293                                                           1673.494
Mar 2003                                                       1990.676                                                           1960.962
Apr 2003                                                       2003.205                                                           1944.027
May 2003                                                       2018.952                                                           1979.631
Jun 2003                                                       1981.205                                                           1956.072
Jul 2003                                                       2092.997                                                           2052.898
Aug 2003                                                       2143.241                                                           2115.450
Sep 2003                                                       1821.540                                                           1795.938
Oct 2003                                                       1943.494                                                           1930.367
Nov 2003                                                       1932.226                                                           1912.019
Dec 2003                                                       1970.498                                                           1964.421
Jan 2004                                                       1732.468                                                           1711.829
Feb 2004                                                       1691.293                                                           1673.494
Mar 2004                                                       1990.676                                                           1960.962
         structure.c.1678.35741584976..1681.4922251051..2030.56516157946.. structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
Apr 2001                                                          1951.591                                                          1981.128
May 2001                                                          1972.709                                                          2020.901
Jun 2001                                                          1941.636                                                          1973.971
Jul 2001                                                          2070.234                                                          2069.911
Aug 2001                                                          2117.171                                                          2132.285
Sep 2001                                                          1787.134                                                          1814.026
Oct 2001                                                          1930.298                                                          1964.648
Nov 2001                                                          1884.231                                                          1952.954
Dec 2001                                                          1950.804                                                          1988.624
Jan 2002                                                          1718.543                                                          1757.993
Feb 2002                                                          1636.527                                                          1701.028
Mar 2002                                                          1977.830                                                          1974.410
Apr 2002                                                          1951.591                                                          1981.128
May 2002                                                          1972.709                                                          2020.901
Jun 2002                                                          1941.636                                                          1973.971
Jul 2002                                                          2070.234                                                          2069.911
Aug 2002                                                          2117.171                                                          2132.285
Sep 2002                                                          1787.134                                                          1814.026
Oct 2002                                                          1930.298                                                          1964.648
Nov 2002                                                          1884.231                                                          1952.954
Dec 2002                                                          1950.804                                                          1988.624
Jan 2003                                                          1718.543                                                          1757.993
Feb 2003                                                          1636.527                                                          1701.028
Mar 2003                                                          1977.830                                                          1974.410
Apr 2003                                                          1951.591                                                          1981.128
May 2003                                                          1972.709                                                          2020.901
Jun 2003                                                          1941.636                                                          1973.971
Jul 2003                                                          2070.234                                                          2069.911
Aug 2003                                                          2117.171                                                          2132.285
Sep 2003                                                          1787.134                                                          1814.026
Oct 2003                                                          1930.298                                                          1964.648
Nov 2003                                                          1884.231                                                          1952.954
Dec 2003                                                          1950.804                                                          1988.624
Jan 2004                                                          1718.543                                                          1757.993
Feb 2004                                                          1636.527                                                          1701.028
Mar 2004                                                          1977.830                                                          1974.410
         structure.c.1706.53385960804..1641.70380329126..1924.41014476705.. structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
Apr 2001                                                           2045.434                                                           2021.504
May 2001                                                           2061.554                                                           2078.087
Jun 2001                                                           2002.567                                                           2043.057
Jul 2001                                                           2122.865                                                           2137.546
Aug 2001                                                           2159.645                                                           2190.763
Sep 2001                                                           1808.731                                                           1839.945
Oct 2001                                                           1968.740                                                           1982.435
Nov 2001                                                           1932.169                                                           1970.575
Dec 2001                                                           1980.497                                                           2001.725
Jan 2002                                                           1732.907                                                           1778.152
Feb 2002                                                           1706.667                                                           1739.980
Mar 2002                                                           2004.265                                                           2006.922
Apr 2002                                                           2045.434                                                           2021.504
May 2002                                                           2061.554                                                           2078.087
Jun 2002                                                           2002.567                                                           2043.057
Jul 2002                                                           2122.865                                                           2137.546
Aug 2002                                                           2159.645                                                           2190.763
Sep 2002                                                           1808.731                                                           1839.945
Oct 2002                                                           1968.740                                                           1982.435
Nov 2002                                                           1932.169                                                           1970.575
Dec 2002                                                           1980.497                                                           2001.725
Jan 2003                                                           1732.907                                                           1778.152
Feb 2003                                                           1706.667                                                           1739.980
Mar 2003                                                           2004.265                                                           2006.922
Apr 2003                                                           2045.434                                                           2021.504
May 2003                                                           2061.554                                                           2078.087
Jun 2003                                                           2002.567                                                           2043.057
Jul 2003                                                           2122.865                                                           2137.546
Aug 2003                                                           2159.645                                                           2190.763
Sep 2003                                                           1808.731                                                           1839.945
Oct 2003                                                           1968.740                                                           1982.435
Nov 2003                                                           1932.169                                                           1970.575
Dec 2003                                                           1980.497                                                           2001.725
Jan 2004                                                           1732.907                                                           1778.152
Feb 2004                                                           1706.667                                                           1739.980
Mar 2004                                                           2004.265                                                           2006.922
         structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1 structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
Apr 2001                                                            2110.640                                                           2002.758
May 2001                                                            2135.537                                                           2007.625
Jun 2001                                                            2089.457                                                           1951.256
Jul 2001                                                            2192.516                                                           2074.107
Aug 2001                                                            2233.537                                                           2118.264
Sep 2001                                                            1907.014                                                           1808.928
Oct 2001                                                            2026.113                                                           1955.311
Nov 2001                                                            2012.567                                                           1915.083
Dec 2001                                                            2066.729                                                           1976.290
Jan 2002                                                            1828.534                                                           1735.550
Feb 2002                                                            1747.042                                                           1684.724
Mar 2002                                                            2069.768                                                           2012.761
Apr 2002                                                            2110.640                                                           2002.758
May 2002                                                            2135.537                                                           2007.625
Jun 2002                                                            2089.457                                                           1951.256
Jul 2002                                                            2192.516                                                           2074.107
Aug 2002                                                            2233.537                                                           2118.264
Sep 2002                                                            1907.014                                                           1808.928
Oct 2002                                                            2026.113                                                           1955.311
Nov 2002                                                            2012.567                                                           1915.083
Dec 2002                                                            2066.729                                                           1976.290
Jan 2003                                                            1828.534                                                           1735.550
Feb 2003                                                            1747.042                                                           1684.724
Mar 2003                                                            2069.768                                                           2012.761
Apr 2003                                                            2110.640                                                           2002.758
May 2003                                                            2135.537                                                           2007.625
Jun 2003                                                            2089.457                                                           1951.256
Jul 2003                                                            2192.516                                                           2074.107
Aug 2003                                                            2233.537                                                           2118.264
Sep 2003                                                            1907.014                                                           1808.928
Oct 2003                                                            2026.113                                                           1955.311
Nov 2003                                                            2012.567                                                           1915.083
Dec 2003                                                            2066.729                                                           1976.290
Jan 2004                                                            1828.534                                                           1735.550
Feb 2004                                                            1747.042                                                           1684.724
Mar 2004                                                            2069.768                                                           2012.761
         structure.c.1749.43655465283..1627.75975450604..1938.84571798435.. structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
Apr 2001                                                           1978.931                                                           1968.874
May 2001                                                           1994.439                                                           2021.115
Jun 2001                                                           1948.845                                                           1966.562
Jul 2001                                                           2051.318                                                           2061.412
Aug 2001                                                           2103.103                                                           2135.746
Sep 2001                                                           1792.361                                                           1831.243
Oct 2001                                                           1898.095                                                           1942.113
Nov 2001                                                           1884.104                                                           1908.413
Dec 2001                                                           1908.430                                                           1935.556
Jan 2002                                                           1690.177                                                           1714.015
Feb 2002                                                           1630.765                                                           1684.919
Mar 2002                                                           1933.643                                                           1991.120
Apr 2002                                                           1978.931                                                           1968.874
May 2002                                                           1994.439                                                           2021.115
Jun 2002                                                           1948.845                                                           1966.562
Jul 2002                                                           2051.318                                                           2061.412
Aug 2002                                                           2103.103                                                           2135.746
Sep 2002                                                           1792.361                                                           1831.243
Oct 2002                                                           1898.095                                                           1942.113
Nov 2002                                                           1884.104                                                           1908.413
Dec 2002                                                           1908.430                                                           1935.556
Jan 2003                                                           1690.177                                                           1714.015
Feb 2003                                                           1630.765                                                           1684.919
Mar 2003                                                           1933.643                                                           1991.120
Apr 2003                                                           1978.931                                                           1968.874
May 2003                                                           1994.439                                                           2021.115
Jun 2003                                                           1948.845                                                           1966.562
Jul 2003                                                           2051.318                                                           2061.412
Aug 2003                                                           2103.103                                                           2135.746
Sep 2003                                                           1792.361                                                           1831.243
Oct 2003                                                           1898.095                                                           1942.113
Nov 2003                                                           1884.104                                                           1908.413
Dec 2003                                                           1908.430                                                           1935.556
Jan 2004                                                           1690.177                                                           1714.015
Feb 2004                                                           1630.765                                                           1684.919
Mar 2004                                                           1933.643                                                           1991.120</code></pre>
</div>
</div>
<p><code>Result!</code> 위에서 생성한 10개의 ETS 예측 모형 각각에 대해 예측값이 생성된 것을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(train.ts) <span class="sc">+</span>                                          <span class="co"># 원 시계열  </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(sim, <span class="at">colour =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>                             <span class="co"># 붓스트랩 시계열  </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc, <span class="at">colour =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>                              <span class="co"># 특정 시점까지의 예측값</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(train.ts, <span class="at">colour =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>                       <span class="co"># 원 시계열을 한 번 더 지정해서 맨 앞으로 가져오기 </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bootrstrapped series"</span>) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 평균을 이용한 최종 예측 </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(fc, <span class="dv">1</span>, mean)                                            <span class="co"># 중앙값일 경우, mean -&gt; median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357 1740.017 1689.644 1992.236 2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357
[22] 1740.017 1689.644 1992.236 2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357 1740.017 1689.644 1992.236</code></pre>
</div>
</div>
</section>
<section id="ver.-2" class="level4" data-number="12.3.1.2">
<h4 data-number="12.3.1.2" class="anchored" data-anchor-id="ver.-2"><span class="header-section-number">12.3.1.2</span> Ver. 2</h4>
<p><code>Caution!</code> 붓스트랩 시계열을 생성하고 각각에 ETS 예측 모형을 생성하는 과정은 함수 <code>baggedETS()</code>를 통해 수행할 수 있다. 예를 들어, 10개의 붓스트랩 시계열 각각에 대해 ETS 예측 모형을 생성하는 코드 <code>lapply(bld.mbb.bootstrap(train.ts, 10), function(x){ets(x)})</code>은<br>
<code>baggedETS(train.ts, bld.mbb.bootstrap(train.ts, 10))</code>와 동일하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-4번 : 10개의 붓스트랩 시계열을 생성하고 각각에 ETS 예측 모형을 생성한 후 예측</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)                                                  <span class="co"># Seed 고정 -&gt; 동일한 결과를 출력하기 위해</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>baggedfc <span class="ot">&lt;-</span> train.ts <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">baggedETS</span>(<span class="fu">bld.mbb.bootstrap</span>(train.ts, <span class="dv">10</span>)) <span class="sc">%&gt;%</span>              <span class="co"># 10개의 붓스트랩 시계열을 생성한 후, 각각에 ETS 예측 모형 생성    </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> nTest)                                         <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>baggedfc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast   Lo 100   Hi 100
Apr 2001       2000.809 1944.027 2110.640
May 2001       2029.055 1972.709 2135.537
Jun 2001       1985.463 1941.636 2089.457
Jul 2001       2092.580 2051.318 2192.516
Aug 2001       2144.920 2103.103 2233.537
Sep 2001       1820.686 1787.134 1907.014
Oct 2001       1954.161 1898.095 2026.113
Nov 2001       1930.434 1884.104 2012.567
Dec 2001       1974.357 1908.430 2066.729
Jan 2002       1740.017 1690.177 1828.534
Feb 2002       1689.644 1630.765 1747.042
Mar 2002       1992.236 1933.643 2069.768
Apr 2002       2000.809 1944.027 2110.640
May 2002       2029.055 1972.709 2135.537
Jun 2002       1985.463 1941.636 2089.457
Jul 2002       2092.580 2051.318 2192.516
Aug 2002       2144.920 2103.103 2233.537
Sep 2002       1820.686 1787.134 1907.014
Oct 2002       1954.161 1898.095 2026.113
Nov 2002       1930.434 1884.104 2012.567
Dec 2002       1974.357 1908.430 2066.729
Jan 2003       1740.017 1690.177 1828.534
Feb 2003       1689.644 1630.765 1747.042
Mar 2003       1992.236 1933.643 2069.768
Apr 2003       2000.809 1944.027 2110.640
May 2003       2029.055 1972.709 2135.537
Jun 2003       1985.463 1941.636 2089.457
Jul 2003       2092.580 2051.318 2192.516
Aug 2003       2144.920 2103.103 2233.537
Sep 2003       1820.686 1787.134 1907.014
Oct 2003       1954.161 1898.095 2026.113
Nov 2003       1930.434 1884.104 2012.567
Dec 2003       1974.357 1908.430 2066.729
Jan 2004       1740.017 1690.177 1828.534
Feb 2004       1689.644 1630.765 1747.042
Mar 2004       1992.236 1933.643 2069.768</code></pre>
</div>
</div>
<p><code>Result!</code> 결과에서 <code>Point Forecast</code>는 특정 시점에서의 붓스트랩 예측값들의 평균이며, 위의 “Ver.1”에서 “4. 평균을 이용한 최종 예측”과 결과가 동일하다. <code>Lo 100</code>은 특정 시점에서의 붓스트랩 예측값들의 최솟값, <code>Hi 100</code>는 특정 시점에서의 붓스트랩 예측값들의 최댓값을 의미한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서 각 붓스트랩 시계열의 예측값</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>forecasts_boot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
 [1,] 2003.205 1944.027 1951.591 1981.128 2045.434 2021.504 2110.640 2002.758 1978.931 1968.874
 [2,] 2018.952 1979.631 1972.709 2020.901 2061.554 2078.087 2135.537 2007.625 1994.439 2021.115
 [3,] 1981.205 1956.072 1941.636 1973.971 2002.567 2043.057 2089.457 1951.256 1948.845 1966.562
 [4,] 2092.997 2052.898 2070.234 2069.911 2122.865 2137.546 2192.516 2074.107 2051.318 2061.412
 [5,] 2143.241 2115.450 2117.171 2132.285 2159.645 2190.763 2233.537 2118.264 2103.103 2135.746
 [6,] 1821.540 1795.938 1787.134 1814.026 1808.731 1839.945 1907.014 1808.928 1792.361 1831.243
 [7,] 1943.494 1930.367 1930.298 1964.648 1968.740 1982.435 2026.113 1955.311 1898.095 1942.113
 [8,] 1932.226 1912.019 1884.231 1952.954 1932.169 1970.575 2012.567 1915.083 1884.104 1908.413
 [9,] 1970.498 1964.421 1950.804 1988.624 1980.497 2001.725 2066.729 1976.290 1908.430 1935.556
[10,] 1732.468 1711.829 1718.543 1757.993 1732.907 1778.152 1828.534 1735.550 1690.177 1714.015
[11,] 1691.293 1673.494 1636.527 1701.028 1706.667 1739.980 1747.042 1684.724 1630.765 1684.919
[12,] 1990.676 1960.962 1977.830 1974.410 2004.265 2006.922 2069.768 2012.761 1933.643 1991.120
[13,] 2003.205 1944.027 1951.591 1981.128 2045.434 2021.504 2110.640 2002.758 1978.931 1968.874
[14,] 2018.952 1979.631 1972.709 2020.901 2061.554 2078.087 2135.537 2007.625 1994.439 2021.115
[15,] 1981.205 1956.072 1941.636 1973.971 2002.567 2043.057 2089.457 1951.256 1948.845 1966.562
[16,] 2092.997 2052.898 2070.234 2069.911 2122.865 2137.546 2192.516 2074.107 2051.318 2061.412
[17,] 2143.241 2115.450 2117.171 2132.285 2159.645 2190.763 2233.537 2118.264 2103.103 2135.746
[18,] 1821.540 1795.938 1787.134 1814.026 1808.731 1839.945 1907.014 1808.928 1792.361 1831.243
[19,] 1943.494 1930.367 1930.298 1964.648 1968.740 1982.435 2026.113 1955.311 1898.095 1942.113
[20,] 1932.226 1912.019 1884.231 1952.954 1932.169 1970.575 2012.567 1915.083 1884.104 1908.413
[21,] 1970.498 1964.421 1950.804 1988.624 1980.497 2001.725 2066.729 1976.290 1908.430 1935.556
[22,] 1732.468 1711.829 1718.543 1757.993 1732.907 1778.152 1828.534 1735.550 1690.177 1714.015
[23,] 1691.293 1673.494 1636.527 1701.028 1706.667 1739.980 1747.042 1684.724 1630.765 1684.919
[24,] 1990.676 1960.962 1977.830 1974.410 2004.265 2006.922 2069.768 2012.761 1933.643 1991.120
[25,] 2003.205 1944.027 1951.591 1981.128 2045.434 2021.504 2110.640 2002.758 1978.931 1968.874
[26,] 2018.952 1979.631 1972.709 2020.901 2061.554 2078.087 2135.537 2007.625 1994.439 2021.115
[27,] 1981.205 1956.072 1941.636 1973.971 2002.567 2043.057 2089.457 1951.256 1948.845 1966.562
[28,] 2092.997 2052.898 2070.234 2069.911 2122.865 2137.546 2192.516 2074.107 2051.318 2061.412
[29,] 2143.241 2115.450 2117.171 2132.285 2159.645 2190.763 2233.537 2118.264 2103.103 2135.746
[30,] 1821.540 1795.938 1787.134 1814.026 1808.731 1839.945 1907.014 1808.928 1792.361 1831.243
[31,] 1943.494 1930.367 1930.298 1964.648 1968.740 1982.435 2026.113 1955.311 1898.095 1942.113
[32,] 1932.226 1912.019 1884.231 1952.954 1932.169 1970.575 2012.567 1915.083 1884.104 1908.413
[33,] 1970.498 1964.421 1950.804 1988.624 1980.497 2001.725 2066.729 1976.290 1908.430 1935.556
[34,] 1732.468 1711.829 1718.543 1757.993 1732.907 1778.152 1828.534 1735.550 1690.177 1714.015
[35,] 1691.293 1673.494 1636.527 1701.028 1706.667 1739.980 1747.042 1684.724 1630.765 1684.919
[36,] 1990.676 1960.962 1977.830 1974.410 2004.265 2006.922 2069.768 2012.761 1933.643 1991.120</code></pre>
</div>
</div>
<p><code>Result!</code> 열 번호는 생성된 10개의 붓스트랩 시계열 각각을 의미하며, 각 열의 값들은 특정 시점까지 붓스트랩 시계열에 대한 예측값이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서 붓스트랩 예측값들의 평균</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357
2002 1740.017 1689.644 1992.236 2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357
2003 1740.017 1689.644 1992.236 2000.809 2029.055 1985.463 2092.580 2144.920 1820.686 1954.161 1930.434 1974.357
2004 1740.017 1689.644 1992.236                                                                                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서 붓스트랩 예측값들의 중앙값</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            1991.943 2019.926 1970.267 2072.170 2134.016 1811.477 1949.403 1923.626 1973.394
2002 1732.687 1688.106 1990.898 1991.943 2019.926 1970.267 2072.170 2134.016 1811.477 1949.403 1923.626 1973.394
2003 1732.687 1688.106 1990.898 1991.943 2019.926 1970.267 2072.170 2134.016 1811.477 1949.403 1923.626 1973.394
2004 1732.687 1688.106 1990.898                                                                                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Predictive Interval</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>boot.pred <span class="ot">&lt;-</span> <span class="fu">t</span>(baggedfc<span class="sc">$</span>forecasts_boot)                       <span class="co"># 특정 시점에서 각 붓스트랩 시계열의 예측값</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>PI.pred   <span class="ot">&lt;-</span> <span class="fu">apply</span>(boot.pred, <span class="dv">2</span>, <span class="cf">function</span>(x) { <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>) ) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Result!</code> 95% 예측 구간은 붓스트랩 시계열에 대한 예측값들의 분위수를 계산하여 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Results for 95% Predictive Interval </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">"PI.lower"</span> <span class="ot">=</span> PI.pred[<span class="dv">1</span>,], <span class="st">"PI.upper"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,], </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"length of PI"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,]<span class="sc">-</span>PI.pred[<span class="dv">1</span>,]) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   PI.lower PI.upper length.of.PI
      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1    1946.    2096.         150.
 2    1974.    2123.         148.
 3    1943.    2079.         136.
 4    2052.    2180.         128.
 5    2106.    2224.         118.
 6    1788.    1892.         104.
 7    1905.    2016.         111.
 8    1884.    2003.         119.
 9    1915.    2052.         138.
10    1695.    1817.         122.
# ℹ 26 more rows</code></pre>
</div>
</div>
</section>
<section id="예측-결과-비교" class="level4" data-number="12.3.1.3">
<h4 data-number="12.3.1.3" class="anchored" data-anchor-id="예측-결과-비교"><span class="header-section-number">12.3.1.3</span> 예측 결과 비교</h4>
<ul>
<li>원 시계열을 이용한 예측 결과와 배깅을 이용한 예측 결과를 비교한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 원 시계열에 대한 예측</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>etsfc    <span class="ot">&lt;-</span> train.ts <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ets</span>() <span class="sc">%&gt;%</span>                                                   <span class="co"># ETS 예측 모형 생성</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> nTest)                                         <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(train.ts) <span class="sc">+</span>                                          <span class="co"># 원 시계열 </span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Ridership"</span>) <span class="sc">+</span>                                         <span class="co"># y축 라벨 </span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(etsfc, <span class="at">series =</span> <span class="st">"ETS"</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>              <span class="co"># 원 시계열에 대한 예측 결과</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(baggedfc, <span class="at">series =</span> <span class="st">"BaggedETS"</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>     <span class="co"># 배깅을 이용한 예측 결과</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Prediction"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with Predictive Interval</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Original Prediction Result</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Original <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Date"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">time</span>(test.ts)),                    <span class="co"># Date</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Y"</span> <span class="ot">=</span> <span class="fu">c</span>(test.ts),                                      <span class="co"># Test Dataset</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Pred"</span> <span class="ot">=</span> <span class="fu">c</span>(etsfc<span class="sc">$</span>mean),                                <span class="co"># Prediction Result</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"PI.lower"</span> <span class="ot">=</span> <span class="fu">c</span>(etsfc<span class="sc">$</span>lower[,<span class="dv">2</span>]),                       <span class="co"># Lower of Predictive Interval</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"PI.upper"</span> <span class="ot">=</span> <span class="fu">c</span>(etsfc<span class="sc">$</span>upper[,<span class="dv">2</span>]),                       <span class="co"># Upper of Predictive Interval</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Type"</span> <span class="ot">=</span> <span class="st">"Original"</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                       )</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>Original <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
    Date     Y  Pred PI.lower PI.upper Type    
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
 1 2001. 2024. 2003.    1869.    2138. Original
 2 2001. 2047. 2019.    1864.    2174. Original
 3 2001. 2073. 1981.    1811.    2151. Original
 4 2002. 2127. 2093.    1902.    2284. Original
 5 2002. 2203. 2143.    1935.    2352. Original
 6 2002. 1708. 1822.    1612.    2032. Original
 7 2002. 1951. 1943.    1718.    2169. Original
 8 2002. 1974. 1932.    1696.    2169. Original
 9 2002. 1985. 1970.    1722.    2219. Original
10 2002  1760. 1732.    1481.    1984. Original
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. Bagging Prediction Result</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Bagging <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Date"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">time</span>(test.ts)),                     <span class="co"># Date</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Y"</span> <span class="ot">=</span> <span class="fu">c</span>(test.ts),                                       <span class="co"># Test Dataset</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Pred"</span> <span class="ot">=</span> <span class="fu">c</span>(baggedfc<span class="sc">$</span>mean),                              <span class="co"># Prediction Result</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"PI.lower"</span> <span class="ot">=</span> PI.pred[<span class="dv">1</span>,],                               <span class="co"># Lower of Predictive Interval</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"PI.upper"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,],                               <span class="co"># Upper of Predictive Interval</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Type"</span> <span class="ot">=</span> <span class="st">"Bagging"</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>Bagging <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
    Date     Y  Pred PI.lower PI.upper Type   
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  
 1 2001. 2024. 2001.    1946.    2096. Bagging
 2 2001. 2047. 2029.    1974.    2123. Bagging
 3 2001. 2073. 1985.    1943.    2079. Bagging
 4 2002. 2127. 2093.    2052.    2180. Bagging
 5 2002. 2203. 2145.    2106.    2224. Bagging
 6 2002. 1708. 1821.    1788.    1892. Bagging
 7 2002. 1951. 1954.    1905.    2016. Bagging
 8 2002. 1974. 1930.    1884.    2003. Bagging
 9 2002. 1985. 1974.    1915.    2052. Bagging
10 2002  1760. 1740.    1695.    1817. Bagging
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. Combine</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Original, Bagging)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
    Date     Y  Pred PI.lower PI.upper Type    
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
 1 2001. 2024. 2003.    1869.    2138. Original
 2 2001. 2047. 2019.    1864.    2174. Original
 3 2001. 2073. 1981.    1811.    2151. Original
 4 2002. 2127. 2093.    1902.    2284. Original
 5 2002. 2203. 2143.    1935.    2352. Original
 6 2002. 1708. 1822.    1612.    2032. Original
 7 2002. 1951. 1943.    1718.    2169. Original
 8 2002. 1974. 1932.    1696.    2169. Original
 9 2002. 1985. 1970.    1722.    2219. Original
10 2002  1760. 1732.    1481.    1984. Original
# ℹ 62 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. Plot</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Pred, <span class="at">group =</span> Type)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Type)) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y)) <span class="sc">+</span>                                                    <span class="co"># Test Dataset                </span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> PI.lower, <span class="at">ymax =</span> PI.upper), <span class="at">fill =</span> <span class="st">"grey30"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측 정확도</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">accuracy</span>(etsfc<span class="sc">$</span>mean, test.ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ME    RMSE      MAE      MPE     MAPE      ACF1 Theil's U
Test set 49.72735 88.6281 73.96379 2.391188 3.707185 0.6542535 0.5135193</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">accuracy</span>(baggedfc<span class="sc">$</span>mean, test.ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ME     RMSE      MAE     MPE     MAPE      ACF1 Theil's U
Test set 47.01337 86.93535 71.90957 2.25561 3.604955 0.6594568 0.5039968</code></pre>
</div>
</div>
</section>
</section>
<section id="arima-모형을-이용한-예측" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="arima-모형을-이용한-예측"><span class="header-section-number">12.3.2</span> ARIMA 모형을 이용한 예측</h3>
<blockquote class="blockquote">
<p>다음은 각 붓스트랩 시계열에 ARIMA 예측 모형을 적용하여 예측을 수행하는 방법이다.</p>
</blockquote>
<p><code>Caution!</code> 일반적으로 ETS 모형보다 ARIMA 모형이 더 정확한 것으로 알려져 있으며, 신뢰할 수 있는 결과를 얻기 위해서 생성하고자 하는 붓스트랩 데이터셋의 개수는 1000개 이상이 되어야 한다. 여기서는 예시를 위해, 10개의 붓스트랩 시계열을 생성하여 예측을 수행한다.</p>
<section id="ver.-1-1" class="level4" data-number="12.3.2.1">
<h4 data-number="12.3.2.1" class="anchored" data-anchor-id="ver.-1-1"><span class="header-section-number">12.3.2.1</span> Ver. 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 10개의 붓스트랩 시계열 생성</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)                                                  <span class="co"># Seed 고정 -&gt; 동일한 결과를 출력하기 위해</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">bld.mbb.bootstrap</span>(train.ts, <span class="dv">10</span>) <span class="sc">%&gt;%</span>                    <span class="co"># 10개의 붓스트랩 시계열 생성                 </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>                                         <span class="co"># Data Frame으로 변환</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="dv">1991</span>)                            <span class="co"># 시계열 객체 ts로 변환</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         structure.c.1708.917..1620.586..1972.715..1811.665..1974.964.. structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
Jan 1991                                                       1708.917                                                           1622.427
Feb 1991                                                       1620.586                                                           1692.925
Mar 1991                                                       1972.715                                                           1917.878
Apr 1991                                                       1811.665                                                           1927.051
May 1991                                                       1974.964                                                           1896.977
Jun 1991                                                       1862.356                                                           1860.024
Jul 1991                                                       1939.860                                                           1920.411
Aug 1991                                                       2013.264                                                           1988.003
Sep 1991                                                       1595.657                                                           1593.912
Oct 1991                                                       1724.924                                                           1778.545
Nov 1991                                                       1675.667                                                           1811.236
Dec 1991                                                       1813.863                                                           1880.393
Jan 1992                                                       1614.827                                                           1649.308
Feb 1992                                                       1557.088                                                           1526.239
Mar 1992                                                       1891.223                                                           1857.970
Apr 1992                                                       1955.981                                                           1825.309
May 1992                                                       1884.714                                                           1888.040
Jun 1992                                                       1623.042                                                           1861.262
Jul 1992                                                       1903.309                                                           1863.242
Aug 1992                                                       1996.712                                                           1956.475
Sep 1992                                                       1703.897                                                           1706.606
Oct 1992                                                       1810.000                                                           1820.205
Nov 1992                                                       1861.601                                                           1840.053
Dec 1992                                                       1875.122                                                           1909.621
Jan 1993                                                       1705.259                                                           1571.520
Feb 1993                                                       1618.535                                                           1591.936
Mar 1993                                                       1836.709                                                           1890.402
Apr 1993                                                       1957.043                                                           1914.140
May 1993                                                       1917.185                                                           1931.129
Jun 1993                                                       1882.398                                                           1867.962
Jul 1993                                                       1933.009                                                           1873.961
Aug 1993                                                       1996.167                                                           1983.379
Sep 1993                                                       1672.841                                                           1701.722
Oct 1993                                                       1752.827                                                           1856.806
Nov 1993                                                       1720.377                                                           1856.825
Dec 1993                                                       1734.292                                                           1808.348
Jan 1994                                                       1563.365                                                           1589.769
Feb 1994                                                       1573.959                                                           1505.010
Mar 1994                                                       1902.639                                                           1830.286
Apr 1994                                                       1833.888                                                           1843.636
May 1994                                                       1831.049                                                           1761.098
Jun 1994                                                       1775.755                                                           1753.302
Jul 1994                                                       1867.508                                                           1931.264
Aug 1994                                                       1906.608                                                           1961.799
Sep 1994                                                       1685.632                                                           1659.449
Oct 1994                                                       1778.546                                                           1804.432
Nov 1994                                                       1775.995                                                           1686.923
Dec 1994                                                       1783.350                                                           1781.791
Jan 1995                                                       1548.415                                                           1529.807
Feb 1995                                                       1496.925                                                           1509.739
Mar 1995                                                       1798.316                                                           1797.566
Apr 1995                                                       1732.895                                                           1780.642
May 1995                                                       1772.345                                                           1796.128
Jun 1995                                                       1761.207                                                           1720.286
Jul 1995                                                       1791.655                                                           1791.655
Aug 1995                                                       1874.820                                                           1874.820
Sep 1995                                                       1571.309                                                           1571.309
Oct 1995                                                       1646.948                                                           1646.948
Nov 1995                                                       1672.631                                                           1672.631
Dec 1995                                                       1656.845                                                           1656.845
Jan 1996                                                       1381.758                                                           1381.758
Feb 1996                                                       1360.852                                                           1360.852
Mar 1996                                                       1558.575                                                           1558.575
Apr 1996                                                       1608.420                                                           1608.420
May 1996                                                       1696.696                                                           1696.696
Jun 1996                                                       1693.183                                                           1693.183
Jul 1996                                                       1835.516                                                           1835.516
Aug 1996                                                       1942.573                                                           1942.573
Sep 1996                                                       1551.401                                                           1551.401
Oct 1996                                                       1686.508                                                           1686.508
Nov 1996                                                       1576.204                                                           1576.204
Dec 1996                                                       1700.433                                                           1700.433
Jan 1997                                                       1396.588                                                           1396.588
Feb 1997                                                       1371.690                                                           1371.690
Mar 1997                                                       1707.522                                                           1707.522
Apr 1997                                                       1654.604                                                           1654.604
May 1997                                                       1762.903                                                           1762.903
Jun 1997                                                       1775.800                                                           1775.800
Jul 1997                                                       1934.219                                                           1879.459
Aug 1997                                                       2008.055                                                           1873.554
Sep 1997                                                       1615.924                                                           1573.191
Oct 1997                                                       1773.910                                                           1728.875
Nov 1997                                                       1732.368                                                           1662.009
Dec 1997                                                       1796.626                                                           1766.769
Jan 1998                                                       1570.330                                                           1574.412
Feb 1998                                                       1412.691                                                           1567.474
Mar 1998                                                       1754.641                                                           1885.200
Apr 1998                                                       1824.932                                                           1808.399
May 1998                                                       1843.289                                                           1871.755
Jun 1998                                                       1825.964                                                           1793.652
Jul 1998                                                       1968.172                                                           1935.587
Aug 1998                                                       1921.645                                                           2005.900
Sep 1998                                                       1669.597                                                           1576.111
Oct 1998                                                       1791.474                                                           1741.790
Nov 1998                                                       1816.714                                                           1803.500
Dec 1998                                                       1846.754                                                           1824.824
Jan 1999                                                       1599.427                                                           1607.221
Feb 1999                                                       1548.804                                                           1588.800
Mar 1999                                                       1832.333                                                           1787.614
Apr 1999                                                       1839.720                                                           1849.404
May 1999                                                       1846.498                                                           1874.599
Jun 1999                                                       1864.852                                                           1859.175
Jul 1999                                                       1965.743                                                           1968.708
Aug 1999                                                       1949.002                                                           1953.762
Sep 1999                                                       1607.373                                                           1680.764
Oct 1999                                                       1803.664                                                           1843.693
Nov 1999                                                       1850.309                                                           1806.174
Dec 1999                                                       1836.435                                                           1901.017
Jan 2000                                                       1541.660                                                           1624.734
Feb 2000                                                       1616.928                                                           1566.973
Mar 2000                                                       1919.538                                                           1906.078
Apr 2000                                                       1971.493                                                           1814.823
May 2000                                                       1992.301                                                           1909.074
Jun 2000                                                       2009.763                                                           1927.685
Jul 2000                                                       2053.996                                                           2087.675
Aug 2000                                                       2097.471                                                           2173.090
Sep 2000                                                       1823.706                                                           1909.370
Oct 2000                                                       1976.997                                                           1964.622
Nov 2000                                                       1981.408                                                           1968.509
Dec 2000                                                       2000.153                                                           1905.106
Jan 2001                                                       1683.148                                                           1752.476
Feb 2001                                                       1663.404                                                           1647.207
Mar 2001                                                       2007.928                                                           1966.341
         structure.c.1678.35741584976..1681.4922251051..2030.56516157946.. structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
Jan 1991                                                          1678.357                                                          1679.091
Feb 1991                                                          1681.492                                                          1582.976
Mar 1991                                                          2030.565                                                          1854.153
Apr 1991                                                          1909.715                                                          1824.543
May 1991                                                          1707.672                                                          1948.536
Jun 1991                                                          1814.613                                                          1884.080
Jul 1991                                                          1953.030                                                          1977.161
Aug 1991                                                          2018.897                                                          2012.104
Sep 1991                                                          1664.064                                                          1662.339
Oct 1991                                                          1837.319                                                          1789.657
Nov 1991                                                          1792.579                                                          1751.282
Dec 1991                                                          1890.302                                                          1849.137
Jan 1992                                                          1601.081                                                          1594.626
Feb 1992                                                          1471.881                                                          1480.169
Mar 1992                                                          1902.656                                                          1759.681
Apr 1992                                                          1843.294                                                          1828.779
May 1992                                                          1902.050                                                          1913.314
Jun 1992                                                          1812.347                                                          1810.883
Jul 1992                                                          1948.720                                                          1862.454
Aug 1992                                                          2009.130                                                          2022.809
Sep 1992                                                          1652.774                                                          1691.644
Oct 1992                                                          1764.466                                                          1859.573
Nov 1992                                                          1744.186                                                          1831.273
Dec 1992                                                          1864.154                                                          1928.531
Jan 1993                                                          1687.119                                                          1617.655
Feb 1993                                                          1647.772                                                          1561.623
Mar 1993                                                          2011.240                                                          1907.212
Apr 1993                                                          1895.509                                                          1923.698
May 1993                                                          1698.584                                                          1917.891
Jun 1993                                                          1805.908                                                          1774.831
Jul 1993                                                          1944.706                                                          1885.784
Aug 1993                                                          2012.618                                                          1894.410
Sep 1993                                                          1659.830                                                          1670.687
Oct 1993                                                          1833.486                                                          1835.852
Nov 1993                                                          1789.146                                                          1807.466
Dec 1993                                                          1884.937                                                          1869.565
Jan 1994                                                          1593.784                                                          1681.975
Feb 1994                                                          1461.151                                                          1526.627
Mar 1994                                                          1888.494                                                          1604.728
Apr 1994                                                          1824.016                                                          1768.493
May 1994                                                          1877.655                                                          1839.089
Jun 1994                                                          1781.841                                                          1817.476
Jul 1994                                                          1912.104                                                          1904.024
Aug 1994                                                          1964.604                                                          2005.660
Sep 1994                                                          1600.339                                                          1650.166
Oct 1994                                                          1701.164                                                          1833.994
Nov 1994                                                          1670.018                                                          1776.053
Dec 1994                                                          1777.971                                                          1722.051
Jan 1995                                                          1588.923                                                          1603.123
Feb 1995                                                          1452.095                                                          1487.476
Mar 1995                                                          1728.915                                                          1804.590
Apr 1995                                                          1710.934                                                          1744.815
May 1995                                                          1837.092                                                          1765.814
Jun 1995                                                          1753.859                                                          1740.908
Jul 1995                                                          1864.888                                                          1753.852
Aug 1995                                                          1878.693                                                          1802.717
Sep 1995                                                          1556.252                                                          1433.929
Oct 1995                                                          1668.300                                                          1651.517
Nov 1995                                                          1653.503                                                          1677.050
Dec 1995                                                          1628.933                                                          1693.512
Jan 1996                                                          1398.977                                                          1476.946
Feb 1996                                                          1401.229                                                          1492.910
Mar 1996                                                          1635.065                                                          1687.493
Apr 1996                                                          1681.681                                                          1467.500
May 1996                                                          1745.835                                                          1664.799
Jun 1996                                                          1666.100                                                          1660.405
Jul 1996                                                          1826.137                                                          1798.654
Aug 1996                                                          1834.947                                                          1830.058
Sep 1996                                                          1490.499                                                          1567.830
Oct 1996                                                          1640.832                                                          1665.250
Nov 1996                                                          1530.071                                                          1724.462
Dec 1996                                                          1618.318                                                          1720.493
Jan 1997                                                          1434.740                                                          1396.521
Feb 1997                                                          1342.755                                                          1487.072
Mar 1997                                                          1736.512                                                          1732.076
Apr 1997                                                          1681.170                                                          1763.915
May 1997                                                          1735.585                                                          1723.959
Jun 1997                                                          1727.544                                                          1817.264
Jul 1997                                                          1786.679                                                          1875.023
Aug 1997                                                          1912.432                                                          1956.299
Sep 1997                                                          1647.110                                                          1594.113
Oct 1997                                                          1812.625                                                          1743.318
Nov 1997                                                          1823.076                                                          1745.173
Dec 1997                                                          1782.184                                                          1744.885
Jan 1998                                                          1571.190                                                          1486.986
Feb 1998                                                          1490.295                                                          1426.740
Mar 1998                                                          1819.434                                                          1806.552
Apr 1998                                                          1835.503                                                          1866.848
May 1998                                                          1755.685                                                          1930.585
Jun 1998                                                          1753.802                                                          1821.509
Jul 1998                                                          1937.678                                                          1902.990
Aug 1998                                                          1978.295                                                          1950.898
Sep 1998                                                          1686.027                                                          1616.993
Oct 1998                                                          1839.168                                                          1736.449
Nov 1998                                                          1729.816                                                          1834.961
Dec 1998                                                          1830.707                                                          1846.467
Jan 1999                                                          1584.744                                                          1617.332
Feb 1999                                                          1499.040                                                          1548.713
Mar 1999                                                          1827.695                                                          1862.706
Apr 1999                                                          1763.164                                                          1860.957
May 1999                                                          1859.851                                                          1787.161
Jun 1999                                                          1860.614                                                          1779.077
Jul 1999                                                          2006.899                                                          1956.752
Aug 1999                                                          2075.282                                                          1994.572
Sep 1999                                                          1677.697                                                          1699.509
Oct 1999                                                          1838.659                                                          1857.722
Nov 1999                                                          1800.092                                                          1753.442
Dec 1999                                                          1874.152                                                          1865.091
Jan 2000                                                          1657.656                                                          1629.886
Feb 2000                                                          1512.841                                                          1630.692
Mar 2000                                                          1867.616                                                          1939.396
Apr 2000                                                          1949.159                                                          1946.643
May 2000                                                          1978.768                                                          1986.300
Jun 2000                                                          1965.637                                                          1931.394
Jul 2000                                                          2112.039                                                          2060.708
Aug 2000                                                          2065.252                                                          2093.635
Sep 2000                                                          1812.944                                                          1842.987
Oct 2000                                                          1937.025                                                          1963.216
Nov 2000                                                          1964.469                                                          1888.650
Dec 2000                                                          1998.205                                                          1906.451
Jan 2001                                                          1754.572                                                          1733.525
Feb 2001                                                          1664.201                                                          1741.216
Mar 2001                                                          1952.834                                                          1985.800
         structure.c.1706.53385960804..1641.70380329126..1924.41014476705.. structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
Jan 1991                                                           1706.534                                                           1716.503
Feb 1991                                                           1641.704                                                           1597.001
Mar 1991                                                           1924.410                                                           1821.500
Apr 1991                                                           1905.629                                                           1914.582
May 1991                                                           1906.356                                                           1920.359
Jun 1991                                                           1858.348                                                           1901.518
Jul 1991                                                           1934.376                                                           1976.176
Aug 1991                                                           2040.498                                                           2071.011
Sep 1991                                                           1700.295                                                           1663.756
Oct 1991                                                           1747.889                                                           1769.028
Nov 1991                                                           1709.726                                                           1796.584
Dec 1991                                                           1806.682                                                           1813.211
Jan 1992                                                           1608.817                                                           1590.912
Feb 1992                                                           1502.965                                                           1573.266
Mar 1992                                                           1741.113                                                           1772.855
Apr 1992                                                           1851.792                                                           1841.191
May 1992                                                           1875.168                                                           1872.931
Jun 1992                                                           1873.024                                                           1863.905
Jul 1992                                                           1964.379                                                           1972.776
Aug 1992                                                           2072.764                                                           2020.843
Sep 1992                                                           1679.058                                                           1697.104
Oct 1992                                                           1837.640                                                           1808.275
Nov 1992                                                           1840.420                                                           1813.938
Dec 1992                                                           1828.862                                                           1833.825
Jan 1993                                                           1611.918                                                           1664.095
Feb 1993                                                           1615.044                                                           1612.079
Mar 1993                                                           1849.757                                                           1844.997
Apr 1993                                                           1887.459                                                           1814.068
May 1993                                                           1942.699                                                           1902.670
Jun 1993                                                           1849.527                                                           1893.662
Jul 1993                                                           1996.128                                                           1931.545
Aug 1993                                                           1992.976                                                           1909.901
Sep 1993                                                           1636.564                                                           1686.519
Oct 1993                                                           1778.238                                                           1791.697
Nov 1993                                                           1658.815                                                           1798.796
Dec 1993                                                           1738.153                                                           1774.617
Jan 1994                                                           1545.664                                                           1545.052
Feb 1994                                                           1538.174                                                           1543.999
Mar 1994                                                           1866.530                                                           1774.532
Apr 1994                                                           1918.339                                                           1819.598
May 1994                                                           1876.133                                                           1882.201
Jun 1994                                                           1837.440                                                           1799.234
Jul 1994                                                           1843.061                                                           1956.038
Aug 1994                                                           1974.220                                                           1956.482
Sep 1994                                                           1583.345                                                           1603.665
Oct 1994                                                           1789.385                                                           1745.516
Nov 1994                                                           1689.714                                                           1626.271
Dec 1994                                                           1849.061                                                           1706.215
Jan 1995                                                           1537.958                                                           1514.334
Feb 1995                                                           1508.444                                                           1502.656
Mar 1995                                                           1754.326                                                           1826.824
Apr 1995                                                           1763.999                                                           1868.433
May 1995                                                           1791.402                                                           1816.028
Jun 1995                                                           1695.419                                                           1766.505
Jul 1995                                                           1776.726                                                           1761.297
Aug 1995                                                           1797.698                                                           1883.674
Sep 1995                                                           1539.872                                                           1484.019
Oct 1995                                                           1709.816                                                           1608.633
Nov 1995                                                           1718.119                                                           1659.813
Dec 1995                                                           1680.020                                                           1621.352
Jan 1996                                                           1397.576                                                           1418.796
Feb 1996                                                           1344.844                                                           1405.738
Mar 1996                                                           1629.154                                                           1671.958
Apr 1996                                                           1622.923                                                           1719.922
May 1996                                                           1760.831                                                           1707.018
Jun 1996                                                           1691.660                                                           1636.546
Jul 1996                                                           1816.751                                                           1772.941
Aug 1996                                                           1847.705                                                           1722.963
Sep 1996                                                           1542.412                                                           1454.277
Oct 1996                                                           1655.025                                                           1636.581
Nov 1996                                                           1610.574                                                           1670.537
Dec 1996                                                           1632.273                                                           1739.199
Jan 1997                                                           1376.825                                                           1552.686
Feb 1997                                                           1415.983                                                           1441.353
Mar 1997                                                           1783.041                                                           1758.379
Apr 1997                                                           1822.258                                                           1663.794
May 1997                                                           1795.675                                                           1790.238
Jun 1997                                                           1726.460                                                           1690.321
Jul 1997                                                           1839.641                                                           1824.805
Aug 1997                                                           1880.624                                                           1910.777
Sep 1997                                                           1560.233                                                           1535.065
Oct 1997                                                           1793.940                                                           1730.530
Nov 1997                                                           1764.010                                                           1784.176
Dec 1997                                                           1814.106                                                           1776.366
Jan 1998                                                           1550.166                                                           1509.254
Feb 1998                                                           1518.736                                                           1488.906
Mar 1998                                                           1821.925                                                           1687.189
Apr 1998                                                           1830.578                                                           1738.204
May 1998                                                           1810.060                                                           1827.650
Jun 1998                                                           1787.400                                                           1826.817
Jul 1998                                                           1949.634                                                           1971.831
Aug 1998                                                           1937.484                                                           2080.604
Sep 1998                                                           1667.282                                                           1691.146
Oct 1998                                                           1768.856                                                           1825.928
Nov 1998                                                           1795.157                                                           1715.297
Dec 1998                                                           1746.211                                                           1837.246
Jan 1999                                                           1516.375                                                           1531.118
Feb 1999                                                           1437.391                                                           1499.040
Mar 1999                                                           1844.915                                                           1827.695
Apr 1999                                                           1889.750                                                           1763.164
May 1999                                                           1906.115                                                           1859.851
Jun 1999                                                           1890.645                                                           1860.614
Jul 1999                                                           2060.390                                                           2006.899
Aug 1999                                                           2006.190                                                           2075.282
Sep 1999                                                           1466.583                                                           1677.697
Oct 1999                                                           1762.656                                                           1838.659
Nov 1999                                                           1800.479                                                           1807.965
Dec 1999                                                           1873.534                                                           1862.014
Jan 2000                                                           1619.846                                                           1593.253
Feb 2000                                                           1644.304                                                           1544.705
Mar 2000                                                           1930.496                                                           1843.911
Apr 2000                                                           2009.216                                                           1934.187
May 2000                                                           2011.250                                                           2037.719
Jun 2000                                                           1889.466                                                           2030.621
Jul 2000                                                           2137.662                                                           2082.368
Aug 2000                                                           2129.888                                                           2104.249
Sep 2000                                                           1836.015                                                           1779.665
Oct 2000                                                           1969.672                                                           1890.469
Nov 2000                                                           1880.362                                                           1879.030
Dec 2000                                                           2049.427                                                           2024.771
Jan 2001                                                           1748.040                                                           1761.697
Feb 2001                                                           1729.952                                                           1733.421
Mar 2001                                                           1987.263                                                           2016.014
         structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1 structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
Jan 1991                                                            1679.091                                                           1678.357
Feb 1991                                                            1582.976                                                           1659.142
Mar 1991                                                            1854.153                                                           1922.314
Apr 1991                                                            1824.543                                                           1844.306
May 1991                                                            1920.349                                                           1876.054
Jun 1991                                                            1921.101                                                           1845.581
Jul 1991                                                            2049.940                                                           1882.285
Aug 1991                                                            2022.430                                                           1989.658
Sep 1991                                                            1656.617                                                           1705.957
Oct 1991                                                            1766.063                                                           1860.640
Nov 1991                                                            1732.828                                                           1860.258
Dec 1991                                                            1758.021                                                           1813.713
Jan 1992                                                            1617.095                                                           1597.066
Feb 1992                                                            1547.381                                                           1515.739
Mar 1992                                                            1861.927                                                           1844.448
Apr 1992                                                            1842.749                                                           1862.914
May 1992                                                            1891.539                                                           1785.492
Jun 1992                                                            1851.091                                                           1783.807
Jul 1992                                                            1973.526                                                           1967.880
Aug 1992                                                            1973.095                                                           2006.325
Sep 1992                                                            1673.320                                                           1711.884
Oct 1992                                                            1849.196                                                           1867.734
Nov 1992                                                            1776.930                                                           1761.091
Dec 1992                                                            1865.659                                                           1867.974
Jan 1993                                                            1600.773                                                           1628.004
Feb 1993                                                            1539.333                                                           1616.302
Mar 1993                                                            1835.377                                                           2011.240
Apr 1993                                                            1932.387                                                           1895.509
May 1993                                                            1930.842                                                           1698.584
Jun 1993                                                            1885.867                                                           1805.908
Jul 1993                                                            1961.760                                                           1944.706
Aug 1993                                                            2016.736                                                           2012.618
Sep 1993                                                            1687.470                                                           1659.830
Oct 1993                                                            1812.305                                                           1833.486
Nov 1993                                                            1742.887                                                           1789.146
Dec 1993                                                            1791.595                                                           1884.937
Jan 1994                                                            1590.293                                                           1593.784
Feb 1994                                                            1474.199                                                           1461.151
Mar 1994                                                            1818.910                                                           1888.494
Apr 1994                                                            1849.530                                                           1824.016
May 1994                                                            1844.784                                                           1877.655
Jun 1994                                                            1844.960                                                           1781.841
Jul 1994                                                            1908.913                                                           1912.104
Aug 1994                                                            1928.327                                                           1964.604
Sep 1994                                                            1625.749                                                           1600.339
Oct 1994                                                            1639.603                                                           1701.164
Nov 1994                                                            1673.879                                                           1670.018
Dec 1994                                                            1760.270                                                           1777.971
Jan 1995                                                            1473.324                                                           1588.923
Feb 1995                                                            1485.373                                                           1566.786
Mar 1995                                                            1775.471                                                           1808.118
Apr 1995                                                            1796.373                                                           1712.266
May 1995                                                            1810.526                                                           1861.748
Jun 1995                                                            1746.735                                                           1740.202
Jul 1995                                                            1839.997                                                           1861.419
Aug 1995                                                            1859.322                                                           1849.942
Sep 1995                                                            1534.008                                                           1535.684
Oct 1995                                                            1622.599                                                           1653.671
Nov 1995                                                            1666.748                                                           1594.025
Dec 1995                                                            1688.187                                                           1606.423
Jan 1996                                                            1369.659                                                           1341.676
Feb 1996                                                            1302.417                                                           1374.301
Mar 1996                                                            1669.346                                                           1734.826
Apr 1996                                                            1718.331                                                           1765.409
May 1996                                                            1689.562                                                           1730.193
Jun 1996                                                            1581.626                                                           1652.365
Jul 1996                                                            1800.813                                                           1756.932
Aug 1996                                                            1842.336                                                           1793.542
Sep 1996                                                            1563.337                                                           1468.780
Oct 1996                                                            1665.752                                                           1700.715
Nov 1996                                                            1713.810                                                           1669.014
Dec 1996                                                            1677.498                                                           1720.434
Jan 1997                                                            1497.907                                                           1457.820
Feb 1997                                                            1357.273                                                           1432.364
Mar 1997                                                            1729.973                                                           1724.091
Apr 1997                                                            1734.796                                                           1757.274
May 1997                                                            1808.065                                                           1825.345
Jun 1997                                                            1766.042                                                           1687.464
Jul 1997                                                            1881.556                                                           1872.920
Aug 1997                                                            1934.877                                                           1927.180
Sep 1997                                                            1603.492                                                           1645.671
Oct 1997                                                            1741.642                                                           1767.374
Nov 1997                                                            1714.100                                                           1756.885
Dec 1997                                                            1817.608                                                           1789.215
Jan 1998                                                            1568.750                                                           1530.794
Feb 1998                                                            1454.724                                                           1496.492
Mar 1998                                                            1734.667                                                           1776.224
Apr 1998                                                            1801.369                                                           1843.823
May 1998                                                            1883.507                                                           1869.315
Jun 1998                                                            1780.878                                                           1758.081
Jul 1998                                                            1832.251                                                           1850.819
Aug 1998                                                            1994.779                                                           1971.765
Sep 1998                                                            1665.787                                                           1703.932
Oct 1998                                                            1831.007                                                           1768.866
Nov 1998                                                            1799.998                                                           1698.074
Dec 1998                                                            1891.263                                                           1841.308
Jan 1999                                                            1557.513                                                           1586.981
Feb 1999                                                            1494.551                                                           1580.640
Mar 1999                                                            1789.073                                                           1844.765
Apr 1999                                                            1892.018                                                           1871.988
May 1999                                                            1896.407                                                           1864.766
Jun 1999                                                            1861.349                                                           1843.870
Jul 1999                                                            1947.158                                                           1967.323
Aug 1999                                                            2013.015                                                           1906.968
Sep 1999                                                            1694.631                                                           1627.347
Oct 1999                                                            1832.873                                                           1827.227
Nov 1999                                                            1776.862                                                           1810.091
Dec 1999                                                            1842.957                                                           1881.521
Jan 2000                                                            1659.041                                                           1677.579
Feb 2000                                                            1559.634                                                           1543.795
Mar 2000                                                            1921.034                                                           1923.348
Apr 2000                                                            1965.625                                                           1931.960
May 2000                                                            1974.851                                                           2009.017
Jun 2000                                                            1985.133                                                           1965.254
Jul 2000                                                            2059.193                                                           2079.028
Aug 2000                                                            2088.430                                                           2129.434
Sep 2000                                                            1795.674                                                           1795.131
Oct 2000                                                            1819.889                                                           1933.388
Nov 2000                                                            1864.526                                                           1905.953
Dec 2000                                                            1960.636                                                           2012.201
Jan 2001                                                            1771.741                                                           1766.080
Feb 2001                                                            1768.180                                                           1655.429
Mar 2001                                                            2089.283                                                           2016.014
         structure.c.1749.43655465283..1627.75975450604..1938.84571798435.. structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
Jan 1991                                                           1749.437                                                           1708.708
Feb 1991                                                           1627.760                                                           1627.215
Mar 1991                                                           1938.846                                                           1928.335
Apr 1991                                                           1876.787                                                           1915.532
May 1991                                                           1916.161                                                           1940.967
Jun 1991                                                           1864.956                                                           1828.921
Jul 1991                                                           1925.845                                                           1946.391
Aug 1991                                                           1948.833                                                           2033.563
Sep 1991                                                           1600.716                                                           1633.460
Oct 1991                                                           1795.521                                                           1797.026
Nov 1991                                                           1838.500                                                           1723.810
Dec 1991                                                           1801.824                                                           1739.657
Jan 1992                                                           1451.300                                                           1570.662
Feb 1992                                                           1456.045                                                           1584.688
Mar 1992                                                           1813.865                                                           1916.801
Apr 1992                                                           1858.474                                                           1853.166
May 1992                                                           1924.284                                                           1855.443
Jun 1992                                                           1935.966                                                           1806.260
Jul 1992                                                           1978.278                                                           1904.124
Aug 1992                                                           2040.613                                                           1951.134
Sep 1992                                                           1618.404                                                           1738.067
Oct 1992                                                           1832.627                                                           1841.848
Nov 1992                                                           1763.949                                                           1850.163
Dec 1992                                                           1819.859                                                           1869.533
Jan 1993                                                           1611.600                                                           1646.612
Feb 1993                                                           1505.697                                                           1603.488
Mar 1993                                                           1875.653                                                           1913.247
Apr 1993                                                           1915.579                                                           1850.662
May 1993                                                           1976.381                                                           1892.948
Jun 1993                                                           1934.154                                                           1882.435
Jul 1993                                                           1954.820                                                           1913.508
Aug 1993                                                           2026.759                                                           2001.860
Sep 1993                                                           1660.036                                                           1703.535
Oct 1993                                                           1804.568                                                           1785.708
Nov 1993                                                           1803.722                                                           1707.581
Dec 1993                                                           1820.877                                                           1703.964
Jan 1994                                                           1638.393                                                           1561.955
Feb 1994                                                           1547.490                                                           1561.236
Mar 1994                                                           1761.484                                                           1846.693
Apr 1994                                                           1889.182                                                           1877.749
May 1994                                                           1856.687                                                           1969.375
Jun 1994                                                           1832.105                                                           1814.769
Jul 1994                                                           1892.920                                                           1703.615
Aug 1994                                                           1959.673                                                           1914.262
Sep 1994                                                           1639.942                                                           1627.524
Oct 1994                                                           1720.106                                                           1771.229
Nov 1994                                                           1687.833                                                           1733.367
Dec 1994                                                           1702.355                                                           1819.770
Jan 1995                                                           1532.035                                                           1543.003
Feb 1995                                                           1538.441                                                           1556.580
Mar 1995                                                           1862.932                                                           1808.118
Apr 1995                                                           1783.982                                                           1712.266
May 1995                                                           1770.944                                                           1861.748
Jun 1995                                                           1704.820                                                           1740.202
Jul 1995                                                           1785.744                                                           1861.419
Aug 1995                                                           1816.062                                                           1849.942
Sep 1995                                                           1586.305                                                           1535.684
Oct 1995                                                           1672.508                                                           1653.671
Nov 1995                                                           1663.246                                                           1588.591
Dec 1995                                                           1669.694                                                           1645.593
Jan 1996                                                           1403.298                                                           1334.872
Feb 1996                                                           1368.437                                                           1357.326
Mar 1996                                                           1647.609                                                           1707.563
Apr 1996                                                           1714.039                                                           1745.294
May 1996                                                           1738.361                                                           1793.044
Jun 1996                                                           1624.448                                                           1670.519
Jul 1996                                                           1714.505                                                           1812.794
Aug 1996                                                           1833.735                                                           1830.265
Sep 1996                                                           1564.187                                                           1538.913
Oct 1996                                                           1629.447                                                           1679.825
Nov 1996                                                           1558.981                                                           1559.768
Dec 1996                                                           1704.496                                                           1638.162
Jan 1997                                                           1452.451                                                           1467.413
Feb 1997                                                           1453.289                                                           1413.922
Mar 1997                                                           1737.623                                                           1746.403
Apr 1997                                                           1801.400                                                           1782.490
May 1997                                                           1767.303                                                           1721.168
Jun 1997                                                           1719.682                                                           1749.995
Jul 1997                                                           1883.682                                                           1866.872
Aug 1997                                                           1967.152                                                           1957.594
Sep 1997                                                           1662.610                                                           1637.352
Oct 1997                                                           1769.322                                                           1759.962
Nov 1997                                                           1685.461                                                           1738.450
Dec 1997                                                           1748.211                                                           1823.491
Jan 1998                                                           1531.337                                                           1537.408
Feb 1998                                                           1382.994                                                           1466.823
Mar 1998                                                           1734.797                                                           1793.103
Apr 1998                                                           1792.258                                                           1690.597
May 1998                                                           1866.455                                                           1773.595
Jun 1998                                                           1854.839                                                           1788.012
Jul 1998                                                           2022.953                                                           1943.809
Aug 1998                                                           2005.726                                                           2029.482
Sep 1998                                                           1698.003                                                           1766.023
Oct 1998                                                           1720.471                                                           1819.071
Nov 1998                                                           1798.887                                                           1820.754
Dec 1998                                                           1771.033                                                           1753.656
Jan 1999                                                           1542.677                                                           1597.331
Feb 1999                                                           1524.704                                                           1487.481
Mar 1999                                                           1763.905                                                           1802.031
Apr 1999                                                           1828.608                                                           1826.953
May 1999                                                           1906.452                                                           1794.407
Jun 1999                                                           1896.108                                                           1814.012
Jul 1999                                                           2020.427                                                           1971.405
Aug 1999                                                           1995.074                                                           2061.754
Sep 1999                                                           1705.662                                                           1757.905
Oct 1999                                                           1800.194                                                           1810.694
Nov 1999                                                           1825.035                                                           1897.388
Dec 1999                                                           1772.776                                                           1877.066
Jan 2000                                                           1686.728                                                           1612.398
Feb 2000                                                           1600.650                                                           1573.048
Mar 2000                                                           1894.683                                                           1870.744
Apr 2000                                                           1940.817                                                           1876.934
May 2000                                                           1900.155                                                           2027.264
Jun 2000                                                           1874.789                                                           1964.967
Jul 2000                                                           1960.627                                                           2096.933
Aug 2000                                                           2122.554                                                           2129.343
Sep 2000                                                           1853.289                                                           1825.504
Oct 2000                                                           1968.541                                                           1954.625
Nov 2000                                                           1995.939                                                           1956.900
Dec 2000                                                           2096.948                                                           1943.045
Jan 2001                                                           1751.672                                                           1723.803
Feb 2001                                                           1490.385                                                           1729.989
Mar 2001                                                           1961.036                                                           1967.763</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 각 붓스트랩 시계열에 대해 ARIMA 모형 적용</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fit.arima <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">function</span>(x) <span class="fu">auto.arima</span>(x))                <span class="co"># 함수 auto.arima() : ARIMA 모형</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>fit.arima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$structure.c.1708.917..1620.586..1972.715..1811.665..1974.964..
Series: x 
ARIMA(1,1,1)(0,1,1)[12] 

Coefficients:
         ar1      ma1     sma1
      0.3221  -0.7446  -0.7017
s.e.  0.1644   0.1185   0.1021

sigma^2 = 4032:  log likelihood = -615.44
AIC=1238.88   AICc=1239.26   BIC=1249.68

$structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
Series: x 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1     sma1
      -0.4323  -0.8579
s.e.   0.1066   0.1456

sigma^2 = 2985:  log likelihood = -602.97
AIC=1211.93   AICc=1212.16   BIC=1220.04

$structure.c.1678.35741584976..1681.4922251051..2030.56516157946..
Series: x 
ARIMA(2,1,2)(0,1,2)[12] 

Coefficients:
         ar1      ar2      ma1     ma2     sma1    sma2
      1.4362  -0.5765  -1.8491  0.9276  -0.8973  0.2306
s.e.  0.1078   0.0999   0.0616  0.0578   0.1068  0.0885

sigma^2 = 3369:  log likelihood = -604.82
AIC=1223.64   AICc=1224.74   BIC=1242.54

$structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
Series: x 
ARIMA(0,1,2)(2,1,0)[12] 

Coefficients:
          ma1      ma2     sar1     sar2
      -0.4736  -0.2348  -0.6650  -0.3113
s.e.   0.0912   0.0859   0.0899   0.0912

sigma^2 = 4852:  log likelihood = -624.17
AIC=1258.34   AICc=1258.92   BIC=1271.84

$structure.c.1706.53385960804..1641.70380329126..1924.41014476705..
Series: x 
ARIMA(2,1,2)(1,1,1)[12] 

Coefficients:
         ar1      ar2      ma1     ma2     sar1     sma1
      1.3380  -0.6218  -1.7113  0.8734  -0.1731  -0.7100
s.e.  0.1153   0.1099   0.1015  0.0734   0.1470   0.1434

sigma^2 = 3258:  log likelihood = -604.26
AIC=1222.52   AICc=1223.61   BIC=1241.42

$structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
Series: x 
ARIMA(1,1,1)(0,1,1)[12] 

Coefficients:
         ar1      ma1     sma1
      0.3895  -0.7607  -0.7813
s.e.  0.1439   0.0988   0.1152

sigma^2 = 2894:  log likelihood = -598.74
AIC=1205.48   AICc=1205.86   BIC=1216.28

$structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1
Series: x 
ARIMA(0,1,1)(0,1,1)[12] 

Coefficients:
          ma1    sma1
      -0.4339  -0.816
s.e.   0.1117   0.176

sigma^2 = 2206:  log likelihood = -585.08
AIC=1176.17   AICc=1176.4   BIC=1184.27

$structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
Series: x 
ARIMA(0,1,2)(0,1,1)[12] 

Coefficients:
          ma1      ma2     sma1
      -0.4215  -0.2237  -0.8035
s.e.   0.0934   0.0860   0.1238

sigma^2 = 3100:  log likelihood = -603.1
AIC=1214.2   AICc=1214.58   BIC=1225

$structure.c.1749.43655465283..1627.75975450604..1938.84571798435..
Series: x 
ARIMA(1,1,1)(0,1,1)[12] 

Coefficients:
         ar1      ma1     sma1
      0.4191  -0.7898  -0.7898
s.e.  0.1336   0.0871   0.1273

sigma^2 = 3818:  log likelihood = -614.21
AIC=1236.41   AICc=1236.79   BIC=1247.22

$structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
Series: x 
ARIMA(1,1,1)(0,1,1)[12] 

Coefficients:
         ar1      ma1     sma1
      0.3687  -0.7724  -0.7445
s.e.  0.1466   0.0979   0.1104

sigma^2 = 3384:  log likelihood = -606.59
AIC=1221.17   AICc=1221.55   BIC=1231.97</code></pre>
</div>
</div>
<p><code>Caution!</code> ARIMA 모형 생성은 함수 <code>auto.arima()</code>를 이용한다.<br>
<code>Result!</code> 총 10개의 ARIMA 예측 모형이 생성된 것을 알 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 예측</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>start  <span class="ot">&lt;-</span> <span class="fu">tsp</span>(train.ts)[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>                               <span class="co"># tsp(time series)[2] : Last Date +1/12 = First Date in Forecast</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 3-1. 각 ARIMA 모형의 예측 결과 생성</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>fc  <span class="ot">&lt;-</span> <span class="fu">lapply</span>(fit.arima, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>              <span class="cf">function</span>(x){ </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">forecast</span>(x, <span class="at">h =</span> nTest)[[<span class="st">"mean"</span>]]              <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>              }) <span class="sc">%&gt;%</span>  </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span>                                         <span class="co"># Data Frame으로 변환</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ts</span>(<span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> start)                           <span class="co"># 시계열 객체 ts로 변환</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>fc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         structure.c.1708.917..1620.586..1972.715..1811.665..1974.964.. structure.c.1622.42743753532..1692.92522074207..1917.87774380134..
Apr 2001                                                       2019.638                                                           1946.126
May 2001                                                       2047.291                                                           1990.483
Jun 2001                                                       2041.622                                                           1966.504
Jul 2001                                                       2138.616                                                           2073.705
Aug 2001                                                       2168.222                                                           2132.357
Sep 2001                                                       1857.933                                                           1815.232
Oct 2001                                                       2004.558                                                           1946.543
Nov 2001                                                       2007.457                                                           1928.296
Dec 2001                                                       2033.645                                                           1969.384
Jan 2002                                                       1758.009                                                           1728.930
Feb 2002                                                       1735.541                                                           1689.149
Mar 2002                                                       2049.103                                                           1980.485
Apr 2002                                                       2067.463                                                           1963.555
May 2002                                                       2097.259                                                           2007.911
Jun 2002                                                       2092.279                                                           1983.933
Jul 2002                                                       2189.496                                                           2091.133
Aug 2002                                                       2219.174                                                           2149.786
Sep 2002                                                       1908.908                                                           1832.661
Oct 2002                                                       2055.540                                                           1963.971
Nov 2002                                                       2058.441                                                           1945.725
Dec 2002                                                       2084.631                                                           1986.813
Jan 2003                                                       1808.995                                                           1746.359
Feb 2003                                                       1786.527                                                           1706.577
Mar 2003                                                       2100.089                                                           1997.913
Apr 2003                                                       2118.449                                                           1980.983
May 2003                                                       2148.244                                                           2025.340
Jun 2003                                                       2143.265                                                           2001.361
Jul 2003                                                       2240.482                                                           2108.562
Aug 2003                                                       2270.159                                                           2167.215
Sep 2003                                                       1959.893                                                           1850.089
Oct 2003                                                       2106.526                                                           1981.400
Nov 2003                                                       2109.427                                                           1963.154
Dec 2003                                                       2135.616                                                           2004.241
Jan 2004                                                       1859.980                                                           1763.787
Feb 2004                                                       1837.513                                                           1724.006
Mar 2004                                                       2151.075                                                           2015.342
         structure.c.1678.35741584976..1681.4922251051..2030.56516157946.. structure.c.1679.09101331696..1582.97636089056..1854.1526980279..
Apr 2001                                                          1959.780                                                          2018.250
May 2001                                                          2007.728                                                          2037.752
Jun 2001                                                          2002.863                                                          1982.542
Jul 2001                                                          2148.797                                                          2114.069
Aug 2001                                                          2200.887                                                          2153.390
Sep 2001                                                          1875.048                                                          1861.116
Oct 2001                                                          2025.012                                                          1994.538
Nov 2001                                                          1974.805                                                          1963.343
Dec 2001                                                          2028.643                                                          2012.374
Jan 2002                                                          1802.989                                                          1799.925
Feb 2002                                                          1699.039                                                          1781.426
Mar 2002                                                          2032.671                                                          2070.293
Apr 2002                                                          2041.260                                                          2083.183
May 2002                                                          2077.558                                                          2080.770
Jun 2002                                                          2067.220                                                          2040.338
Jul 2002                                                          2212.247                                                          2185.448
Aug 2002                                                          2239.092                                                          2222.041
Sep 2002                                                          1927.974                                                          1943.620
Oct 2002                                                          2073.749                                                          2080.093
Nov 2002                                                          2045.561                                                          2010.808
Dec 2002                                                          2098.291                                                          2068.288
Jan 2003                                                          1868.975                                                          1862.732
Feb 2003                                                          1765.405                                                          1859.505
Mar 2003                                                          2089.463                                                          2138.886
Apr 2003                                                          2103.630                                                          2156.937
May 2003                                                          2143.637                                                          2175.371
Jun 2003                                                          2135.408                                                          2125.207
Jul 2003                                                          2281.327                                                          2260.596
Aug 2003                                                          2308.236                                                          2297.012
Sep 2003                                                          1996.696                                                          2022.338
Oct 2003                                                          2141.829                                                          2152.676
Nov 2003                                                          2112.960                                                          2095.217
Dec 2003                                                          2165.084                                                          2137.357
Jan 2004                                                          1935.290                                                          1939.521
Feb 2004                                                          1831.382                                                          1934.292
Mar 2004                                                          2155.231                                                          2206.195
         structure.c.1706.53385960804..1641.70380329126..1924.41014476705.. structure.c.1716.50284051107..1597.00099324254..1821.50002277332..
Apr 2001                                                           2047.047                                                           2020.052
May 2001                                                           2071.845                                                           2084.582
Jun 2001                                                           2020.729                                                           2053.314
Jul 2001                                                           2159.599                                                           2154.900
Aug 2001                                                           2155.499                                                           2205.186
Sep 2001                                                           1780.384                                                           1852.720
Oct 2001                                                           1960.800                                                           1993.420
Nov 2001                                                           1944.741                                                           1977.642
Dec 2001                                                           1994.697                                                           2044.239
Jan 2002                                                           1740.931                                                           1797.758
Feb 2002                                                           1723.938                                                           1758.853
Mar 2002                                                           2037.394                                                           2036.464
Apr 2002                                                           2083.846                                                           2053.551
May 2002                                                           2096.466                                                           2123.163
Jun 2002                                                           2032.419                                                           2093.874
Jul 2002                                                           2194.410                                                           2196.231
Aug 2002                                                           2195.716                                                           2246.818
Sep 2002                                                           1840.143                                                           1894.469
Oct 2002                                                           2016.035                                                           2035.214
Nov 2002                                                           1988.667                                                           2019.454
Dec 2002                                                           2058.862                                                           2086.058
Jan 2003                                                           1795.485                                                           1839.579
Feb 2003                                                           1776.713                                                           1800.675
Mar 2003                                                           2079.170                                                           2078.287
Apr 2003                                                           2127.209                                                           2095.374
May 2003                                                           2141.766                                                           2164.986
Jun 2003                                                           2080.179                                                           2135.698
Jul 2003                                                           2238.568                                                           2238.054
Aug 2003                                                           2239.337                                                           2288.641
Sep 2003                                                           1880.666                                                           1936.292
Oct 2003                                                           2057.473                                                           2077.038
Nov 2003                                                           2032.064                                                           2061.277
Dec 2003                                                           2098.674                                                           2127.881
Jan 2004                                                           1836.851                                                           1881.403
Feb 2004                                                           1818.291                                                           1842.499
Mar 2004                                                           2122.592                                                           2120.110
         structure.c.1679.09101331696..1582.97636089056..1854.1526980279...1 structure.c.1678.35741584976..1659.14175244523..1922.31374524569..
Apr 2001                                                            2114.515                                                           2018.252
May 2001                                                            2141.721                                                           2036.507
Jun 2001                                                            2100.250                                                           1976.389
Jul 2001                                                            2197.710                                                           2098.849
Aug 2001                                                            2249.223                                                           2138.361
Sep 2001                                                            1934.896                                                           1831.641
Oct 2001                                                            2038.874                                                           1976.682
Nov 2001                                                            2031.588                                                           1940.156
Dec 2001                                                            2097.246                                                           2017.477
Jan 2002                                                            1866.162                                                           1776.861
Feb 2002                                                            1796.292                                                           1715.759
Mar 2002                                                            2119.440                                                           2044.700
Apr 2002                                                            2161.096                                                           2045.575
May 2002                                                            2188.302                                                           2067.707
Jun 2002                                                            2146.831                                                           2007.589
Jul 2002                                                            2244.290                                                           2130.049
Aug 2002                                                            2295.804                                                           2169.560
Sep 2002                                                            1981.477                                                           1862.841
Oct 2002                                                            2085.455                                                           2007.881
Nov 2002                                                            2078.169                                                           1971.355
Dec 2002                                                            2143.827                                                           2048.676
Jan 2003                                                            1912.743                                                           1808.061
Feb 2003                                                            1842.873                                                           1746.959
Mar 2003                                                            2166.021                                                           2075.900
Apr 2003                                                            2207.677                                                           2076.774
May 2003                                                            2234.883                                                           2098.906
Jun 2003                                                            2193.412                                                           2038.789
Jul 2003                                                            2290.871                                                           2161.249
Aug 2003                                                            2342.384                                                           2200.760
Sep 2003                                                            2028.058                                                           1894.041
Oct 2003                                                            2132.036                                                           2039.081
Nov 2003                                                            2124.750                                                           2002.555
Dec 2003                                                            2190.408                                                           2079.876
Jan 2004                                                            1959.324                                                           1839.261
Feb 2004                                                            1889.454                                                           1778.159
Mar 2004                                                            2212.602                                                           2107.100
         structure.c.1749.43655465283..1627.75975450604..1938.84571798435.. structure.c.1708.70814512987..1627.21507234922..1928.33469491881..
Apr 2001                                                           2001.373                                                           1967.715
May 2001                                                           2017.679                                                           2029.788
Jun 2001                                                           1982.402                                                           1993.337
Jul 2001                                                           2086.002                                                           2115.100
Aug 2001                                                           2147.804                                                           2182.032
Sep 2001                                                           1849.676                                                           1883.818
Oct 2001                                                           1949.154                                                           1986.041
Nov 2001                                                           1950.808                                                           1980.423
Dec 2001                                                           1983.631                                                           1988.060
Jan 2002                                                           1754.202                                                           1762.691
Feb 2002                                                           1650.766                                                           1728.377
Mar 2002                                                           1983.425                                                           2020.869
Apr 2002                                                           2027.536                                                           2012.731
May 2002                                                           2045.424                                                           2071.821
Jun 2002                                                           2010.810                                                           2034.271
Jul 2002                                                           2114.688                                                           2155.629
Aug 2002                                                           2176.606                                                           2222.411
Sep 2002                                                           1878.527                                                           1924.142
Oct 2002                                                           1978.026                                                           2026.345
Nov 2002                                                           1979.688                                                           2020.719
Dec 2002                                                           2012.515                                                           2028.353
Jan 2003                                                           1783.087                                                           1802.984
Feb 2003                                                           1679.652                                                           1768.669
Mar 2003                                                           2012.311                                                           2061.161
Apr 2003                                                           2056.423                                                           2053.023
May 2003                                                           2074.310                                                           2112.113
Jun 2003                                                           2039.696                                                           2074.563
Jul 2003                                                           2143.575                                                           2195.920
Aug 2003                                                           2205.493                                                           2262.703
Sep 2003                                                           1907.413                                                           1964.434
Oct 2003                                                           2006.912                                                           2066.637
Nov 2003                                                           2008.575                                                           2061.010
Dec 2003                                                           2041.401                                                           2068.645
Jan 2004                                                           1811.973                                                           1843.275
Feb 2004                                                           1708.538                                                           1808.961
Mar 2004                                                           2041.197                                                           2101.453</code></pre>
</div>
</div>
<p><code>Result!</code> 위에서 생성한 10개의 ARIMA 예측 모형 각각에 대해 예측값이 생성된 것을 확인할 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(train.ts) <span class="sc">+</span>                                          <span class="co"># 원 시계열  </span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(sim, <span class="at">colour =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>                             <span class="co"># 붓스트랩 시계열  </span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(fc, <span class="at">colour =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>                              <span class="co"># 특정 시점까지의 예측값</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(train.ts, <span class="at">colour =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>                       <span class="co"># 원 시계열을 한 번 더 지정해서 맨 앞으로 가져오기 </span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bootrstrapped series"</span>) <span class="sc">+</span> </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 평균을 이용한 최종 예측 </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(fc, <span class="dv">1</span>, mean)                                            <span class="co"># 중앙값일 경우, mean -&gt; median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2011.275 2046.538 2011.995 2128.735 2173.296 1854.247 1987.562 1969.926 2016.940 1778.846 1727.914 2037.484 2053.980 2085.638 2050.956 2171.362 2213.701 1899.476 2032.231 2011.859 2061.631
[22] 1822.900 1773.356 2079.920 2097.648 2131.956 2096.758 2215.920 2258.194 1943.992 2076.161 2057.099 2104.918 1867.066 1817.309 2123.290</code></pre>
</div>
</div>
</section>
<section id="ver.-2-1" class="level4" data-number="12.3.2.2">
<h4 data-number="12.3.2.2" class="anchored" data-anchor-id="ver.-2-1"><span class="header-section-number">12.3.2.2</span> Ver. 2</h4>
<p><code>Caution!</code> 붓스트랩 시계열을 생성하고 각각에 ARIMA 예측 모형을 생성하는 과정은 함수 <code>baggedModel()</code>를 통해 수행할 수 있다. 예를 들어, 10개의 붓스트랩 시계열 각각에 대해 ARIMA 예측 모형을 생성하는 코드 <code>lapply(bld.mbb.bootstrap(train.ts, 10), function(x){auto.arima(x)})</code>은<br>
<code>baggedModel(train.ts, bld.mbb.bootstrap(train.ts, 10), fn = auto.arima)</code>와 동일하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-4번 : 10개의 붓스트랩 시계열을 생성하고 각각에 ARIMA 예측 모형을 생성한 후 예측</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)                                                          <span class="co"># Seed 고정 -&gt; 동일한 결과를 출력하기 위해</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>baggedfc <span class="ot">&lt;-</span> train.ts <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">baggedModel</span>(<span class="fu">bld.mbb.bootstrap</span>(train.ts, <span class="dv">10</span>), <span class="at">fn =</span> auto.arima) <span class="sc">%&gt;%</span>   <span class="co"># 10개의 붓스트랩 시계열을 생성한 후, 각각에 ARIMA 예측 모형 생성    </span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> nTest)                                                 <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>baggedfc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast   Lo 100   Hi 100
Apr 2001       2011.275 1946.126 2114.515
May 2001       2046.538 1990.483 2141.721
Jun 2001       2011.995 1966.504 2100.250
Jul 2001       2128.735 2073.705 2197.710
Aug 2001       2173.296 2132.357 2249.223
Sep 2001       1854.247 1780.384 1934.896
Oct 2001       1987.562 1946.543 2038.874
Nov 2001       1969.926 1928.296 2031.588
Dec 2001       2016.940 1969.384 2097.246
Jan 2002       1778.846 1728.930 1866.162
Feb 2002       1727.914 1650.766 1796.292
Mar 2002       2037.484 1980.485 2119.440
Apr 2002       2053.980 1963.555 2161.096
May 2002       2085.638 2007.911 2188.302
Jun 2002       2050.956 1983.933 2146.831
Jul 2002       2171.362 2091.133 2244.290
Aug 2002       2213.701 2149.786 2295.804
Sep 2002       1899.476 1832.661 1981.477
Oct 2002       2032.231 1963.971 2085.455
Nov 2002       2011.859 1945.725 2078.169
Dec 2002       2061.631 1986.813 2143.827
Jan 2003       1822.900 1746.359 1912.743
Feb 2003       1773.356 1679.652 1859.505
Mar 2003       2079.920 1997.913 2166.021
Apr 2003       2097.648 1980.983 2207.677
May 2003       2131.956 2025.340 2234.883
Jun 2003       2096.758 2001.361 2193.412
Jul 2003       2215.920 2108.562 2290.871
Aug 2003       2258.194 2167.215 2342.384
Sep 2003       1943.992 1850.089 2028.058
Oct 2003       2076.161 1981.400 2152.676
Nov 2003       2057.099 1963.154 2124.750
Dec 2003       2104.918 2004.241 2190.408
Jan 2004       1867.066 1763.787 1959.324
Feb 2004       1817.309 1708.538 1934.292
Mar 2004       2123.290 2015.342 2212.602</code></pre>
</div>
</div>
<p><code>Result!</code> 결과에서 Point Forecast는 특정 시점에서의 붓스트랩 예측값들의 평균이며, 위의 “Ver.1”에서 “4. 평균을 이용한 최종 예측”과 결과가 동일하다. Lo 100은 특정 시점에서의 붓스트랩 예측값들의 최솟값, Hi 100는 특정 시점에서의 붓스트랩 예측값들의 최댓값을 의미한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서 각 붓스트랩 시계열의 예측값</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>forecasts_boot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]     [,9]    [,10]
 [1,] 2019.638 1946.126 1959.780 2018.250 2047.047 2020.052 2114.515 2018.252 2001.373 1967.715
 [2,] 2047.291 1990.483 2007.728 2037.752 2071.845 2084.582 2141.721 2036.507 2017.679 2029.788
 [3,] 2041.622 1966.504 2002.863 1982.542 2020.729 2053.314 2100.250 1976.389 1982.402 1993.337
 [4,] 2138.616 2073.705 2148.797 2114.069 2159.599 2154.900 2197.710 2098.849 2086.002 2115.100
 [5,] 2168.222 2132.357 2200.887 2153.390 2155.499 2205.186 2249.223 2138.361 2147.804 2182.032
 [6,] 1857.933 1815.232 1875.048 1861.116 1780.384 1852.720 1934.896 1831.641 1849.676 1883.818
 [7,] 2004.558 1946.543 2025.012 1994.538 1960.800 1993.420 2038.874 1976.682 1949.154 1986.041
 [8,] 2007.457 1928.296 1974.805 1963.343 1944.741 1977.642 2031.588 1940.156 1950.808 1980.423
 [9,] 2033.645 1969.384 2028.643 2012.374 1994.697 2044.239 2097.246 2017.477 1983.631 1988.060
[10,] 1758.009 1728.930 1802.989 1799.925 1740.931 1797.758 1866.162 1776.861 1754.202 1762.691
[11,] 1735.541 1689.149 1699.039 1781.426 1723.938 1758.853 1796.292 1715.759 1650.766 1728.377
[12,] 2049.103 1980.485 2032.671 2070.293 2037.394 2036.464 2119.440 2044.700 1983.425 2020.869
[13,] 2067.463 1963.555 2041.260 2083.183 2083.846 2053.551 2161.096 2045.575 2027.536 2012.731
[14,] 2097.259 2007.911 2077.558 2080.770 2096.466 2123.163 2188.302 2067.707 2045.424 2071.821
[15,] 2092.279 1983.933 2067.220 2040.338 2032.419 2093.874 2146.831 2007.589 2010.810 2034.271
[16,] 2189.496 2091.133 2212.247 2185.448 2194.410 2196.231 2244.290 2130.049 2114.688 2155.629
[17,] 2219.174 2149.786 2239.092 2222.041 2195.716 2246.818 2295.804 2169.560 2176.606 2222.411
[18,] 1908.908 1832.661 1927.974 1943.620 1840.143 1894.469 1981.477 1862.841 1878.527 1924.142
[19,] 2055.540 1963.971 2073.749 2080.093 2016.035 2035.214 2085.455 2007.881 1978.026 2026.345
[20,] 2058.441 1945.725 2045.561 2010.808 1988.667 2019.454 2078.169 1971.355 1979.688 2020.719
[21,] 2084.631 1986.813 2098.291 2068.288 2058.862 2086.058 2143.827 2048.676 2012.515 2028.353
[22,] 1808.995 1746.359 1868.975 1862.732 1795.485 1839.579 1912.743 1808.061 1783.087 1802.984
[23,] 1786.527 1706.577 1765.405 1859.505 1776.713 1800.675 1842.873 1746.959 1679.652 1768.669
[24,] 2100.089 1997.913 2089.463 2138.886 2079.170 2078.287 2166.021 2075.900 2012.311 2061.161
[25,] 2118.449 1980.983 2103.630 2156.937 2127.209 2095.374 2207.677 2076.774 2056.423 2053.023
[26,] 2148.244 2025.340 2143.637 2175.371 2141.766 2164.986 2234.883 2098.906 2074.310 2112.113
[27,] 2143.265 2001.361 2135.408 2125.207 2080.179 2135.698 2193.412 2038.789 2039.696 2074.563
[28,] 2240.482 2108.562 2281.327 2260.596 2238.568 2238.054 2290.871 2161.249 2143.575 2195.920
[29,] 2270.159 2167.215 2308.236 2297.012 2239.337 2288.641 2342.384 2200.760 2205.493 2262.703
[30,] 1959.893 1850.089 1996.696 2022.338 1880.666 1936.292 2028.058 1894.041 1907.413 1964.434
[31,] 2106.526 1981.400 2141.829 2152.676 2057.473 2077.038 2132.036 2039.081 2006.912 2066.637
[32,] 2109.427 1963.154 2112.960 2095.217 2032.064 2061.277 2124.750 2002.555 2008.575 2061.010
[33,] 2135.616 2004.241 2165.084 2137.357 2098.674 2127.881 2190.408 2079.876 2041.401 2068.645
[34,] 1859.980 1763.787 1935.290 1939.521 1836.851 1881.403 1959.324 1839.261 1811.973 1843.275
[35,] 1837.513 1724.006 1831.382 1934.292 1818.291 1842.499 1889.454 1778.159 1708.538 1808.961
[36,] 2151.075 2015.342 2155.231 2206.195 2122.592 2120.110 2212.602 2107.100 2041.197 2101.453</code></pre>
</div>
</div>
<p><code>Result!</code> 열 번호는 생성된 10개의 붓스트랩 시계열 각각을 의미하며, 각 열의 값들은 특정 시점까지 붓스트랩 시계열에 대한 예측값이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서의 붓스트랩 예측값들의 평균</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            2011.275 2046.538 2011.995 2128.735 2173.296 1854.247 1987.562 1969.926 2016.940
2002 1778.846 1727.914 2037.484 2053.980 2085.638 2050.956 2171.362 2213.701 1899.476 2032.231 2011.859 2061.631
2003 1822.900 1773.356 2079.920 2097.648 2131.956 2096.758 2215.920 2258.194 1943.992 2076.161 2057.099 2104.918
2004 1867.066 1817.309 2123.290                                                                                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 특정 시점에서의 붓스트랩 예측값들의 중앙값</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>baggedfc<span class="sc">$</span>median</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            2018.251 2037.130 1998.100 2126.858 2161.861 1855.327 1989.731 1969.074 2014.925
2002 1769.776 1726.158 2036.929 2049.563 2079.164 2037.304 2187.472 2220.607 1901.688 2030.780 2015.131 2063.575
2003 1808.528 1772.691 2078.728 2099.502 2142.702 2102.693 2238.311 2266.431 1948.093 2071.837 2061.144 2113.278
2004 1851.628 1824.837 2121.351                                                                                 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% Predictive Interval</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>boot.pred <span class="ot">&lt;-</span> <span class="fu">t</span>(baggedfc<span class="sc">$</span>forecasts_boot)                       <span class="co"># 특정 시점에서 각 붓스트랩 시계열의 예측값</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>PI.pred   <span class="ot">&lt;-</span> <span class="fu">apply</span>(boot.pred, <span class="dv">2</span>, <span class="cf">function</span>(x) { <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>) ) })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Result!</code> 95% 예측 구간은 붓스트랩 시계열에 대한 예측값들의 분위수를 계산하여 얻을 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Results for 95% Predictive Interval </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="st">"PI.lower"</span> <span class="ot">=</span> PI.pred[<span class="dv">1</span>,], <span class="st">"PI.upper"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,], </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"length of PI"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,]<span class="sc">-</span>PI.pred[<span class="dv">1</span>,]) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   PI.lower PI.upper length.of.PI
      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
 1    1949.    2099.        150. 
 2    1994.    2129.        135. 
 3    1969.    2090.        121. 
 4    2076.    2189.        113. 
 5    2134.    2239.        106. 
 6    1788.    1923.        135. 
 7    1947.    2036.         88.6
 8    1931.    2026.         95.2
 9    1973.    2085.        113. 
10    1732.    1852.        120. 
# ℹ 26 more rows</code></pre>
</div>
</div>
</section>
<section id="예측-결과-비교-1" class="level4" data-number="12.3.2.3">
<h4 data-number="12.3.2.3" class="anchored" data-anchor-id="예측-결과-비교-1"><span class="header-section-number">12.3.2.3</span> 예측 결과 비교</h4>
<ul>
<li>원 시계열을 이용한 예측 결과와 배깅을 이용한 예측 결과를 비교한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 원 시계열에 대한 예측</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>arimafc    <span class="ot">&lt;-</span> train.ts <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">auto.arima</span>() <span class="sc">%&gt;%</span>                                            <span class="co"># ARIMA 예측 모형 생성</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">forecast</span>(<span class="at">h =</span> nTest)                                         <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(train.ts) <span class="sc">+</span>                                          <span class="co"># 원 시계열 </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Ridership"</span>) <span class="sc">+</span>                                         <span class="co"># y축 라벨 </span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(arimafc, <span class="at">series =</span> <span class="st">"auto.arima"</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>     <span class="co"># 원 시계열에 대한 예측 결과</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(baggedfc, <span class="at">series =</span> <span class="st">"BaggedARIMA"</span>, <span class="at">PI =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>   <span class="co"># 배깅을 이용한 예측 결과</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour=</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Prediction"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with Predictive Interval</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Original Prediction Result</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>Original <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Date"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">time</span>(test.ts)),                    <span class="co"># Date</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Y"</span> <span class="ot">=</span> <span class="fu">c</span>(test.ts),                                      <span class="co"># Test Dataset</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Pred"</span> <span class="ot">=</span> <span class="fu">c</span>(arimafc<span class="sc">$</span>mean),                              <span class="co"># Prediction Result</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"PI.lower"</span> <span class="ot">=</span> <span class="fu">c</span>(arimafc<span class="sc">$</span>lower[,<span class="dv">2</span>]),                     <span class="co"># Lower of Predictive Interval</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"PI.upper"</span> <span class="ot">=</span> <span class="fu">c</span>(arimafc<span class="sc">$</span>upper[,<span class="dv">2</span>]),                     <span class="co"># Upper of Predictive Interval</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Type"</span> <span class="ot">=</span> <span class="st">"Original"</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>Original <span class="sc">%&gt;%</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
    Date     Y  Pred PI.lower PI.upper Type    
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
 1 2001. 2024. 2020.    1895.    2144. Original
 2 2001. 2047. 2047.    1904.    2191. Original
 3 2001. 2073. 2042.    1888.    2196. Original
 4 2002. 2127. 2139.    1977.    2300. Original
 5 2002. 2203. 2168.    2000.    2337. Original
 6 2002. 1708. 1858.    1683.    2033. Original
 7 2002. 1951. 2005.    1823.    2186. Original
 8 2002. 1974. 2007.    1820.    2195. Original
 9 2002. 1985. 2034.    1841.    2227. Original
10 2002  1760. 1758.    1559.    1957. Original
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. Bagging Prediction Result</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>Bagging <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Date"</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">time</span>(test.ts)),                     <span class="co"># Date</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Y"</span> <span class="ot">=</span> <span class="fu">c</span>(test.ts),                                       <span class="co"># Test Dataset</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Pred"</span> <span class="ot">=</span> <span class="fu">c</span>(baggedfc<span class="sc">$</span>mean),                              <span class="co"># Prediction Result</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"PI.lower"</span> <span class="ot">=</span> PI.pred[<span class="dv">1</span>,],                               <span class="co"># Lower of Predictive Interval</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"PI.upper"</span> <span class="ot">=</span> PI.pred[<span class="dv">2</span>,],                               <span class="co"># Upper of Predictive Interval</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Type"</span> <span class="ot">=</span> <span class="st">"Bagging"</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>Bagging <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 6
    Date     Y  Pred PI.lower PI.upper Type   
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  
 1 2001. 2024. 2011.    1949.    2099. Bagging
 2 2001. 2047. 2047.    1994.    2129. Bagging
 3 2001. 2073. 2012.    1969.    2090. Bagging
 4 2002. 2127. 2129.    2076.    2189. Bagging
 5 2002. 2203. 2173.    2134.    2239. Bagging
 6 2002. 1708. 1854.    1788.    1923. Bagging
 7 2002. 1951. 1988.    1947.    2036. Bagging
 8 2002. 1974. 1970.    1931.    2026. Bagging
 9 2002. 1985. 2017.    1973.    2085. Bagging
10 2002  1760. 1779.    1732.    1852. Bagging
# ℹ 26 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 3. Combine</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Original, Bagging)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 72 × 6
    Date     Y  Pred PI.lower PI.upper Type    
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   
 1 2001. 2024. 2020.    1895.    2144. Original
 2 2001. 2047. 2047.    1904.    2191. Original
 3 2001. 2073. 2042.    1888.    2196. Original
 4 2002. 2127. 2139.    1977.    2300. Original
 5 2002. 2203. 2168.    2000.    2337. Original
 6 2002. 1708. 1858.    1683.    2033. Original
 7 2002. 1951. 2005.    1823.    2186. Original
 8 2002. 1974. 2007.    1820.    2195. Original
 9 2002. 1985. 2034.    1841.    2227. Original
10 2002  1760. 1758.    1559.    1957. Original
# ℹ 62 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 4. Plot</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Pred, <span class="at">group =</span> Type)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">col =</span> Type)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y)) <span class="sc">+</span>                                                    <span class="co"># Test Dataset                </span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> PI.lower, <span class="at">ymax =</span> PI.upper), <span class="at">fill =</span> <span class="st">"grey30"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Bagging_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예측 정확도</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">accuracy</span>(arimafc<span class="sc">$</span>mean, test.ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                ME     RMSE     MAE      MPE     MAPE      ACF1 Theil's U
Test set -45.98599 76.50042 53.0434 -2.38829 2.739223 0.5795161 0.4483051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">accuracy</span>(baggedfc<span class="sc">$</span>mean, test.ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                ME     RMSE      MAE       MPE     MAPE      ACF1 Theil's U
Test set -28.79187 67.63581 46.62996 -1.543973 2.417507 0.5488607 0.3926581</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./TBATS.html" class="pagination-link" aria-label="TBATS">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">TBATS</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ensemble.html" class="pagination-link" aria-label="Ensemble">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ensemble</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>