<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Young Eun Jeon, Jeong-Wook Lee, and Jung-In Seo">

<title>7&nbsp; Regression-based Forecasting – Time Series Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./DHR.html" rel="next">
<link href="./SARIMA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ef31e3f4d9d6eef55c54bdf6b9cd68ca.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Regression.html">Advanced Model</a></li><li class="breadcrumb-item"><a href="./Regression.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JJJJYE/TS" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Autoregressive Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Seasonal Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DHR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Harmonic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./STLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">STLM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BSTS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dynamic Linear Model and Bayesian Structural Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TBATS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">TBATS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bagging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ensemble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ensemble</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Neuron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Neural Network Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ML &amp; DL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Imputation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imputation using Kalman Smoothing</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#amtrak" id="toc-amtrak" class="nav-link active" data-scroll-target="#amtrak"><span class="header-section-number">7.1</span> Amtrak</a>
  <ul class="collapse">
  <li><a href="#데이터-불러오기" id="toc-데이터-불러오기" class="nav-link" data-scroll-target="#데이터-불러오기"><span class="header-section-number">7.1.1</span> 데이터 불러오기</a></li>
  <li><a href="#데이터-전처리" id="toc-데이터-전처리" class="nav-link" data-scroll-target="#데이터-전처리"><span class="header-section-number">7.1.2</span> 데이터 전처리</a></li>
  <li><a href="#데이터-분할" id="toc-데이터-분할" class="nav-link" data-scroll-target="#데이터-분할"><span class="header-section-number">7.1.3</span> 데이터 분할</a></li>
  </ul></li>
  <li><a href="#model-with-trend" id="toc-model-with-trend" class="nav-link" data-scroll-target="#model-with-trend"><span class="header-section-number">7.2</span> Model with Trend</a>
  <ul class="collapse">
  <li><a href="#선형-추세" id="toc-선형-추세" class="nav-link" data-scroll-target="#선형-추세"><span class="header-section-number">7.2.1</span> 선형 추세</a></li>
  <li><a href="#지수-추세" id="toc-지수-추세" class="nav-link" data-scroll-target="#지수-추세"><span class="header-section-number">7.2.2</span> 지수 추세</a></li>
  <li><a href="#다항-추세" id="toc-다항-추세" class="nav-link" data-scroll-target="#다항-추세"><span class="header-section-number">7.2.3</span> 다항 추세</a></li>
  </ul></li>
  <li><a href="#model-with-seasonality" id="toc-model-with-seasonality" class="nav-link" data-scroll-target="#model-with-seasonality"><span class="header-section-number">7.3</span> Model with Seasonality</a>
  <ul class="collapse">
  <li><a href="#additive-계절성" id="toc-additive-계절성" class="nav-link" data-scroll-target="#additive-계절성"><span class="header-section-number">7.3.1</span> Additive 계절성</a></li>
  <li><a href="#multiplicative-계절성" id="toc-multiplicative-계절성" class="nav-link" data-scroll-target="#multiplicative-계절성"><span class="header-section-number">7.3.2</span> Multiplicative 계절성</a></li>
  </ul></li>
  <li><a href="#model-with-trend-and-seasonality" id="toc-model-with-trend-and-seasonality" class="nav-link" data-scroll-target="#model-with-trend-and-seasonality"><span class="header-section-number">7.4</span> Model with Trend and Seasonality</a></li>
  <li><a href="#autocorrelation-and-arima-model" id="toc-autocorrelation-and-arima-model" class="nav-link" data-scroll-target="#autocorrelation-and-arima-model"><span class="header-section-number">7.5</span> Autocorrelation and ARIMA Model</a>
  <ul class="collapse">
  <li><a href="#autocorrelation" id="toc-autocorrelation" class="nav-link" data-scroll-target="#autocorrelation"><span class="header-section-number">7.5.1</span> Autocorrelation</a></li>
  <li><a href="#잔차에-대한-2차-예측모형-구축" id="toc-잔차에-대한-2차-예측모형-구축" class="nav-link" data-scroll-target="#잔차에-대한-2차-예측모형-구축"><span class="header-section-number">7.5.2</span> 잔차에 대한 2차 예측모형 구축</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Regression.html">Advanced Model</a></li><li class="breadcrumb-item"><a href="./Regression.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>회귀모형에 기반한 예측 방법의 순서도는 다음과 같다.</p>
</blockquote>
<center>
<img src="./image/regression.png" class="img-fluid" style="width:70.0%">
</center>
<p><br></p>
<section id="amtrak" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="amtrak"><span class="header-section-number">7.1</span> Amtrak</h2>
<p>예제 데이터로 사용하는 <code>"Amtrak.csv"</code>은 1991년 1월부터 2004년 3월까지 미국 철도 회사인 암트랙에서 제공한 월간 승객 수(단위 : 1,000명)가 기록되어져 있다.</p>
<section id="데이터-불러오기" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="데이터-불러오기"><span class="header-section-number">7.1.1</span> 데이터 불러오기</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"forecast"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"dplyr"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">".../Amtrak.csv"</span>)          <span class="co"># 데이터 불러오기</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="sc">%&gt;%</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 2
   Month      Ridership
   &lt;chr&gt;          &lt;dbl&gt;
 1 01/01/1991     1709.
 2 01/02/1991     1621.
 3 01/03/1991     1973.
 4 01/04/1991     1812.
 5 01/05/1991     1975.
 6 01/06/1991     1862.
 7 01/07/1991     1940.
 8 01/08/1991     2013.
 9 01/09/1991     1596.
10 01/10/1991     1725.
# ℹ 149 more rows</code></pre>
</div>
</div>
</section>
<section id="데이터-전처리" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="데이터-전처리"><span class="header-section-number">7.1.2</span> 데이터 전처리</h3>
<p><code>Caution!</code> CSV 파일로 불러온 데이터를 살펴보면 승객 수를 포함하는 변수 <code>Ridership</code>가 수치형임을 알 수 있다. 시계열 데이터 분석을 위해 함수 <code>ts()</code>를 이용하여 해당 변수를 시계열 객체로 변환해야 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ts로 변환</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ridership.ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(Amtrak.data<span class="sc">$</span>Ridership, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">1</span>),            <span class="co"># 시계열의 시작 연도 / c(1991, 1) : 1991년 1월</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">frequency =</span> <span class="dv">12</span>)                <span class="co"># 주기 / 월별 시계열로 1년에 12번 관측</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridership.ts, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Ridership (in 000s)"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2300</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 시계열 그림을 살펴보면 <code>Amtrak</code> 데이터는 U자 형태의 추세를 발견할 수 있으며, 여름(7월과 8월) 동안에 승객이 급증하는 뚜렷한 계절변동도 볼 수 있다.</p>
</section>
<section id="데이터-분할" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="데이터-분할"><span class="header-section-number">7.1.3</span> 데이터 분할</h3>
<p><code>Caution!</code> 시계열 데이터 분석 시 모형의 과적합을 피하고 미래 데이터에 대한 예측력을 계산하기 위해 <code>Training Dataset</code>과 <code>Test Dataset</code>으로 분할해야 한다. 시계열 데이터의 경우, 시간에 의존하기 때문에 시간 순서를 고려하여 데이터를 분할해야 한다. 즉, 앞 시점의 데이터를 <code>Training Dataset</code>로 사용하여 모형을 구축하고, 뒷 시점의 데이터를 <code>Test Dataset</code>로 사용하여 구축된 모형의 성능을 평가한다. 여기서는 데이터 분할을 위해 함수 <code>window()</code>를 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>train.ts <span class="ot">&lt;-</span> <span class="fu">window</span>(ridership.ts, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">1</span>),            <span class="co"># 분할하고자 하는 시계열의 시작 연도 / c(1991, 1) : 1991년 1월</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">3</span>))              <span class="co"># 분할하고자 하는 시계열의 마지막 연도 / c(2001, 3) : 2001년 3월</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>test.ts <span class="ot">&lt;-</span> <span class="fu">window</span>(ridership.ts,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2001</span>, <span class="dv">4</span>))            <span class="co"># 분할하고자 하는 시계열의 시작 연도 / c(2001, 4) : 2001년 4월</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>nTest   <span class="ot">&lt;-</span> <span class="fu">length</span>(test.ts)                        <span class="co"># Test Dataset의 데이터 포인트 개수</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>train.ts </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
1991 1708.917 1620.586 1972.715 1811.665 1974.964 1862.356 1939.860 2013.264 1595.657 1724.924 1675.667 1813.863
1992 1614.827 1557.088 1891.223 1955.981 1884.714 1623.042 1903.309 1996.712 1703.897 1810.000 1861.601 1875.122
1993 1705.259 1618.535 1836.709 1957.043 1917.185 1882.398 1933.009 1996.167 1672.841 1752.827 1720.377 1734.292
1994 1563.365 1573.959 1902.639 1833.888 1831.049 1775.755 1867.508 1906.608 1685.632 1778.546 1775.995 1783.350
1995 1548.415 1496.925 1798.316 1732.895 1772.345 1761.207 1791.655 1874.820 1571.309 1646.948 1672.631 1656.845
1996 1381.758 1360.852 1558.575 1608.420 1696.696 1693.183 1835.516 1942.573 1551.401 1686.508 1576.204 1700.433
1997 1396.588 1371.690 1707.522 1654.604 1762.903 1775.800 1934.219 2008.055 1615.924 1773.910 1732.368 1796.626
1998 1570.330 1412.691 1754.641 1824.932 1843.289 1825.964 1968.172 1921.645 1669.597 1791.474 1816.714 1846.754
1999 1599.427 1548.804 1832.333 1839.720 1846.498 1864.852 1965.743 1949.002 1607.373 1803.664 1850.309 1836.435
2000 1541.660 1616.928 1919.538 1971.493 1992.301 2009.763 2053.996 2097.471 1823.706 1976.997 1981.408 2000.153
2001 1683.148 1663.404 2007.928                                                                                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>test.ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            2023.792 2047.008 2072.913 2126.717 2202.638 1707.693 1950.716 1973.614 1984.729
2002 1759.629 1770.595 2019.912 2048.398 2068.763 1994.267 2075.258 2026.560 1734.155 1916.771 1858.345 1996.352
2003 1778.033 1749.489 2066.466 2098.899 2104.911 2129.671 2223.349 2174.360 1931.406 2121.470 2076.054 2140.677
2004 1831.508 1838.006 2132.446                                                                                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>nTest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
</div>
</section>
</section>
<section id="model-with-trend" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="model-with-trend"><span class="header-section-number">7.2</span> Model with Trend</h2>
<p>예제 데이터 <code>Amtrak</code>은 전반적인 추세가 선형인 것 같지 않지만 선형 추세가 어떻게 구축되는지 설명하기 위해서 먼저 가장 간단한 선형 추세를 고려해본다.</p>
<p><br></p>
<section id="선형-추세" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="선형-추세"><span class="header-section-number">7.2.1</span> 선형 추세</h3>
<ul>
<li>가장 간단한 선형추세모형은 <span class="math inline">\(Y_{t}=\beta_{0}+\beta_{1}t+\epsilon_t\)</span>이다.
<ul>
<li><span class="math inline">\(Y_{t}\)</span> : 시점 <span class="math inline">\(t\)</span>에서의 관측값</li>
<li><span class="math inline">\(t\)</span> : 시간인덱스로써 <span class="math inline">\(1, 2, \ldots, n\)</span></li>
<li><span class="math inline">\(\beta_{0}\)</span> : 수준(Level)</li>
<li><span class="math inline">\(\beta_{1}\)</span> : 추세(Trend)에 대한 회귀계수</li>
<li><span class="math inline">\(\epsilon_t\)</span> : 잡음(Noise)</li>
</ul></li>
</ul>
<p><br></p>
<p><code>Caution!</code> Package <code>"forecast"</code>에서 제공하는 함수 <code>tslm()</code>를 이용하여 쉽게 시계열에 회귀모형을 적용할 수 있다. 선형추세를 가지는 모형은 함수 <code>tslm()</code>에 <code>Target ~ trend</code>를 해주면 된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형 추세를 반영한 회귀모형</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train.lm  <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span> trend)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm)                                 <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ trend)

Residuals:
    Min      1Q  Median      3Q     Max 
-411.29 -114.02   16.06  129.28  306.35 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1750.3595    29.0729  60.206   &lt;2e-16 ***
trend          0.3514     0.4069   0.864     0.39    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 160.2 on 121 degrees of freedom
Multiple R-squared:  0.006125,  Adjusted R-squared:  -0.002089 
F-statistic: 0.7456 on 1 and 121 DF,  p-value: 0.3896</code></pre>
</div>
</div>
<p><code>Result!</code> 모형 구축 결과에 따르면, <span class="math inline">\(p\)</span>값이 0.3896으로 유의수준 0.05에서 <span class="math inline">\(p\)</span>값이 0.05보다 크기 때문에 추정된 회귀식이 시계열에 적절하다는 증거가 부족하다.</p>
<p><code>Caution!</code> 구축된 모형을 이용하여 예측을 수행하기 위해 Package <code>"forecast"</code>에서 제공하는 함수 <code>forecast()</code>를 이용하면 된다. 옵션 <code>h</code>에는 미래 몇 시점까지 예측할 것인지를 입력한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 선형추세모형을 이용한 예측</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>train.lm.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">h =</span> nTest,             <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">level =</span> <span class="dv">0</span>)             <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>train.lm.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       1793.930 1793.930 1793.930
May 2001       1794.281 1794.281 1794.281
Jun 2001       1794.632 1794.632 1794.632
Jul 2001       1794.984 1794.984 1794.984
Aug 2001       1795.335 1795.335 1795.335
Sep 2001       1795.687 1795.687 1795.687
Oct 2001       1796.038 1796.038 1796.038
Nov 2001       1796.389 1796.389 1796.389
Dec 2001       1796.741 1796.741 1796.741
Jan 2002       1797.092 1797.092 1797.092
Feb 2002       1797.443 1797.443 1797.443
Mar 2002       1797.795 1797.795 1797.795
Apr 2002       1798.146 1798.146 1798.146
May 2002       1798.498 1798.498 1798.498
Jun 2002       1798.849 1798.849 1798.849
Jul 2002       1799.200 1799.200 1799.200
Aug 2002       1799.552 1799.552 1799.552
Sep 2002       1799.903 1799.903 1799.903
Oct 2002       1800.254 1800.254 1800.254
Nov 2002       1800.606 1800.606 1800.606
Dec 2002       1800.957 1800.957 1800.957
Jan 2003       1801.308 1801.308 1801.308
Feb 2003       1801.660 1801.660 1801.660
Mar 2003       1802.011 1802.011 1802.011
Apr 2003       1802.363 1802.363 1802.363
May 2003       1802.714 1802.714 1802.714
Jun 2003       1803.065 1803.065 1803.065
Jul 2003       1803.417 1803.417 1803.417
Aug 2003       1803.768 1803.768 1803.768
Sep 2003       1804.119 1804.119 1804.119
Oct 2003       1804.471 1804.471 1804.471
Nov 2003       1804.822 1804.822 1804.822
Dec 2003       1805.174 1805.174 1805.174
Jan 2004       1805.525 1805.525 1805.525
Feb 2004       1805.876 1805.876 1805.876
Mar 2004       1806.228 1806.228 1806.228</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.pred, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.lm.pred<span class="sc">$</span>fitted, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)       </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차에 대한 시계열 그림</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm<span class="sc">$</span>residuals,                            <span class="co"># 잔차</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">420</span>, <span class="dv">500</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>),  <span class="co"># 축 범위</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,              <span class="co"># 축 이름</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 잔차 예측값</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts <span class="sc">-</span> train.lm.pred<span class="sc">$</span>mean)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 첫 번째 그래프는 구축된 선형추세모형으로부터 계산된 <code>Training Dataset</code>의 데이터 포인트에 대한 값과 예측값을 파란색 선으로 나타내고 있으며, 검은색 선은 실제값을 의미한다. 두 번째 그래프는 잔차에 대한 그래프이다. 이 두 그래프를 보면 추정값과 예측값이 실제값과 얼마나 차이가 나는지 볼 수 있으며, 잔차 그래프를 보면 잔차에 여전히 추세와 계절성이 남아있다는 것을 알 수 있다.</p>
</section>
<section id="지수-추세" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="지수-추세"><span class="header-section-number">7.2.2</span> 지수 추세</h3>
<ul>
<li>지수 추세는 시간에 따라서 시계열이 지수적으로 증가/감소하며 비선형 추세의 형태 중 하나이다.</li>
<li>모형식은 <span class="math inline">\(\log{Y_{t}}=\beta_{0}+\beta_{1}t+\epsilon_ t\)</span>로 <span class="math inline">\(Y_{t}=ce^{\beta_{1}t+\epsilon}\)</span>의 양변에 <span class="math inline">\(\log\)</span>를 취하여 비선형을 선형으로 변환하여 분석한다.</li>
</ul>
<p><br></p>
<p><code>Caution!</code> 지수 추세를 반영하기 위해서는 함수 <code>tslm()</code>에서 옵션 <code>lambda = 0</code>을 입력하면 된다. 옵션 <code>lambda</code>는 Box-Cox 변환을 적용하는데 사용되며, <code>lambda = 0</code>이면 <span class="math inline">\(\log{Y_{t}}\)</span>를 이용한다. 예측의 경우, <code>lambda = 0</code>을 입력해도 자동으로 원래 Scale로 변환된 결과를 출력한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 지수 추세를 반영한 회귀모형</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>train.lm.expo.trend      <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span> trend, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm.expo.trend)                                 <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ trend, lambda = 0)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.25989 -0.06184  0.01299  0.07457  0.16310 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 7.4646979  0.0168680 442.535   &lt;2e-16 ***
trend       0.0001783  0.0002361   0.755    0.451    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.09297 on 121 degrees of freedom
Multiple R-squared:  0.004694,  Adjusted R-squared:  -0.003532 
F-statistic: 0.5707 on 1 and 121 DF,  p-value: 0.4515</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 지수추세모형을 이용한 예측</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>train.lm.expo.trend.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm.expo.trend, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">h =</span> nTest,             <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">level =</span> <span class="dv">0</span>)             <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>train.lm.expo.trend.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       1784.356 1784.356 1784.356
May 2001       1784.674 1784.674 1784.674
Jun 2001       1784.993 1784.993 1784.993
Jul 2001       1785.311 1785.311 1785.311
Aug 2001       1785.629 1785.629 1785.629
Sep 2001       1785.948 1785.948 1785.948
Oct 2001       1786.266 1786.266 1786.266
Nov 2001       1786.585 1786.585 1786.585
Dec 2001       1786.904 1786.904 1786.904
Jan 2002       1787.222 1787.222 1787.222
Feb 2002       1787.541 1787.541 1787.541
Mar 2002       1787.860 1787.860 1787.860
Apr 2002       1788.179 1788.179 1788.179
May 2002       1788.498 1788.498 1788.498
Jun 2002       1788.817 1788.817 1788.817
Jul 2002       1789.136 1789.136 1789.136
Aug 2002       1789.455 1789.455 1789.455
Sep 2002       1789.774 1789.774 1789.774
Oct 2002       1790.093 1790.093 1790.093
Nov 2002       1790.413 1790.413 1790.413
Dec 2002       1790.732 1790.732 1790.732
Jan 2003       1791.052 1791.052 1791.052
Feb 2003       1791.371 1791.371 1791.371
Mar 2003       1791.690 1791.690 1791.690
Apr 2003       1792.010 1792.010 1792.010
May 2003       1792.330 1792.330 1792.330
Jun 2003       1792.649 1792.649 1792.649
Jul 2003       1792.969 1792.969 1792.969
Aug 2003       1793.289 1793.289 1793.289
Sep 2003       1793.609 1793.609 1793.609
Oct 2003       1793.929 1793.929 1793.929
Nov 2003       1794.249 1794.249 1794.249
Dec 2003       1794.569 1794.569 1794.569
Jan 2004       1794.889 1794.889 1794.889
Feb 2004       1795.209 1795.209 1795.209
Mar 2004       1795.529 1795.529 1795.529</code></pre>
</div>
</div>
<p><code>Result!</code> 예측값은 원래 Scale로 변환된 결과를 출력한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.expo.trend.pred, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.lm.expo.trend.pred<span class="sc">$</span>fitted, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="다항-추세" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="다항-추세"><span class="header-section-number">7.2.3</span> 다항 추세</h3>
<ul>
<li>다항 추세는 비선형 추세의 또 다른 형태이다.</li>
<li>예제 데이터 <code>Amtrak</code>은 U자 형태의 추세를 가지므로 2차 함수 형태를 고려하였으며 모형식은 <span class="math inline">\(Y_{t}=\beta_{0}+\beta_{1}t+\beta_{2}t^2+\epsilon_t\)</span>이다.</li>
</ul>
<p><br></p>
<p><code>Caution!</code> 다항 추세를 반영하기 위해 함수 <code>I()</code>를 이용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다항 추세를 반영한 회귀모형</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>train.lm.poly.trend      <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span> trend <span class="sc">+</span>  <span class="fu">I</span>(trend<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm.poly.trend)                                <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ trend + I(trend^2))

Residuals:
    Min      1Q  Median      3Q     Max 
-344.79 -101.86   40.89   98.54  279.81 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1888.88401   40.91521  46.166  &lt; 2e-16 ***
trend         -6.29780    1.52327  -4.134 6.63e-05 ***
I(trend^2)     0.05362    0.01190   4.506 1.55e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 148.8 on 120 degrees of freedom
Multiple R-squared:  0.1499,    Adjusted R-squared:  0.1358 
F-statistic: 10.58 on 2 and 120 DF,  p-value: 5.844e-05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 다항추세모형을 이용한 예측</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>train.lm.poly.trend.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm.poly.trend, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">h =</span> nTest,             <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">level =</span> <span class="dv">0</span>)             <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>train.lm.poly.trend.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       1932.454 1932.454 1932.454
May 2001       1939.508 1939.508 1939.508
Jun 2001       1946.670 1946.670 1946.670
Jul 2001       1953.938 1953.938 1953.938
Aug 2001       1961.314 1961.314 1961.314
Sep 2001       1968.797 1968.797 1968.797
Oct 2001       1976.388 1976.388 1976.388
Nov 2001       1984.085 1984.085 1984.085
Dec 2001       1991.890 1991.890 1991.890
Jan 2002       1999.803 1999.803 1999.803
Feb 2002       2007.822 2007.822 2007.822
Mar 2002       2015.949 2015.949 2015.949
Apr 2002       2024.182 2024.182 2024.182
May 2002       2032.523 2032.523 2032.523
Jun 2002       2040.972 2040.972 2040.972
Jul 2002       2049.527 2049.527 2049.527
Aug 2002       2058.190 2058.190 2058.190
Sep 2002       2066.960 2066.960 2066.960
Oct 2002       2075.838 2075.838 2075.838
Nov 2002       2084.822 2084.822 2084.822
Dec 2002       2093.914 2093.914 2093.914
Jan 2003       2103.113 2103.113 2103.113
Feb 2003       2112.419 2112.419 2112.419
Mar 2003       2121.833 2121.833 2121.833
Apr 2003       2131.354 2131.354 2131.354
May 2003       2140.982 2140.982 2140.982
Jun 2003       2150.717 2150.717 2150.717
Jul 2003       2160.560 2160.560 2160.560
Aug 2003       2170.509 2170.509 2170.509
Sep 2003       2180.566 2180.566 2180.566
Oct 2003       2190.731 2190.731 2190.731
Nov 2003       2201.002 2201.002 2201.002
Dec 2003       2211.381 2211.381 2211.381
Jan 2004       2221.867 2221.867 2221.867
Feb 2004       2232.460 2232.460 2232.460
Mar 2004       2243.161 2243.161 2243.161</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.poly.trend.pred, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.lm.poly.trend.pred<span class="sc">$</span>fitted, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)       </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차에 대한 시계열 그림</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.poly.trend<span class="sc">$</span>residuals,                 <span class="co"># 잔차</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">420</span>, <span class="dv">500</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>),  <span class="co"># 축 범위</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,              <span class="co"># 축 이름</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 잔차 예측값</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts <span class="sc">-</span> train.lm.poly.trend.pred<span class="sc">$</span>mean)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 첫 번째 그래프를 보면 앞선 <a href="#선형-추세">선형 추세</a>와 <a href="#지수-추세">지수 추세</a>보다 추세를 잘 잡아내고 있다는 것을 알 수 있다. 게다가, 두 번째 그래프를 보면 잔차에 대해 추세는 없으며 오직 계절성만 존재한다는 것을 알 수 있다.</p>
</section>
</section>
<section id="model-with-seasonality" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="model-with-seasonality"><span class="header-section-number">7.3</span> Model with Seasonality</h2>
<ul>
<li>계절 패턴은 시계열 패턴이 동일한 형태로 반복되는 현상을 의미한다.</li>
<li>계절성만 가지는 모형은 함수 <code>tslm()</code>에 <code>Target ~ season</code>을 입력하면 된다.
<ul>
<li>변수 <code>season</code>은 “0”과 “1” 값을 가지는 더미변수로 자동적으로 변환된다.</li>
<li>예를 들어, 예제 데이터 <code>Amtrak</code>은 변수 <code>Season</code>에 12개의 계절을 가지며, 분석을 위해 11개의 더미변수가 생성된다.</li>
</ul></li>
</ul>
<center>
<img src="./image/season.png" class="img-fluid">
</center>
<section id="additive-계절성" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="additive-계절성"><span class="header-section-number">7.3.1</span> Additive 계절성</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>train.lm.season      <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span>  season)     <span class="co"># 참조변수 = Season 1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm.season)                             <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ season)

Residuals:
     Min       1Q   Median       3Q      Max 
-276.165  -52.934    5.868   54.544  215.081 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1573.97      30.58  51.475  &lt; 2e-16 ***
season2       -42.93      43.24  -0.993   0.3230    
season3       260.77      43.24   6.030 2.19e-08 ***
season4       245.09      44.31   5.531 2.14e-07 ***
season5       278.22      44.31   6.279 6.81e-09 ***
season6       233.46      44.31   5.269 6.82e-07 ***
season7       345.33      44.31   7.793 3.79e-12 ***
season8       396.66      44.31   8.952 9.19e-15 ***
season9        75.76      44.31   1.710   0.0901 .  
season10      200.61      44.31   4.527 1.51e-05 ***
season11      192.36      44.31   4.341 3.14e-05 ***
season12      230.42      44.31   5.200 9.18e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 101.4 on 111 degrees of freedom
Multiple R-squared:  0.6348,    Adjusted R-squared:  0.5986 
F-statistic: 17.54 on 11 and 111 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><code>Result!</code> <code>season8</code>의 회귀계수는 396.66으로 8월의 평균 승객 수는 1월의 평균 승객 수보다 396.66배 높다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 계절변동을 반영한 회귀모형을 이용한 예측</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>train.lm.season.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm.season, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> nTest,          <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">level =</span> <span class="dv">0</span>)          <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>train.lm.season.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       1819.064 1819.064 1819.064
May 2001       1852.194 1852.194 1852.194
Jun 2001       1807.432 1807.432 1807.432
Jul 2001       1919.299 1919.299 1919.299
Aug 2001       1970.632 1970.632 1970.632
Sep 2001       1649.734 1649.734 1649.734
Oct 2001       1774.580 1774.580 1774.580
Nov 2001       1766.327 1766.327 1766.327
Dec 2001       1804.387 1804.387 1804.387
Jan 2002       1573.972 1573.972 1573.972
Feb 2002       1531.042 1531.042 1531.042
Mar 2002       1834.740 1834.740 1834.740
Apr 2002       1819.064 1819.064 1819.064
May 2002       1852.194 1852.194 1852.194
Jun 2002       1807.432 1807.432 1807.432
Jul 2002       1919.299 1919.299 1919.299
Aug 2002       1970.632 1970.632 1970.632
Sep 2002       1649.734 1649.734 1649.734
Oct 2002       1774.580 1774.580 1774.580
Nov 2002       1766.327 1766.327 1766.327
Dec 2002       1804.387 1804.387 1804.387
Jan 2003       1573.972 1573.972 1573.972
Feb 2003       1531.042 1531.042 1531.042
Mar 2003       1834.740 1834.740 1834.740
Apr 2003       1819.064 1819.064 1819.064
May 2003       1852.194 1852.194 1852.194
Jun 2003       1807.432 1807.432 1807.432
Jul 2003       1919.299 1919.299 1919.299
Aug 2003       1970.632 1970.632 1970.632
Sep 2003       1649.734 1649.734 1649.734
Oct 2003       1774.580 1774.580 1774.580
Nov 2003       1766.327 1766.327 1766.327
Dec 2003       1804.387 1804.387 1804.387
Jan 2004       1573.972 1573.972 1573.972
Feb 2004       1531.042 1531.042 1531.042
Mar 2004       1834.740 1834.740 1834.740</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.season.pred, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.lm.season.pred<span class="sc">$</span>fitted, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)       </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차에 대한 시계열 그림</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.season<span class="sc">$</span>residuals,                     <span class="co"># 잔차</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">420</span>, <span class="dv">500</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>),  <span class="co"># 축 범위</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,              <span class="co"># 축 이름</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 잔차 예측값</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts <span class="sc">-</span> train.lm.season.pred<span class="sc">$</span>mean)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 두 번째 그래프를 보면 잔차에 대해 계절변동은 제거되었지만 추세는 여전히 U자 형태로 남아있음을 알 수 있다.</p>
</section>
<section id="multiplicative-계절성" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="multiplicative-계절성"><span class="header-section-number">7.3.2</span> Multiplicative 계절성</h3>
<ul>
<li>회귀모형을 통하여 특정 월이 기준 월에 비해 몇 % 증가(혹은 감소)했는지와 같은 비율을 알아보기 위해서는 계절변동의 곱을 반영하는 모형을 이용해야 한다.</li>
<li>계절변동의 곱을 반영하는 회귀모형의 구축방법은 Target을 <span class="math inline">\(\log{Y_t}\)</span>로 사용하는 점을 제외하고는 <a href="#additive-계절성">Additive 계절성</a> 방법과 동일하다.
<ul>
<li>이를 구현하기 위해 함수 <code>tslm()</code>에서 옵션 <code>lambda = 0</code>을 입력한다.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>train.expo.lm.season      <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span>  season, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.expo.lm.season)                       <span class="co"># 모형 구축 결과            </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ season, lambda = 0)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.160824 -0.029798  0.005386  0.032081  0.116843 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.35909    0.01765 416.839  &lt; 2e-16 ***
season2     -0.02764    0.02497  -1.107   0.2706    
season3      0.15326    0.02497   6.138 1.32e-08 ***
season4      0.14482    0.02558   5.661 1.20e-07 ***
season5      0.16388    0.02558   6.405 3.73e-09 ***
season6      0.13897    0.02558   5.432 3.33e-07 ***
season7      0.19994    0.02558   7.815 3.38e-12 ***
season8      0.22654    0.02558   8.855 1.53e-14 ***
season9      0.04825    0.02558   1.886   0.0619 .  
season10     0.12114    0.02558   4.735 6.52e-06 ***
season11     0.11563    0.02558   4.520 1.56e-05 ***
season12     0.13760    0.02558   5.379 4.21e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05855 on 111 degrees of freedom
Multiple R-squared:  0.6378,    Adjusted R-squared:  0.6019 
F-statistic: 17.77 on 11 and 111 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplicative 계절변동을 반영한 회귀모형을 이용한 예측</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train.expo.lm.season.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.expo.lm.season, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">h =</span> nTest,    <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">level =</span> <span class="dv">0</span>)    <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>train.expo.lm.season.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       1815.129 1815.129 1815.129
May 2001       1850.055 1850.055 1850.055
Jun 2001       1804.545 1804.545 1804.545
Jul 2001       1917.999 1917.999 1917.999
Aug 2001       1969.685 1969.685 1969.685
Sep 2001       1648.045 1648.045 1648.045
Oct 2001       1772.648 1772.648 1772.648
Nov 2001       1762.908 1762.908 1762.908
Dec 2001       1802.080 1802.080 1802.080
Jan 2002       1570.413 1570.413 1570.413
Feb 2002       1527.598 1527.598 1527.598
Mar 2002       1830.513 1830.513 1830.513
Apr 2002       1815.129 1815.129 1815.129
May 2002       1850.055 1850.055 1850.055
Jun 2002       1804.545 1804.545 1804.545
Jul 2002       1917.999 1917.999 1917.999
Aug 2002       1969.685 1969.685 1969.685
Sep 2002       1648.045 1648.045 1648.045
Oct 2002       1772.648 1772.648 1772.648
Nov 2002       1762.908 1762.908 1762.908
Dec 2002       1802.080 1802.080 1802.080
Jan 2003       1570.413 1570.413 1570.413
Feb 2003       1527.598 1527.598 1527.598
Mar 2003       1830.513 1830.513 1830.513
Apr 2003       1815.129 1815.129 1815.129
May 2003       1850.055 1850.055 1850.055
Jun 2003       1804.545 1804.545 1804.545
Jul 2003       1917.999 1917.999 1917.999
Aug 2003       1969.685 1969.685 1969.685
Sep 2003       1648.045 1648.045 1648.045
Oct 2003       1772.648 1772.648 1772.648
Nov 2003       1762.908 1762.908 1762.908
Dec 2003       1802.080 1802.080 1802.080
Jan 2004       1570.413 1570.413 1570.413
Feb 2004       1527.598 1527.598 1527.598
Mar 2004       1830.513 1830.513 1830.513</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.expo.lm.season.pred, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.expo.lm.season.pred<span class="sc">$</span>fitted, </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-with-trend-and-seasonality" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="model-with-trend-and-seasonality"><span class="header-section-number">7.4</span> Model with Trend and Seasonality</h2>
<ul>
<li>추세와 계절변동을 동시에 가지는 시계열 모형은 함수 <code>tslm()</code>에서 옵션 <code>Target ~ trend + season</code>을 입력하면 된다.</li>
<li>예제 데이터 <code>Amtrak</code>은 U자 형태의 추세를 가지므로 이차 함수 추세와 계절변동을 동시에 반영하는 모형을 구축한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 이차 함수 추세와 계절변동을 동시에 반영하는 모형 구축</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season      <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span> trend <span class="sc">+</span> <span class="fu">I</span>(trend<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> season)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm.trend.season)                      <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ trend + I(trend^2) + season)

Residuals:
     Min       1Q   Median       3Q      Max 
-213.775  -39.363    9.711   42.422  152.187 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.697e+03  2.768e+01  61.318  &lt; 2e-16 ***
trend       -7.156e+00  7.293e-01  -9.812  &lt; 2e-16 ***
I(trend^2)   6.074e-02  5.698e-03  10.660  &lt; 2e-16 ***
season2     -4.325e+01  3.024e+01  -1.430  0.15556    
season3      2.600e+02  3.024e+01   8.598 6.60e-14 ***
season4      2.606e+02  3.102e+01   8.401 1.83e-13 ***
season5      2.938e+02  3.102e+01   9.471 6.89e-16 ***
season6      2.490e+02  3.102e+01   8.026 1.26e-12 ***
season7      3.606e+02  3.102e+01  11.626  &lt; 2e-16 ***
season8      4.117e+02  3.102e+01  13.270  &lt; 2e-16 ***
season9      9.032e+01  3.102e+01   2.911  0.00437 ** 
season10     2.146e+02  3.102e+01   6.917 3.29e-10 ***
season11     2.057e+02  3.103e+01   6.629 1.34e-09 ***
season12     2.429e+02  3.103e+01   7.829 3.44e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.92 on 109 degrees of freedom
Multiple R-squared:  0.8246,    Adjusted R-squared:  0.8037 
F-statistic: 39.42 on 13 and 109 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 이차 함수 추세와 계절변동을 동시에 반영한 모형을 이용한 예측</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm.trend.season, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">h =</span> nTest,   <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">level =</span> <span class="dv">0</span>)   <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       2004.271 2004.271 2004.271
May 2001       2045.419 2045.419 2045.419
Jun 2001       2008.675 2008.675 2008.675
Jul 2001       2128.560 2128.560 2128.560
Aug 2001       2187.911 2187.911 2187.911
Sep 2001       1875.032 1875.032 1875.032
Oct 2001       2007.896 2007.896 2007.896
Nov 2001       2007.662 2007.662 2007.662
Dec 2001       2053.740 2053.740 2053.740
Jan 2002       1819.752 1819.752 1819.752
Feb 2002       1785.569 1785.569 1785.569
Mar 2002       2098.014 2098.014 2098.014
Apr 2002       2107.922 2107.922 2107.922
May 2002       2150.528 2150.528 2150.528
Jun 2002       2115.242 2115.242 2115.242
Jul 2002       2236.585 2236.585 2236.585
Aug 2002       2297.394 2297.394 2297.394
Sep 2002       1985.972 1985.972 1985.972
Oct 2002       2120.294 2120.294 2120.294
Nov 2002       2121.518 2121.518 2121.518
Dec 2002       2169.054 2169.054 2169.054
Jan 2003       1936.523 1936.523 1936.523
Feb 2003       1903.798 1903.798 1903.798
Mar 2003       2217.701 2217.701 2217.701
Apr 2003       2229.067 2229.067 2229.067
May 2003       2273.131 2273.131 2273.131
Jun 2003       2239.303 2239.303 2239.303
Jul 2003       2362.104 2362.104 2362.104
Aug 2003       2424.371 2424.371 2424.371
Sep 2003       2114.406 2114.406 2114.406
Oct 2003       2250.186 2250.186 2250.186
Nov 2003       2252.868 2252.868 2252.868
Dec 2003       2301.862 2301.862 2301.862
Jan 2004       2070.789 2070.789 2070.789
Feb 2004       2039.522 2039.522 2039.522
Mar 2004       2354.883 2354.883 2354.883</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 시계열 그림</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.trend.season.pred, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,                                     <span class="co"># 제목 제거</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">flty =</span> <span class="dv">2</span>)                                      <span class="co"># 선 종류 / 2 : 점선</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 구축된 모형을 이용하여 계산된 Training Dataset 데이터 포인트의 예측값 </span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.lm.trend.season.pred<span class="sc">$</span>fitted, </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)       </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차에 대한 시계열 그림</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.trend.season<span class="sc">$</span>residuals,               <span class="co"># 잔차</span></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">420</span>, <span class="dv">500</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>),  <span class="co"># 축 범위</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,              <span class="co"># 축 이름</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 잔차 예측값</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts <span class="sc">-</span> train.lm.trend.season.pred<span class="sc">$</span>mean) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 첫 번째 그래프를 보면 모형 구축과 예측이 잘 된 것을 알 수 있으며, 두 번째 그래프를 통해 잔차의 추세와 계절성이 모두 제거된 것을 알 수 있다.</p>
</section>
<section id="autocorrelation-and-arima-model" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="autocorrelation-and-arima-model"><span class="header-section-number">7.5</span> Autocorrelation and ARIMA Model</h2>
<section id="autocorrelation" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="autocorrelation"><span class="header-section-number">7.5.1</span> Autocorrelation</h3>
<ul>
<li>전통적인 회귀모형은 관측값 간에 서로 독립을 가정한다.</li>
<li>하지만 시계열 관측값들은 대부분 서로 상관관계(자기상관관계)를 가지고 있다.
<ul>
<li>자기상관관계를 활용하면 보다 더 정확한 예측을 할 수 있다.</li>
</ul></li>
</ul>
<center>
<img src="./image/PositiveNegativeAutocorrelation.jpg" class="img-fluid">
</center>
<p><br></p>
<ul>
<li>자기상관은 현재 시점(<span class="math inline">\(t\)</span>)과 미래의 하나 또는 그 이상의 시점(<span class="math inline">\(t+k\)</span>, <span class="math inline">\(k\)</span>&gt;0)에서 관측된 시계열들의 상관관계를 의미한다.
<ul>
<li><span class="math inline">\(k&gt;1\)</span>에 대하여, 강한 자기상관은 전형적인 주기변동을 의미한다.
<ul>
<li>예를 들어, 월별로 구성된 시계열에서 시차 12일 때 강한 양의 자기상관은 12개월을 주기로 비슷한 패턴이 반복됨을 의미한다.</li>
</ul></li>
<li><span class="math inline">\(k=1\)</span>에 대하여, 강한 양의 상관은 강한 선형추세를 의미한다.</li>
<li><span class="math inline">\(k=1\)</span>에 대하여, 강한 음의 상관은 강한 스윙을 의미한다.</li>
</ul></li>
<li>자기 상관은 계절성 패턴을 파악하는 데 유용하며 함수 <code>Acf()</code> 함수를 자기상관계수 그래프를 출력할 수 있다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Acf</span>(train.ts,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag.max =</span> <span class="dv">12</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 예제 데이터 <code>Amtrak</code>의 자기상관계수 그래프를 보면 시차 6에서 강한 음의 자기상관을 보여준다. 즉, 6개월 단위로 높아지다가 낮아지는 것을 의미한다. (여름에는 높고 겨울에는 낮음을 의미)</p>
<section id="잔차의-자기상관" class="level4" data-number="7.5.1.1">
<h4 data-number="7.5.1.1" class="anchored" data-anchor-id="잔차의-자기상관"><span class="header-section-number">7.5.1.1</span> 잔차의 자기상관</h4>
<ul>
<li>추가적으로 잔차의 자기상관을 살펴보는 것도 매우 유용하다.
<ul>
<li>잔차는 백색잡음과정(white noise)을 가정하기 때문에 독립이어야한다.</li>
<li>즉, 잔차의 자기상관계수 그래프는 막대가 모두 선 안에 있어야한다.
<ul>
<li>예를 들어 계절성이 잘 모형화되었다면, 잔차는 주기에서 자기상관이 0이다. 즉, 막대가 선 안에 있다.</li>
</ul></li>
</ul></li>
<li>다음 그래프는 <a href="#model-with-trend-and-seasonality">이차 함수 추세와 계절변동을 반영한 회귀모형</a>의 잔차의 자기상관계수 그래프이다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Acf</span>(train.lm.trend.season<span class="sc">$</span>residuals, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag.max =</span> <span class="dv">12</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 계절변동이 있는 시계열을 잘 모형화했기 때문에 주기인 12에서 막대가 선 안에 있다. 이는 시차 12에서 자기상관계수는 통계적으로 유의하다는 증거가 부족함을 의미한다. 그러나 시차 1에서 강한 양의 자기상관을 보이며 전반적으로 자기상관계수는 지수적으로 감소하는 것을 알 수 있다.</p>
</section>
</section>
<section id="잔차에-대한-2차-예측모형-구축" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="잔차에-대한-2차-예측모형-구축"><span class="header-section-number">7.5.2</span> 잔차에 대한 2차 예측모형 구축</h3>
<ul>
<li>잔차에 예측모형을 구축함으로써 짧은 기간에 대한 예측을 향상시킬 수 있으며, 그 절차는 다음과 같다.
<ol type="1">
<li>회귀모형을 이용하여 미래 <span class="math inline">\(k\)</span>시점의 예측값(<span class="math inline">\(F_{t+k}\)</span>)을 생성한다.</li>
<li>AR 모형 또는 다른 모형을 이용하여 미래 <span class="math inline">\(k\)</span>시점의 잔차에 대한 예측값(<span class="math inline">\(E_{t+k}\)</span>)을 생성한다.</li>
<li>예측모형을 이용하여 구한 예측값과 잔차에 대한 예측값을 더하여 향상된 예측값(<span class="math inline">\(F_{t+k}+E_{t+k}\)</span>)을 얻는다.</li>
</ol></li>
<li>예제 데이터 <code>Amtrak</code>은 잔차의 자기상관이 시차 1에서 강한 양의 자기상관을 보이며 지수적으로 감소하기에 잔차에 AR(1) 모형을 구축할 수 있다.
<ul>
<li>잔차에 대한 AR(1) 모형식은 <span class="math inline">\(E_{t}=\beta_{0}+\beta_{1}E_{t-1}+\epsilon_t\)</span>이다.
<ul>
<li><span class="math inline">\(E_{t}\)</span> : 시점 <span class="math inline">\(t\)</span>에서 잔차</li>
</ul></li>
<li>일반적으로 AR(1) 모형을 구축하기 위해서 시계열은 정상성을 만족해야 하지만, 잔차는 백색잡음과정을 가정하기 때문에 자기상관 외에 어떠한 추세나 주기적 행동을 포함하지 않아 정상성 확인이 따로 필요하지 않는다.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 추세와 계절변동을 반영하는 회귀모형을 이용한 모형 구축</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season <span class="ot">&lt;-</span> <span class="fu">tslm</span>(train.ts <span class="sc">~</span> trend <span class="sc">+</span> <span class="fu">I</span>(trend<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> season)    </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.lm.trend.season)                      <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
tslm(formula = train.ts ~ trend + I(trend^2) + season)

Residuals:
     Min       1Q   Median       3Q      Max 
-213.775  -39.363    9.711   42.422  152.187 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.697e+03  2.768e+01  61.318  &lt; 2e-16 ***
trend       -7.156e+00  7.293e-01  -9.812  &lt; 2e-16 ***
I(trend^2)   6.074e-02  5.698e-03  10.660  &lt; 2e-16 ***
season2     -4.325e+01  3.024e+01  -1.430  0.15556    
season3      2.600e+02  3.024e+01   8.598 6.60e-14 ***
season4      2.606e+02  3.102e+01   8.401 1.83e-13 ***
season5      2.938e+02  3.102e+01   9.471 6.89e-16 ***
season6      2.490e+02  3.102e+01   8.026 1.26e-12 ***
season7      3.606e+02  3.102e+01  11.626  &lt; 2e-16 ***
season8      4.117e+02  3.102e+01  13.270  &lt; 2e-16 ***
season9      9.032e+01  3.102e+01   2.911  0.00437 ** 
season10     2.146e+02  3.102e+01   6.917 3.29e-10 ***
season11     2.057e+02  3.103e+01   6.629 1.34e-09 ***
season12     2.429e+02  3.103e+01   7.829 3.44e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.92 on 109 degrees of freedom
Multiple R-squared:  0.8246,    Adjusted R-squared:  0.8037 
F-statistic: 39.42 on 13 and 109 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-1. 회귀모형을 이용한 미래 k시점에 대한 예측값</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.lm.trend.season, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">h =</span> nTest,   <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">level =</span> <span class="dv">0</span>)   <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>train.lm.trend.season.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast     Lo 0     Hi 0
Apr 2001       2004.271 2004.271 2004.271
May 2001       2045.419 2045.419 2045.419
Jun 2001       2008.675 2008.675 2008.675
Jul 2001       2128.560 2128.560 2128.560
Aug 2001       2187.911 2187.911 2187.911
Sep 2001       1875.032 1875.032 1875.032
Oct 2001       2007.896 2007.896 2007.896
Nov 2001       2007.662 2007.662 2007.662
Dec 2001       2053.740 2053.740 2053.740
Jan 2002       1819.752 1819.752 1819.752
Feb 2002       1785.569 1785.569 1785.569
Mar 2002       2098.014 2098.014 2098.014
Apr 2002       2107.922 2107.922 2107.922
May 2002       2150.528 2150.528 2150.528
Jun 2002       2115.242 2115.242 2115.242
Jul 2002       2236.585 2236.585 2236.585
Aug 2002       2297.394 2297.394 2297.394
Sep 2002       1985.972 1985.972 1985.972
Oct 2002       2120.294 2120.294 2120.294
Nov 2002       2121.518 2121.518 2121.518
Dec 2002       2169.054 2169.054 2169.054
Jan 2003       1936.523 1936.523 1936.523
Feb 2003       1903.798 1903.798 1903.798
Mar 2003       2217.701 2217.701 2217.701
Apr 2003       2229.067 2229.067 2229.067
May 2003       2273.131 2273.131 2273.131
Jun 2003       2239.303 2239.303 2239.303
Jul 2003       2362.104 2362.104 2362.104
Aug 2003       2424.371 2424.371 2424.371
Sep 2003       2114.406 2114.406 2114.406
Oct 2003       2250.186 2250.186 2250.186
Nov 2003       2252.868 2252.868 2252.868
Dec 2003       2301.862 2301.862 2301.862
Jan 2004       2070.789 2070.789 2070.789
Feb 2004       2039.522 2039.522 2039.522
Mar 2004       2354.883 2354.883 2354.883</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 잔차에 AR(1) 모형 구축</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>train.res.arima      <span class="ot">&lt;-</span> <span class="fu">arima</span>(train.lm.trend.season<span class="sc">$</span>residuals,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))   </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(train.res.arima)                            <span class="co"># 모형 구축 결과</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = train.lm.trend.season$residuals, order = c(1, 0, 0))

Coefficients:
         ar1  intercept
      0.5998     0.3728
s.e.  0.0712    11.8408

sigma^2 estimated as 2829:  log likelihood = -663.54,  aic = 1333.08

Training set error measures:
                     ME     RMSE     MAE      MPE     MAPE      MASE        ACF1
Training set -0.1223159 53.19141 39.8277 103.3885 175.2219 0.8492545 -0.07509305</code></pre>
</div>
</div>
<p><code>Result!</code> 잔차에 AR(1) 모형에 대한 추정된 회귀식은 <span class="math inline">\({E}_{t}=0.3728+0.5998(E_{t-1}-0.3728)+\epsilon_t\)</span>이다. 게다가, AR(1) 회귀 계수 0.5998와 시차가 1일 때 잔차의 자기상관 0.6041은 비슷하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-1. 미래 k시점에 대한 잔차의 예측값 </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>train.res.arima.pred <span class="ot">&lt;-</span> <span class="fu">forecast</span>(train.res.arima, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">h =</span> nTest,         <span class="co"># Test Dataset의 데이터 포인트 개수만큼 예측값 계산 </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">level =</span> <span class="dv">0</span>)         <span class="co"># 예측 구간은 계산 X</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>train.res.arima.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Point Forecast      Lo 0      Hi 0
Apr 2001      7.4111098 7.4111098 7.4111098
May 2001      4.5942671 4.5942671 4.5942671
Jun 2001      2.9047772 2.9047772 2.9047772
Jul 2001      1.8914526 1.8914526 1.8914526
Aug 2001      1.2836792 1.2836792 1.2836792
Sep 2001      0.9191481 0.9191481 0.9191481
Oct 2001      0.7005091 0.7005091 0.7005091
Nov 2001      0.5693735 0.5693735 0.5693735
Dec 2001      0.4907208 0.4907208 0.4907208
Jan 2002      0.4435463 0.4435463 0.4435463
Feb 2002      0.4152520 0.4152520 0.4152520
Mar 2002      0.3982816 0.3982816 0.3982816
Apr 2002      0.3881030 0.3881030 0.3881030
May 2002      0.3819981 0.3819981 0.3819981
Jun 2002      0.3783365 0.3783365 0.3783365
Jul 2002      0.3761403 0.3761403 0.3761403
Aug 2002      0.3748231 0.3748231 0.3748231
Sep 2002      0.3740331 0.3740331 0.3740331
Oct 2002      0.3735592 0.3735592 0.3735592
Nov 2002      0.3732750 0.3732750 0.3732750
Dec 2002      0.3731045 0.3731045 0.3731045
Jan 2003      0.3730023 0.3730023 0.3730023
Feb 2003      0.3729410 0.3729410 0.3729410
Mar 2003      0.3729042 0.3729042 0.3729042
Apr 2003      0.3728821 0.3728821 0.3728821
May 2003      0.3728689 0.3728689 0.3728689
Jun 2003      0.3728610 0.3728610 0.3728610
Jul 2003      0.3728562 0.3728562 0.3728562
Aug 2003      0.3728534 0.3728534 0.3728534
Sep 2003      0.3728517 0.3728517 0.3728517
Oct 2003      0.3728506 0.3728506 0.3728506
Nov 2003      0.3728500 0.3728500 0.3728500
Dec 2003      0.3728496 0.3728496 0.3728496
Jan 2004      0.3728494 0.3728494 0.3728494
Feb 2004      0.3728493 0.3728493 0.3728493
Mar 2004      0.3728492 0.3728492 0.3728492</code></pre>
</div>
</div>
<p><code>Result!</code> 미래 1시점에서 잔차 예측값은 <span class="math inline">\(0.3728+0.5998*(12.108-0.3728)=7.411\)</span>이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 잔차에 대한 시계열 그림</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.trend.season<span class="sc">$</span>residuals,               <span class="co"># 잔차</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>),  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residual"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,              <span class="co"># 축 이름</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 잔차 예측값</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(train.res.arima.pred<span class="sc">$</span>fitted,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"blue"</span>)                                 <span class="co"># 선 색깔</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(1) 모형에 대한 잔차의 자기상관계수 그림</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="fu">Acf</span>(train.res.arima<span class="sc">$</span>residuals, <span class="at">lag.max =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>Result!</code> 첫 번째 그래프를 보면 회귀모형에 대한 잔차와 AR(1) 모형에 의해 추정된 잔차는 서로 비슷한 것을 알 수 있다. 두 번째 그래프를 보면 AR(1) 모형에 의해 추정된 잔차의 자기상관계수는 막대가 모두 선 안에 있으므로 독립성을 만족한다는 것을 알 수 있다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 최종 예측 = 회귀모형에 의한 예측 + AR(1) 모형에 의한 예측</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Improved_forecast <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred.y   =</span> train.lm.trend.season.pred<span class="sc">$</span>mean,   <span class="co"># 회귀모형에 의한 예측값</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">pred.res =</span> train.res.arima.pred<span class="sc">$</span>mean) <span class="sc">%&gt;%</span>     <span class="co"># AR(1) 모형에 의한 잔차 예측값</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Imp.pred =</span> pred.y <span class="sc">+</span> pred.res)                                        <span class="co"># 두 예측값을 더한 최종 예측값</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>Improved_forecast<span class="sc">$</span>Imp.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Jan      Feb      Mar      Apr      May      Jun      Jul      Aug      Sep      Oct      Nov      Dec
2001                            2011.682 2050.014 2011.580 2130.452 2189.195 1875.951 2008.596 2008.231 2054.230
2002 1820.195 1785.984 2098.412 2108.310 2150.910 2115.620 2236.961 2297.769 1986.346 2120.668 2121.891 2169.427
2003 1936.896 1904.171 2218.074 2229.440 2273.504 2239.676 2362.476 2424.743 2114.779 2250.559 2253.241 2302.235
2004 2071.162 2039.895 2355.256                                                                                 </code></pre>
</div>
</div>
<p><code>Result!</code> 미래 1시점에 대해 향상된 예측값은 <span class="math inline">\(2004.271+7.411=2011.682\)</span>로 기존의 예측값 2004.271보다 실제값 2023.792에 더 가깝다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 정확도</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>forecast<span class="sc">::</span><span class="fu">accuracy</span>(Improved_forecast<span class="sc">$</span>Imp.pred, test.ts)      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                ME     RMSE      MAE       MPE     MAPE     ACF1 Theil's U
Test set -127.0267 153.5331 131.8537 -6.474276 6.705803 0.705547 0.8978628</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 추세와 계절변동을 반영한 회귀모형에 대한 예측값</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(train.lm.trend.season.pred, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1300</span>, <span class="dv">2600</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="fl">2006.25</span>), <span class="co"># 축 범위</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ridership"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>,             <span class="co"># 축 이름</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"l"</span>,                                     <span class="co"># 선으로 표시</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,                                    <span class="co"># X축 눈금 제거</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>)                                     <span class="co"># 제목 제거</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># For X축 눈금 표시</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>),                    </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="dv">1991</span>, <span class="dv">2006</span>, <span class="dv">1</span>)))</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트에 대한 향상된 예측값</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Improved_forecast<span class="sc">$</span>Imp.pred, </span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">1</span>,                                      <span class="co"># 선 굵기</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">"orange"</span>)                               <span class="co"># 선 색깔</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset 데이터 포인트  </span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(test.ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regression_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./SARIMA.html" class="pagination-link" aria-label="Seasonal Autoregressive Integrated Moving Average Process">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Seasonal Autoregressive Integrated Moving Average Process</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./DHR.html" class="pagination-link" aria-label="Dynamic Harmonic Regression">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Harmonic Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>