<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Young Eun Jeon, Jeong-Wook Lee, and Jung-In Seo">

<title>16&nbsp; Deep Learning – Time Series Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Imputation.html" rel="next">
<link href="./ML.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1092c56c6cadf2eb47b1bc8063ab382a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ef31e3f4d9d6eef55c54bdf6b9cd68ca.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.27/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ML.html">ML &amp; DL</a></li><li class="breadcrumb-item"><a href="./DL.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Time Series Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/JJJJYE/TS" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Autoregressive Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Autoregressive Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Seasonal Autoregressive Integrated Moving Average Process</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression-based Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DHR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Harmonic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./STLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">STLM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./BSTS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Dynamic Linear Model and Bayesian Structural Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TBATS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">TBATS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Bagging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Bootstrap and Bagging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ensemble.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ensemble</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Neuron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Neural Network Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ML &amp; DL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DL.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Imputation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imputation using Kalman Smoothing</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-loading" id="toc-data-loading" class="nav-link active" data-scroll-target="#data-loading"><span class="header-section-number">16.1</span> Data Loading</a></li>
  <li><a href="#feature-extraction" id="toc-feature-extraction" class="nav-link" data-scroll-target="#feature-extraction"><span class="header-section-number">16.2</span> Feature Extraction</a></li>
  <li><a href="#data-partition" id="toc-data-partition" class="nav-link" data-scroll-target="#data-partition"><span class="header-section-number">16.3</span> Data Partition</a></li>
  <li><a href="#sec-preprocess" id="toc-sec-preprocess" class="nav-link" data-scroll-target="#sec-preprocess"><span class="header-section-number">16.4</span> Preprocess</a>
  <ul class="collapse">
  <li><a href="#standardization" id="toc-standardization" class="nav-link" data-scroll-target="#standardization"><span class="header-section-number">16.4.1</span> Standardization</a></li>
  <li><a href="#input-target-dataset-생성" id="toc-input-target-dataset-생성" class="nav-link" data-scroll-target="#input-target-dataset-생성"><span class="header-section-number">16.4.2</span> (Input, Target) Dataset 생성</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">16.5</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#model-definition" id="toc-model-definition" class="nav-link" data-scroll-target="#model-definition"><span class="header-section-number">16.5.1</span> Model Definition</a></li>
  <li><a href="#model-compile" id="toc-model-compile" class="nav-link" data-scroll-target="#model-compile"><span class="header-section-number">16.5.2</span> Model Compile</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit"><span class="header-section-number">16.5.3</span> Model Fit</a></li>
  <li><a href="#model-evaluate" id="toc-model-evaluate" class="nav-link" data-scroll-target="#model-evaluate"><span class="header-section-number">16.5.4</span> Model Evaluate</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">16.5.5</span> Prediction</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ML.html">ML &amp; DL</a></li><li class="breadcrumb-item"><a href="./DL.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deep Learning</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Dataset : Ridership on Amtrak Trains(미국 철도 회사 “Amtrak”에서 수집한 1991년 1월~2004년 3월까지 매달 환승 고객 수)</p>
</blockquote>
<section id="data-loading" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="data-loading"><span class="header-section-number">16.1</span> Data Loading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"doParallel"</span>, <span class="st">"parallel"</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"data.table"</span>, <span class="st">"readr"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"skimr"</span>, <span class="st">"summarytools"</span>, <span class="st">"DT"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"dplyr"</span>, <span class="st">"magrittr"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"ggplot2"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"caret"</span>, <span class="st">"recipes"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"keras"</span>,                                                  <span class="co"># keras's Ver. 2.9.0</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"tfdatasets"</span>)                                             <span class="co"># For as_array_iterator   </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="at">cores=</span><span class="fu">detectCores</span>())</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>tensorflow<span class="sc">::</span><span class="fu">as_tensor</span>(<span class="dv">1</span>)                                                 <span class="co"># systemMemory and maxCacheSize</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(1.0, shape=(), dtype=float64)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading as Tibble Type</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">".../Amtrak.csv"</span>)                 </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  as_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 2
   Month      Ridership
   &lt;chr&gt;          &lt;dbl&gt;
 1 01/01/1991     1709.
 2 01/02/1991     1621.
 3 01/03/1991     1973.
 4 01/04/1991     1812.
 5 01/05/1991     1975.
 6 01/06/1991     1862.
 7 01/07/1991     1940.
 8 01/08/1991     2013.
 9 01/09/1991     1596.
10 01/10/1991     1725.
# ℹ 149 more rows</code></pre>
</div>
</div>
<p><code>코드 설명</code> 함수 <code>readr::read_csv()</code>는 CSV 파일을 <code>tibble</code> 형태로 읽어온다. 이는 데이터 가독성과 처리 속도를 높이며, Package <code>"tidyverse"</code>와의 호환성을 향상시킨다.</p>
</section>
<section id="feature-extraction" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="feature-extraction"><span class="header-section-number">16.2</span> Feature Extraction</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Generate New Variables</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Amtrak.data <span class="ot">&lt;-</span> Amtrak.data <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date.Time =</span> <span class="fu">as.Date</span>(Month, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>),       <span class="co"># 날짜를 나타내는 변수 </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Month =</span> <span class="fu">factor</span>(lubridate<span class="sc">::</span><span class="fu">month</span>(Date.Time)))           <span class="co"># 월(Month)을 나타내는 변수</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Amtrak.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 3
   Month Ridership Date.Time 
   &lt;fct&gt;     &lt;dbl&gt; &lt;date&gt;    
 1 1         1709. 1991-01-01
 2 2         1621. 1991-02-01
 3 3         1973. 1991-03-01
 4 4         1812. 1991-04-01
 5 5         1975. 1991-05-01
 6 6         1862. 1991-06-01
 7 7         1940. 1991-07-01
 8 8         2013. 1991-08-01
 9 9         1596. 1991-09-01
10 10        1725. 1991-10-01
# ℹ 149 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Convert Factor to One-hot Encoding</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data_recipe  <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Ridership <span class="sc">~</span> ., <span class="at">data =</span> Amtrak.data) <span class="sc">%&gt;%</span>   <span class="co"># Define Formula / Ridership: Target</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(Month, <span class="at">one_hot =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>                         <span class="co"># One-hot Encoding</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> Amtrak.data, <span class="at">retain =</span> <span class="cn">TRUE</span>)                  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Amtrak.data1 <span class="ot">&lt;-</span> <span class="fu">juice</span>(data_recipe)                               </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Amtrak.data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 159 × 14
   Date.Time  Ridership Month_X1 Month_X2 Month_X3 Month_X4 Month_X5 Month_X6 Month_X7 Month_X8 Month_X9 Month_X10 Month_X11 Month_X12
   &lt;date&gt;         &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 1991-01-01     1709.        1        0        0        0        0        0        0        0        0         0         0         0
 2 1991-02-01     1621.        0        1        0        0        0        0        0        0        0         0         0         0
 3 1991-03-01     1973.        0        0        1        0        0        0        0        0        0         0         0         0
 4 1991-04-01     1812.        0        0        0        1        0        0        0        0        0         0         0         0
 5 1991-05-01     1975.        0        0        0        0        1        0        0        0        0         0         0         0
 6 1991-06-01     1862.        0        0        0        0        0        1        0        0        0         0         0         0
 7 1991-07-01     1940.        0        0        0        0        0        0        1        0        0         0         0         0
 8 1991-08-01     2013.        0        0        0        0        0        0        0        1        0         0         0         0
 9 1991-09-01     1596.        0        0        0        0        0        0        0        0        1         0         0         0
10 1991-10-01     1725.        0        0        0        0        0        0        0        0        0         1         0         0
# ℹ 149 more rows</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>Date.Time = as.Date(Month, format = "%d/%m/%Y")</code>
<ul>
<li>변수 <code>Month</code>를 날짜 형식(Date)으로 변환한다.</li>
<li>옵션 <code>format</code>을 이용하여 날짜 형식을 지정한다.
<ul>
<li><code>"%d/%m/%Y"</code>는 “일/월/연도” 형식을 의미한다.</li>
</ul></li>
</ul></li>
<li><code>Month = factor(lubridate::month(Date.Time))</code>
<ul>
<li>함수 <code>lubridate::month()</code>를 이용하여 변수 <code>Date.Time</code>에서 월(Month)을 추출한다.</li>
<li>추출한 월을 범주형(Factor) 데이터로 변환한다.</li>
</ul></li>
<li><code>step_dummy(Month, one_hot = TRUE)</code>
<ul>
<li>범주형 변수 <code>Month</code>를 원-핫 인코딩(One-hot Encoding) 변환을 이용하여 수치형 변수로 변환한다.</li>
<li>각 범주에 대해 하나의 열을 생성하며, 관측치가 해당 범주에 속하면 1, 그렇지 않으면 0을 할당한다.</li>
</ul></li>
<li><code>prep()</code>
<ul>
<li>정의한 레시피를 실행하여 전처리를 수행한다.</li>
<li><code>training = Amtrak.data</code>: 학습 데이터로 전처리를 수행한다.</li>
<li><code>retain = TRUE</code>: 변환된 데이터 객체를 메모리에 유지한다.</li>
</ul></li>
<li><code>juice()</code>
<ul>
<li><code>prep()</code> 결과로 변환된 데이터를 반환한다.</li>
<li>전처리된 데이터를 최종적으로 얻기 위해 사용한다.</li>
</ul></li>
</ol>
</section>
<section id="data-partition" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="data-partition"><span class="header-section-number">16.3</span> Data Partition</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>num_train_samples <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">nrow</span>(Amtrak.data1) <span class="sc">*</span> <span class="fl">0.55</span>)                            </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>num_val_samples   <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">nrow</span>(Amtrak.data1) <span class="sc">*</span> <span class="fl">0.25</span>)                           </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>num_test_samples  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Amtrak.data1) <span class="sc">-</span> num_train_samples <span class="sc">-</span> num_val_samples   </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>train_df <span class="ot">&lt;-</span> Amtrak.data1[<span class="fu">seq</span>(num_train_samples), ]              <span class="co"># First 55% of Rows, 1:87 </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>val_df   <span class="ot">&lt;-</span> Amtrak.data1[<span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">nrow</span>(train_df) <span class="sc">+</span> <span class="dv">1</span>,         <span class="co"># Next 25% of Rows, 88:127</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">length.out =</span> num_val_samples), ]           </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>test_df  <span class="ot">&lt;-</span> Amtrak.data1[<span class="fu">seq</span>(<span class="at">to =</span> <span class="fu">nrow</span>(Amtrak.data1),           <span class="co"># Last 20% of Rows, 128:159</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">length.out =</span> num_test_samples), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training Dataset (TrD)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(train_df)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5d7be40c32e46790094f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d7be40c32e46790094f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87"],["1991-01-01","1991-02-01","1991-03-01","1991-04-01","1991-05-01","1991-06-01","1991-07-01","1991-08-01","1991-09-01","1991-10-01","1991-11-01","1991-12-01","1992-01-01","1992-02-01","1992-03-01","1992-04-01","1992-05-01","1992-06-01","1992-07-01","1992-08-01","1992-09-01","1992-10-01","1992-11-01","1992-12-01","1993-01-01","1993-02-01","1993-03-01","1993-04-01","1993-05-01","1993-06-01","1993-07-01","1993-08-01","1993-09-01","1993-10-01","1993-11-01","1993-12-01","1994-01-01","1994-02-01","1994-03-01","1994-04-01","1994-05-01","1994-06-01","1994-07-01","1994-08-01","1994-09-01","1994-10-01","1994-11-01","1994-12-01","1995-01-01","1995-02-01","1995-03-01","1995-04-01","1995-05-01","1995-06-01","1995-07-01","1995-08-01","1995-09-01","1995-10-01","1995-11-01","1995-12-01","1996-01-01","1996-02-01","1996-03-01","1996-04-01","1996-05-01","1996-06-01","1996-07-01","1996-08-01","1996-09-01","1996-10-01","1996-11-01","1996-12-01","1997-01-01","1997-02-01","1997-03-01","1997-04-01","1997-05-01","1997-06-01","1997-07-01","1997-08-01","1997-09-01","1997-10-01","1997-11-01","1997-12-01","1998-01-01","1998-02-01","1998-03-01"],[1708.917,1620.586,1972.715,1811.665,1974.964,1862.356,1939.86,2013.264,1595.657,1724.924,1675.667,1813.863,1614.827,1557.088,1891.223,1955.981,1884.714,1623.042,1903.309,1996.712,1703.897,1810,1861.601,1875.122,1705.259,1618.535,1836.709,1957.043,1917.185,1882.398,1933.009,1996.167,1672.841,1752.827,1720.377,1734.292,1563.365,1573.959,1902.639,1833.888,1831.049,1775.755,1867.508,1906.608,1685.632,1778.546,1775.995,1783.35,1548.415,1496.925,1798.316,1732.895,1772.345,1761.207,1791.655,1874.82,1571.309,1646.948,1672.631,1656.845,1381.758,1360.852,1558.575,1608.42,1696.696,1693.183,1835.516,1942.573,1551.401,1686.508,1576.204,1700.433,1396.588,1371.69,1707.522,1654.604,1762.903,1775.8,1934.219,2008.055,1615.924,1773.91,1732.368,1796.626,1570.33,1412.691,1754.641],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Ridership<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation Dataset (VaD)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(val_df)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8e3e68a78659d83a1433" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e3e68a78659d83a1433">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["1998-04-01","1998-05-01","1998-06-01","1998-07-01","1998-08-01","1998-09-01","1998-10-01","1998-11-01","1998-12-01","1999-01-01","1999-02-01","1999-03-01","1999-04-01","1999-05-01","1999-06-01","1999-07-01","1999-08-01","1999-09-01","1999-10-01","1999-11-01","1999-12-01","2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01"],[1824.932,1843.289,1825.964,1968.172,1921.645,1669.597,1791.474,1816.714,1846.754,1599.427,1548.804,1832.333,1839.72,1846.498,1864.852,1965.743,1949.002,1607.373,1803.664,1850.309,1836.435,1541.66,1616.928,1919.538,1971.493,1992.301,2009.763,2053.996,2097.471,1823.706,1976.997,1981.408,2000.153,1683.148,1663.404,2007.928,2023.792,2047.008,2072.913,2126.717],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Ridership<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test Dataset (TeD)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(test_df)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8d2209845786ac4cde79" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8d2209845786ac4cde79">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01"],[2202.638,1707.693,1950.716,1973.614,1984.729,1759.629,1770.595,2019.912,2048.398,2068.763,1994.267,2075.258,2026.56,1734.155,1916.771,1858.345,1996.352,1778.033,1749.489,2066.466,2098.899,2104.911,2129.671,2223.349,2174.36,1931.406,2121.47,2076.054,2140.677,1831.508,1838.006,2132.446],[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Ridership<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="sec-preprocess" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="sec-preprocess"><span class="header-section-number">16.4</span> Preprocess</h2>
<section id="standardization" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="standardization"><span class="header-section-number">16.4.1</span> Standardization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Standardization for Numeric Feature</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Name of Feature </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>input_data_colnames <span class="ot">&lt;-</span> <span class="fu">names</span>(Amtrak.data1) <span class="sc">%&gt;%</span>           </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(<span class="fu">c</span>(<span class="st">"Date.Time"</span>, <span class="st">"Ridership"</span>))                          <span class="co"># 사용하지 않는 변수 "Date.Time"와 Target Ridership 제거            </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>input_data_colnames</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Month_X1"  "Month_X2"  "Month_X3"  "Month_X4"  "Month_X5"  "Month_X6"  "Month_X7"  "Month_X8"  "Month_X9"  "Month_X10" "Month_X11" "Month_X12"</code></pre>
</div>
</div>
<p><code>Caution!</code> 표준화는 수치형 Feature에 적용하며, 해당 데이터셋에서는 Feature로 고려하는 모든 변수(<code>Month_X1</code>, <code>Month_X2</code>, <code>Month_X3</code>, <code>Month_X4</code>, <code>Month_X5</code>, <code>Month_X6</code>, <code>Month_X7</code>, <code>Month_X8</code>, <code>Month_X9</code>, <code>Month_X10</code>, <code>Month_X11</code>, <code>Month_X12</code>)가 수치형이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Standardization</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data_recipe  <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Ridership <span class="sc">~</span> ., <span class="at">data =</span> train_df) <span class="sc">%&gt;%</span>      <span class="co"># Define Formula / Ridership: Target</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_of</span>(input_data_colnames)) <span class="sc">%&gt;%</span>               <span class="co"># Standardization for All Feature</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>(<span class="at">training =</span> train_df, <span class="at">retain =</span> <span class="cn">TRUE</span>)                      <span class="co"># Calculation for Standardization</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>standard_train_df <span class="ot">&lt;-</span> <span class="fu">juice</span>(data_recipe)                         <span class="co"># Standardized TrD</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>standard_val_df   <span class="ot">&lt;-</span> <span class="fu">bake</span>(data_recipe, val_df)                  <span class="co"># Standardized VaD</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>standard_test_df  <span class="ot">&lt;-</span> <span class="fu">bake</span>(data_recipe, test_df)                 <span class="co"># Standardized TeD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Caution!</code> Training Dataset의 수치형 Feature에 대한 평균과 표준편차를 이용하여 Training Dataset, Validation Dataset, 그리고 Test Dataset에 표준화를 수행한다.</p>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>step_normalize(all_of(input_data_colnames))</code>
<ul>
<li>Target <code>Ridership</code>을 제외한 모든 수치형 Feature에 대해 표준화를 수행한다.
<ul>
<li>표준화란 데이터를 평균 = 0, 표준편차 = 1에 맞도록 변환하는 과정이다.</li>
</ul></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized TrD</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(standard_train_df)                            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7f8d0ebc574b22a25375" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7f8d0ebc574b22a25375">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87"],["1991-01-01","1991-02-01","1991-03-01","1991-04-01","1991-05-01","1991-06-01","1991-07-01","1991-08-01","1991-09-01","1991-10-01","1991-11-01","1991-12-01","1992-01-01","1992-02-01","1992-03-01","1992-04-01","1992-05-01","1992-06-01","1992-07-01","1992-08-01","1992-09-01","1992-10-01","1992-11-01","1992-12-01","1993-01-01","1993-02-01","1993-03-01","1993-04-01","1993-05-01","1993-06-01","1993-07-01","1993-08-01","1993-09-01","1993-10-01","1993-11-01","1993-12-01","1994-01-01","1994-02-01","1994-03-01","1994-04-01","1994-05-01","1994-06-01","1994-07-01","1994-08-01","1994-09-01","1994-10-01","1994-11-01","1994-12-01","1995-01-01","1995-02-01","1995-03-01","1995-04-01","1995-05-01","1995-06-01","1995-07-01","1995-08-01","1995-09-01","1995-10-01","1995-11-01","1995-12-01","1996-01-01","1996-02-01","1996-03-01","1996-04-01","1996-05-01","1996-06-01","1996-07-01","1996-08-01","1996-09-01","1996-10-01","1996-11-01","1996-12-01","1997-01-01","1997-02-01","1997-03-01","1997-04-01","1997-05-01","1997-06-01","1997-07-01","1997-08-01","1997-09-01","1997-10-01","1997-11-01","1997-12-01","1998-01-01","1998-02-01","1998-03-01"],[3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955],[-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955],[-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643],[-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702],[1708.917,1620.586,1972.715,1811.665,1974.964,1862.356,1939.86,2013.264,1595.657,1724.924,1675.667,1813.863,1614.827,1557.088,1891.223,1955.981,1884.714,1623.042,1903.309,1996.712,1703.897,1810,1861.601,1875.122,1705.259,1618.535,1836.709,1957.043,1917.185,1882.398,1933.009,1996.167,1672.841,1752.827,1720.377,1734.292,1563.365,1573.959,1902.639,1833.888,1831.049,1775.755,1867.508,1906.608,1685.632,1778.546,1775.995,1783.35,1548.415,1496.925,1798.316,1732.895,1772.345,1761.207,1791.655,1874.82,1571.309,1646.948,1672.631,1656.845,1381.758,1360.852,1558.575,1608.42,1696.696,1693.183,1835.516,1942.573,1551.401,1686.508,1576.204,1700.433,1396.588,1371.69,1707.522,1654.604,1762.903,1775.8,1934.219,2008.055,1615.924,1773.91,1732.368,1796.626,1570.33,1412.691,1754.641]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n      <th>Ridership<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized TrD</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(standard_val_df)                            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-fc81d05f758625b8caa9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fc81d05f758625b8caa9">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["1998-04-01","1998-05-01","1998-06-01","1998-07-01","1998-08-01","1998-09-01","1998-10-01","1998-11-01","1998-12-01","1999-01-01","1999-02-01","1999-03-01","1999-04-01","1999-05-01","1999-06-01","1999-07-01","1999-08-01","1999-09-01","1999-10-01","1999-11-01","1999-12-01","2000-01-01","2000-02-01","2000-03-01","2000-04-01","2000-05-01","2000-06-01","2000-07-01","2000-08-01","2000-09-01","2000-10-01","2000-11-01","2000-12-01","2001-01-01","2001-02-01","2001-03-01","2001-04-01","2001-05-01","2001-06-01","2001-07-01"],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955],[3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[1824.932,1843.289,1825.964,1968.172,1921.645,1669.597,1791.474,1816.714,1846.754,1599.427,1548.804,1832.333,1839.72,1846.498,1864.852,1965.743,1949.002,1607.373,1803.664,1850.309,1836.435,1541.66,1616.928,1919.538,1971.493,1992.301,2009.763,2053.996,2097.471,1823.706,1976.997,1981.408,2000.153,1683.148,1663.404,2007.928,2023.792,2047.008,2072.913,2126.717]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n      <th>Ridership<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized TrD</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(standard_test_df)                            </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f3c7532897e3c26e4c5c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f3c7532897e3c26e4c5c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["2001-08-01","2001-09-01","2001-10-01","2001-11-01","2001-12-01","2002-01-01","2002-02-01","2002-03-01","2002-04-01","2002-05-01","2002-06-01","2002-07-01","2002-08-01","2002-09-01","2002-10-01","2002-11-01","2002-12-01","2003-01-01","2003-02-01","2003-03-01","2003-04-01","2003-05-01","2003-06-01","2003-07-01","2003-08-01","2003-09-01","2003-10-01","2003-11-01","2003-12-01","2004-01-01","2004-02-01","2004-03-01"],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955],[-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,-0.3163887605624955,3.124339010554643],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702],[-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,-0.294099052826702,3.361132032305165,-0.294099052826702,-0.294099052826702,-0.294099052826702],[2202.638,1707.693,1950.716,1973.614,1984.729,1759.629,1770.595,2019.912,2048.398,2068.763,1994.267,2075.258,2026.56,1734.155,1916.771,1858.345,1996.352,1778.033,1749.489,2066.466,2098.899,2104.911,2129.671,2223.349,2174.36,1931.406,2121.47,2076.054,2140.677,1831.508,1838.006,2132.446]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Date.Time<\/th>\n      <th>Month_X1<\/th>\n      <th>Month_X2<\/th>\n      <th>Month_X3<\/th>\n      <th>Month_X4<\/th>\n      <th>Month_X5<\/th>\n      <th>Month_X6<\/th>\n      <th>Month_X7<\/th>\n      <th>Month_X8<\/th>\n      <th>Month_X9<\/th>\n      <th>Month_X10<\/th>\n      <th>Month_X11<\/th>\n      <th>Month_X12<\/th>\n      <th>Ridership<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="input-target-dataset-생성" class="level3" data-number="16.4.2">
<h3 data-number="16.4.2" class="anchored" data-anchor-id="input-target-dataset-생성"><span class="header-section-number">16.4.2</span> (Input, Target) Dataset 생성</h3>
<ul>
<li>머신러닝 기법과 달리 딥러닝 기법을 시계열 데이터에 적용하기 위해서는 주어진 데이터셋을 작게 쪼개어 <code>(Input, Target) Dataset</code>을 여러 개 생성하여야 한다.</li>
</ul>
<center>
<img src="./image/그림1.png" class="img-fluid" style="width:100.0%">
</center>
<ul>
<li>주어진 Dataset을 (Input, Target) Dataset으로 작게 분할하기 위해 다음과 같은 문제를 생각해야 한다.
<ol type="1">
<li>관측한 시계열 데이터의 시간 단위(Unit of Time)</li>
<li>예측하고자 하는 시계열 데이터의 시간 단위</li>
<li>얼마만큼의 과거 데이터를 바탕으로 미래의 시계열 데이터 값을 예측하고자 하는가?
<ul>
<li>즉, 예측을 위해 사용하고자 하는 과거 데이터의 관측 기간</li>
</ul></li>
</ol></li>
<li>위의 3가지 문제를 바탕으로 Dataset을 분할하는 옵션을 설정한다.
<ol type="1">
<li><code>Sampling Rate (SR)</code>: 예측하고자 하는 시계열 데이터의 시간 단위당 관측한 Data Point 개수(간격)
<ul>
<li>예를 들어, 전력량이 2시간마다 관측되었을 때, 3일 후의 전력량을 예측한다면 SR은 “12”이다.
<ul>
<li>예측하고자 하는 시계열 데이터는 3일 후의 전력량으로, 시간 단위가 “일(Day)”이며 전력량은 하루 당(Per Day) 12개의 Data Point가 관측된다.</li>
</ul></li>
</ul></li>
<li><code>Sequence Length (SL)</code>: Input의 Data Point 개수(미래의 시계열 데이터 값을 예측하기 위해 고려하는 과거 데이터 길이)
<ul>
<li>예를 들어, 지난 5일 동안 관측된 기온을 기반으로 5시간 후의 기온을 예측하고자 한다. 이때 10분마다 기온을 관측하였다고 가정한다.
<ul>
<li>지난 5일 동안 관측한 Data Point 개수는 1×6×24시간×5일 = 720개이다.</li>
<li><code>Caution!</code> 딥러닝에서는 예측하고자 하는 시계열 데이터의 시간 단위당 오로지 1개의 Data Point만을 고려하여 (Input, Target) Dataset을 생성한다.</li>
<li>5시간 후의 기온을 예측하므로 예측하고자 하는 시계열 데이터의 시간 단위는 시(Hour)이다.<br>
</li>
<li>시당(Per Hour) 오로지 1개의 Data Point만을 고려하므로 <code>SL</code>은 720(=1개×6개×24시간×5일)이 아니라 120(=1개×24시간×5일)이 된다.
<center>
<img src="./image/그림4.png" class="img-fluid" style="width:100.0%">
</center></li>
</ul></li>
</ul></li>
<li><span class="math inline">\(k\)</span> : 예측 시점
<ul>
<li>예를 들어, 4일 후 시계열 데이터 값을 예측한다면 <span class="math inline">\(k\)</span>는 4가 된다.</li>
</ul></li>
<li><code>Delay</code> : Target의 Index를 계산할 때 사용
<ul>
<li><code>Delay</code> = SR <span class="math inline">\(\times\)</span> (SL <span class="math inline">\(+k-\)</span> 1)</li>
</ul></li>
</ol></li>
<li>현재 예제로 사용하는 <code>Amtrak</code> Dataset은 1달 단위로 관측하였으며, 지난 1년 간의 데이터를 이용하여 1달 후의 승객 수(<code>Ridership</code>)을 예측하고자 한다.
<ol type="1">
<li>관측한 시계열 데이터의 시간 단위 : 1달마다 관측 → “월(Month)”</li>
<li>예측하고자 하는 시계열 데이터의 시간 단위 : 1달 후의 승객 수를 예측 → “월(Month)”</li>
<li>예측을 위해 사용하고자 하는 과거 데이터의 관측 기간 : 1년
<ul>
<li>SR = 1 ← 예측하고자 하는 시계열 데이터의 시간 단위(월)당 관측한 Data Point 개수</li>
<li>SL = 12 ← 지난 1년 동안 관측된 승객 수를 기반으로 예측하므로 12(=1개 <span class="math inline">\(\times\)</span> 12달)</li>
<li><span class="math inline">\(k\)</span> = 1 ← 1달 후의 승객 수를 예측하므로 1</li>
<li>Delay = 1 <span class="math inline">\(\times\)</span> (12 <span class="math inline">\(+\)</span> 1 <span class="math inline">\(-\)</span> 1) = 12</li>
</ul></li>
</ol></li>
</ul>
<div id="fig-a" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./image/그림2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Without Feature
</figcaption>
</figure>
</div>
<div id="fig-b" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./image/그림5.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: With Feature
</figcaption>
</figure>
</div>
<p><code>Caution!</code> Package <code>"keras"</code>에서 제공하는 함수 <code>timeseries_dataset_from_array()</code>를 이용하면 쉽게 (Input, Target) Dataset을 생성할 수 있으며, 결과는 <code>TF Dataset</code> 객체로 반환한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define Option</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sampling_rate <span class="ot">&lt;-</span> <span class="dv">1</span>          </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>sequence_length <span class="ot">&lt;-</span> <span class="dv">12</span>      </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>delay <span class="ot">&lt;-</span> sampling_rate <span class="sc">*</span> (sequence_length <span class="sc">+</span> k <span class="sc">-</span> <span class="dv">1</span>)    </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>batch_size <span class="ot">&lt;-</span> <span class="dv">16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define Input and Target Partition Function</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_to_inputs_and_targets <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  inputs <span class="ot">&lt;-</span> df[input_data_colnames] <span class="sc">%&gt;%</span>                                  <span class="co"># inputs : Standardized Features</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  targets <span class="ot">&lt;-</span> <span class="fu">as.array</span>(df<span class="sc">$</span>Ridership)                                      <span class="co"># (Not Standardized) Target</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(inputs, <span class="sc">-</span>delay),                                                <span class="co"># Drop Last Delay(= 12) Samples</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tail</span>(targets, <span class="sc">-</span>delay)                                                <span class="co"># Drop First Delay(= 12) Samples</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>코드 설명</code> 함수 <code>df_to_inputs_and_targets()</code>는 함수 <code>timeseries_dataset_from_array()</code>를 이용하여 (Input, Target) Dataset으로 분할하기 전에 Input과 Target을 구분하는 역할을 한다.</p>
<ol type="1">
<li><code>inputs &lt;- df[input_data_colnames]</code>
<ul>
<li>데이터 프레임 <code>df</code>에서 Input(Feature)으로 사용할 열만 선택한다.</li>
<li><code>input_data_colnames</code>는 이전에 정의한 열 이름의 벡터(In <a href="#sec-preprocess" class="quarto-xref"><span>Section 16.4</span></a>)이다.</li>
</ul></li>
<li><code>targets &lt;- as.array(df$Ridership)</code>
<ul>
<li>타겟 변수(종속 변수) <code>Ridership</code>을 선택한다.</li>
<li>이때 타겟 변수는 표준화되지 않은 원본 데이터이다.</li>
<li>함수 <code>as.array()</code>를 이용하여 Target을 배열로 변환한다.</li>
</ul></li>
<li><code>head(inputs, -delay)</code>
<ul>
<li>Input(<code>inputs</code>)의 마지막에서 <code>delay</code>만큼의 샘플을 제거한다.</li>
<li>필요한 이유: Input에서 Target과 겹칠 가능성이 있는 뒤쪽 데이터를 제거하여 모형 학습에 필요한 과거 시점의 데이터만 포함하도록 한다.
<ul>
<li>시계열 예측 문제에서는 Input이 항상 예측해야 하는 Target보다 시간적으로 앞서야 한다.</li>
<li>만약 Input이 전체 시퀀스를 포함하면, 예측 대상인 Target과 겹칠 가능성이 생긴다.</li>
<li><code>head(inputs, -delay)</code>를 이용하면 마지막 <code>delay</code> 만큼의 데이터를 제외해 입력 시퀀스의 끝이 Target보다 항상 과거 시점을 포함되도록 한다.</li>
</ul></li>
</ul></li>
<li><code>tail(targets, -delay)</code>
<ul>
<li>Target(<code>targets</code>)의 첫 <code>delay</code>만큼의 샘플을 제거한다.</li>
<li><a href="#fig-a" class="quarto-xref">Figure&nbsp;<span>16.1</span></a> 와 <a href="#fig-b" class="quarto-xref">Figure&nbsp;<span>16.2</span></a> 를 보면 알 수 있듯이 첫 번째 (Input, Target) Dataset의 Target 인덱스는 “1+Delay”이다.</li>
<li>따라서 <code>tail(targets, -delay)</code>를 이용하여 첫 <code>delay</code>만큼의 샘플을 제거한다.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define Generating (Input, Target) Dataset</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>make_dataset <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(inputs, targets) <span class="sc">%&lt;-%</span> <span class="fu">df_to_inputs_and_targets</span>(df)                   <span class="co"># c(inputs, targets) = c(Standardized Features, Not Standardized Target)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generating (Input, Target) Dataset</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">timeseries_dataset_from_array</span>(                                         <span class="co"># Returns TF Dataset Object</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    inputs, targets,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sampling_rate =</span> sampling_rate,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sequence_length =</span> sequence_length,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shuffle =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">batch_size =</span> batch_size</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>코드 설명</code> 함수 <code>make_dataset()</code>는 데이터 프레임 <code>df</code>을 기반으로 Input과 Target을 구분하고, 이를 딥러닝 기법 적용에 적합한 텐서플로우(TensorFlow) 데이터셋 객체로 변환하는 작업을 수행한다.</p>
<ol type="1">
<li><code>c(inputs, targets) %&lt;-% df_to_inputs_and_targets(df)</code>
<ul>
<li>위에서 정의한 함수 <code>df_to_inputs_and_targets()</code>를 호출하여 데이터 프레임을 Input과 Target으로 분리한다.</li>
<li><code>inputs</code>: 모형 학습에 사용할 Input</li>
<li><code>targets</code>: 모형이 예측해야 하는 값</li>
</ul></li>
<li>함수 <code>timeseries_dataset_from_array()</code>
<ul>
<li>분리한 Input과 Target를 기반으로 여러 개의 (Input, Target) Dataset을 생성하여 모형 학습에 사용할 수 있도록 준비한다.</li>
</ul></li>
</ol>
<p><code>Result</code> 첫 번째 배치에 해당하는 행 번호는 다음과 같다.</p>
<center>
<img src="./image/그림3.png" class="img-fluid" style="width:60.0%">
</center>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate (Input, Target) Dataset for Each Dataset</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>train_dataset <span class="ot">&lt;-</span> <span class="fu">make_dataset</span>(standard_train_df)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>val_dataset   <span class="ot">&lt;-</span> <span class="fu">make_dataset</span>(standard_val_df)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>test_dataset  <span class="ot">&lt;-</span> <span class="fu">make_dataset</span>(standard_test_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input and Target for TrD</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(samples, targets) <span class="sc">%&lt;-%</span> <span class="fu">iter_next</span>(<span class="fu">as_iterator</span>(train_dataset))           <span class="co"># iter_next in keras (reticulate)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"samples shape: "</span>, <span class="fu">format</span>(samples<span class="sc">$</span>shape), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,                      <span class="co"># samples$shape : (batch_size, sequence_length, #feature)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"targets shape: "</span>, <span class="fu">format</span>(targets<span class="sc">$</span>shape), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>samples shape: (16, 12, 12)
targets shape: (16)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input and Target for TeD</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(test_samples, test_targets) <span class="sc">%&lt;-%</span> <span class="fu">iter_next</span>(<span class="fu">as_iterator</span>(test_dataset))   </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>test_targets <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(test_targets)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="analysis" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="analysis"><span class="header-section-number">16.5</span> Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #Feature</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ncol_input_data <span class="ot">&lt;-</span> <span class="fu">length</span>(input_data_colnames)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CallBack</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>callbacks_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">callback_early_stopping</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitor =</span> <span class="st">"val_loss"</span>,                                                <span class="co"># Metric (Monitor for Validation) </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">patience =</span> <span class="dv">50</span>                                                        <span class="co"># 50번의 epochs 후에도 loss가 향상되지 않으면 stop!</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">callback_model_checkpoint</span>(</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">filepath =</span> <span class="st">"Amtrack.keras"</span>,                                          </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitor =</span> <span class="st">"val_loss"</span>,                                                <span class="co"># 저장 Metric (Monitor for Validation)</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_best_only =</span> <span class="cn">TRUE</span>                                                <span class="co"># 가장 좋은 결과를 저장</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">callback_reduce_lr_on_plateau</span>(        </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">monitor =</span> <span class="st">"val_loss"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fl">0.1</span>,                                                        <span class="co"># 학습률 감소하는 요인: New Learning Rate (LR) = LR * factor</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">patience =</span> <span class="dv">10</span>                                                        <span class="co"># monitor = "val_loss"가 10번의 epochs 동안 향상되지 않으면 콜백 실행</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-definition" class="level3" data-number="16.5.1">
<h3 data-number="16.5.1" class="anchored" data-anchor-id="model-definition"><span class="header-section-number">16.5.1</span> Model Definition</h3>
<section id="deep-neural-network-dnn" class="level4" data-number="16.5.1.1">
<h4 data-number="16.5.1.1" class="anchored" data-anchor-id="deep-neural-network-dnn"><span class="header-section-number">16.5.1.1</span> Deep Neural Network (DNN)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))       </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_flatten</span>() <span class="sc">%&gt;%</span>                                                    <span class="co"># Convert to 1D vector</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">16</span>, <span class="at">activation =</span> <span class="st">"relu"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_1 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 flatten (Flatten)                                                                        (None, 144)                                                                     0                             
 dense_1 (Dense)                                                                          (None, 16)                                                                      2320                          
 dense (Dense)                                                                            (None, 1)                                                                       17                            
========================================================================================================================================================================================================
Total params: 2337 (9.13 KB)
Trainable params: 2337 (9.13 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_input(shape = c(sequence_length, ncol_input_data))</code>: Input 정의
<ul>
<li><code>shape</code>: Input의 크기를 정의한다.
<ul>
<li><code>sequence_length</code>: 한 번의 입력에서 사용하는 시간 스텝의 수로 <code>Amtrack</code> Dataset에서는 12이다.</li>
<li><code>ncol_input_data</code>: 각 시점의 Feature 개수이다.</li>
<li>예를 들어, 입력 데이터가 <code>(10, 3)</code>의 형태라면, 10개의 시간 단계와 3개의 Feature를 포함한다.</li>
<li><code>Caution!</code> <code>layer_input(shape = c(sequence_length, 1))</code>은 Feature가 없을 때, 그리고 Feature가 1개 있을 때 두 경우에 모두 사용된다.</li>
</ul></li>
</ul></li>
<li><code>layer_flatten()</code>: 1차원 벡터로 변환
<ul>
<li>예를 들어, <code>(sequence_length, ncol_input_data)</code> 크기의 Input은 <code>sequence_length * ncol_input_data</code> 크기의 1차원 벡터로 변환된다.</li>
</ul></li>
<li><code>layer_dense(units = 16, activation = "relu")</code>: Dense 계층
<ul>
<li>은닉층으로 16개의 뉴런을 포함한다.</li>
<li>활성화 함수로 ReLU(Rectified Linear Unit)를 사용한다.</li>
</ul></li>
<li><code>layer_dense(units = 1)</code>
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
<li><code>model &lt;- keras_model(inputs, outputs)</code>: 입력과 출력을 연결하여 딥러닝 모형 정의</li>
</ol>
</section>
<section id="convolutional-neural-network-1d-cnn-1d" class="level4" data-number="16.5.1.2">
<h4 data-number="16.5.1.2" class="anchored" data-anchor-id="convolutional-neural-network-1d-cnn-1d"><span class="header-section-number">16.5.1.2</span> Convolutional Neural Network 1D (CNN 1D)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))       </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_1d</span>(<span class="at">filters =</span> <span class="dv">8</span>, <span class="at">kernel_size =</span> <span class="dv">6</span>, <span class="at">activation =</span> <span class="st">"relu"</span>) <span class="sc">%&gt;%</span>  <span class="co"># kernel_size=Window Length, 6개월 단위의 변화나 트렌드에 초점</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_max_pooling_1d</span>(<span class="at">pool_size =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>                               <span class="co"># Down-Sampling = Reduce Size</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_1d</span>(<span class="at">filters =</span> <span class="dv">8</span>, <span class="at">kernel_size =</span> <span class="dv">3</span>, <span class="at">activation =</span> <span class="st">"relu"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Due to layer_max_pooling_1d(), kernel_size = 3</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_global_average_pooling_1d</span>() <span class="sc">%&gt;%</span>                                 <span class="co"># Average for Each Convolution Feature Map</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                <span class="co"># Default: Linear Activation</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_1"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_2 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 conv1d_1 (Conv1D)                                                                        (None, 7, 8)                                                                    584                           
 max_pooling1d (MaxPooling1D)                                                             (None, 3, 8)                                                                    0                             
 conv1d (Conv1D)                                                                          (None, 1, 8)                                                                    200                           
 global_average_pooling1d (GlobalAveragePooling1D)                                        (None, 8)                                                                       0                             
 dense_2 (Dense)                                                                          (None, 1)                                                                       9                             
========================================================================================================================================================================================================
Total params: 793 (3.10 KB)
Trainable params: 793 (3.10 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_conv_1d(filters = 8, kernel_size = 6, activation = "relu")</code>: 1D 콘벌루션 계층
<ul>
<li><code>filters</code>: 콘벌루션 필터 개수를 입력한다.</li>
<li><code>kernel_size</code>: 모형이 학습할 데이터 패턴의 시간적 범위(시계열 윈도우 크기)를 결정한다(커널 크기: <span class="math inline">\(1\times\)</span> <code>kernel_size</code>).
<ul>
<li><code>Amtrack</code> Dataset에서의 권장 설정:
<ul>
<li>작은 패턴 탐지: <code>kernel_size = 2</code> ~ <code>kernel_size = 4</code>
<ul>
<li>2~4개월 단위의 국소적인(Local) 패턴을 학습하는 데 유용</li>
</ul></li>
<li>중간 패턴 탐지: <code>kernel_size = 6</code>
<ul>
<li>반년 단위의 변화나 트렌드에 초점</li>
</ul></li>
<li>전체 시퀀스 탐지: <code>kernel_size = 12</code>
<ul>
<li>전체 12개월 데이터를 한 번에 학습(권장되지는 않음, 과적합 위험)</li>
</ul></li>
</ul></li>
<li><code>kernel_size</code>은 <code>sequence_length</code>보다 큰 값을 입력할 수 없다.<br>
</li>
</ul></li>
<li><code>activation</code>: 활성화 함수를 입력한다.</li>
</ul></li>
<li><code>layer_max_pooling_1d(pool_size = 2)</code>: 1D Max Pooling 계층 → 시계열 데이터의 차원을 축소
<ul>
<li><code>pool_size</code>(= Max Pooling Window Length)를 “2”로 지정한다.</li>
<li><code>strides</code>의 경우 옵션 <code>pool_size</code>에 입력한 값이 Default(여기서는 2)이다.</li>
<li>두 옵션을 통해 해당 계층에서 입력 데이터의 차원을 절반으로 축소한다.</li>
<li>함수 <code>layer_max_pooling_1d()</code> 다음에 입력한 함수 <code>layer_conv_1d()</code>의 옵션 <code>kernel_size</code>는 절반으로 축소한 “3”으로 지정한다.</li>
</ul></li>
<li><code>layer_global_average_pooling_1d()</code>: 이전 콘벌루션 계층의 결과를 1차원으로 변환</li>
<li><code>layer_dense(units = 1)</code>: Dense 계층
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
</section>
<section id="long-short-term-memory-lstm" class="level4" data-number="16.5.1.3">
<h4 data-number="16.5.1.3" class="anchored" data-anchor-id="long-short-term-memory-lstm"><span class="header-section-number">16.5.1.3</span> Long Short-Term Memory (LSTM)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simple LSTM</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))      </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_lstm</span>(<span class="at">units =</span> <span class="dv">16</span>) <span class="sc">%&gt;%</span>                                             <span class="co"># units : Dimension of Output Space (Hidden State) (Ref. https://jiwonkoh.tistory.com/188)</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_2"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_3 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 lstm (LSTM)                                                                              (None, 16)                                                                      1856                          
 dense_3 (Dense)                                                                          (None, 1)                                                                       17                            
========================================================================================================================================================================================================
Total params: 1873 (7.32 KB)
Trainable params: 1873 (7.32 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_lstm(units = 16)</code>: LSTM 계층
<ul>
<li><code>units</code>: LSTM 계층이 출력하는 벡터의 차원을 지정한다.
<ul>
<li><code>units = 16</code>은 해당 LSTM 계층은 16차원의 벡터를 출력한다는 의미이다.</li>
<li>이는 LSTM의 은닉 상태와 셀 상태의 크기를 정의하며, <code>units</code>의 값은 LSTM 계층이 각 타임스텝에서 출력하는 벡터의 차원이 된다.</li>
<li>더 큰 <code>units</code> 값은 더 복잡한 패턴 학습이 가능하지만 계산 비용 증가한다.</li>
</ul></li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층 → LSTM 계층의 출력(16차원 벡터)을 단일 값으로 변환
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Simple LSTM based on recurrent_dropout</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))      </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_lstm</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">recurrent_dropout =</span> <span class="fl">0.25</span>) <span class="sc">%&gt;%</span>                   <span class="co"># recurrent_dropout : Dropout Rate of Recurrent Units</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="fl">0.5</span>) <span class="sc">%&gt;%</span>                                                 <span class="co"># Dropout Layer after the LSTM for Regularizing Dense Layer</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_3"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_4 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 lstm_1 (LSTM)                                                                            (None, 32)                                                                      5760                          
 dropout (Dropout)                                                                        (None, 32)                                                                      0                             
 dense_4 (Dense)                                                                          (None, 1)                                                                       33                            
========================================================================================================================================================================================================
Total params: 5793 (22.63 KB)
Trainable params: 5793 (22.63 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_lstm(units = 32, recurrent_dropout = 0.25)</code>: LSTM 계층
<ul>
<li><code>units = 32</code>: LSTM 계층이 출력할 벡터 차원은 32이다.
<ul>
<li>LSTM이 학습하는 복잡한 패턴의 표현력을 조절한다.<br>
</li>
<li>값이 클수록 복잡한 패턴 학습 가능하지만 계산 비용이 증가한다.<br>
</li>
</ul></li>
<li><code>recurrent_dropout = 0.25</code>: 순환 상태 업데이트 시, 일부 뉴런을 무작위로 비활성화(Dropout)하여 과적합을 방지한다.
<ul>
<li>값 <code>0.25</code>는 25%의 유닛을 비활성화함을 의미한다.<br>
</li>
<li>Ref. <a href="https://proceedings.neurips.cc/paper/2016/file/076a0c97d09cf1a0ec3e19c7f2529f2b-Paper.pdf">A Theoretically Grounded Application of Dropout in Recurrent Neural Networks, Gal and Ghahramani (2016)</a></li>
</ul></li>
</ul></li>
</ol>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./Figure/rec_drop.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Recurrent Dropout (출처: https://arxiv.org/pdf/1603.05118)</figcaption>
</figure>
</div>
</center>
<ol start="2" type="1">
<li><code>layer_dropout(0.5)</code>: 드롭아웃 계층
<ul>
<li><code>rate = 0.5</code>: 전체 뉴런의 50%를 무작위로 비활성화하여 과적합을 방지한다.</li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Bidirection LSTM</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))       </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bidirectional</span>(<span class="fu">layer_lstm</span>(<span class="at">units =</span> <span class="dv">16</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_4"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_5 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 bidirectional (Bidirectional)                                                            (None, 32)                                                                      3712                          
 dense_5 (Dense)                                                                          (None, 1)                                                                       33                            
========================================================================================================================================================================================================
Total params: 3745 (14.63 KB)
Trainable params: 3745 (14.63 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>bidirectional(layer_lstm(units = 16))</code>: 양방향 LSTM 계층
<ul>
<li><code>bidirectional</code>: LSTM을 Input의 앞방향(Forward)과 뒤방향(Backward)으로 학습시킨다.<br>
</li>
<li><code>layer_lstm(units = 16)</code>
<ul>
<li>LSTM 계층의 출력 공간의 차원은 16이다.<br>
</li>
<li>양방향 학습으로 인해, 최종 출력은 앞방향 출력(16차원)과 뒤방향 출력(16차원)을 합쳐 32차원의 벡터이다.<br>
</li>
</ul></li>
<li>양방향 구조는 Input의 문맥 정보(앞뒤 관계)를 더 잘 포착할 수 있도록 돕는다.</li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
<center>
<img src="./Figure/bidirec_lstm.png" class="img-fluid" style="width:100.0%">
</center>
</section>
<section id="gated-recurrent-unit-gru" class="level4" data-number="16.5.1.4">
<h4 data-number="16.5.1.4" class="anchored" data-anchor-id="gated-recurrent-unit-gru"><span class="header-section-number">16.5.1.4</span> Gated Recurrent Unit (GRU)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Simple GRU</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))     </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_gru</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">recurrent_dropout =</span> <span class="fl">0.5</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">return_sequences =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>                                 <span class="co"># 모든 시점(Time Step)에 대해서 은닉 상태값을 출력</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_gru</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">recurrent_dropout =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_5"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_6 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 gru_1 (GRU)                                                                              (None, 12, 32)                                                                  4416                          
 gru (GRU)                                                                                (None, 32)                                                                      6336                          
 dropout_1 (Dropout)                                                                      (None, 32)                                                                      0                             
 dense_6 (Dense)                                                                          (None, 1)                                                                       33                            
========================================================================================================================================================================================================
Total params: 10785 (42.13 KB)
Trainable params: 10785 (42.13 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_gru(units = 32, recurrent_dropout = 0.5, return_sequences = TRUE)</code>: GRU 계층
<ul>
<li><code>units = 32</code>: GRU 계층이 출력할 은닉 상태(Hidden State)의 차원은 32이다.
<ul>
<li>이는 GRU가 학습하는 표현 공간의 크기를 의미한다.<br>
</li>
</ul></li>
<li><code>recurrent_dropout = 0.5</code>: 순환 상태 업데이트 시, 50%의 뉴런을 무작위로 비활성화하여 과적합을 방지한다.<br>
</li>
<li><code>return_sequences = TRUE</code>: 모든 시점(Time Step)에 대한 은닉 상태 출력을 반환한다.
<ul>
<li>GRU와 LSTM 모두 다중 계층으로 쌓을 경우 옵션 <code>return_sequences = TRUE</code>이 필요하다.</li>
</ul></li>
</ul></li>
<li><code>layer_dropout(0.5)</code>: 드롭아웃 계층
<ul>
<li><code>rate = 0.5</code>: 모든 출력 값 중 50%를 무작위로 비활성화하여 과적합을 방지한다.</li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Bidirection GRU</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))       </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bidirectional</span>(<span class="fu">layer_gru</span>(<span class="at">units =</span> <span class="dv">16</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_6"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_7 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 bidirectional_1 (Bidirectional)                                                          (None, 32)                                                                      2880                          
 dense_7 (Dense)                                                                          (None, 1)                                                                       33                            
========================================================================================================================================================================================================
Total params: 2913 (11.38 KB)
Trainable params: 2913 (11.38 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>bidirectional(layer_gru(units = 16))</code>: 양방향 GRU 계층
<ul>
<li><code>bidirectional</code>: GRU 계층을 양방향으로 학습시킨다.
<ul>
<li>앞방향(Forward): 입력 시퀀스를 처음부터 끝까지 처리한다.<br>
</li>
<li>뒤방향(Backward): 입력 시퀀스를 끝에서 처음까지 처리한다.<br>
</li>
<li>각 방향에서 얻어진 결과를 결합하여 더 풍부한 시퀀스 정보 학습 가능하다.<br>
</li>
</ul></li>
<li><code>layer_gru(units = 16)</code>
<ul>
<li>GRU 계층의 출력 공간 차원은 16이다.<br>
</li>
<li>양방향 학습을 적용하면 최종 출력의 차원은 앞방향(16) + 뒤방향(16) = 32이다.</li>
</ul></li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층 추가
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
</section>
<section id="cnn-1d-gru" class="level4" data-number="16.5.1.5">
<h4 data-number="16.5.1.5" class="anchored" data-anchor-id="cnn-1d-gru"><span class="header-section-number">16.5.1.5</span> CNN 1D + GRU</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>inputs <span class="ot">&lt;-</span> <span class="fu">layer_input</span>(<span class="at">shape =</span> <span class="fu">c</span>(sequence_length, ncol_input_data))      </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>outputs <span class="ot">&lt;-</span> inputs <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_1d</span>(<span class="at">filters =</span> <span class="dv">32</span>, <span class="at">kernel_size =</span> <span class="dv">6</span>, <span class="at">activation =</span> <span class="st">"relu"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_max_pooling_1d</span>(<span class="at">pool_size =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_conv_1d</span>(<span class="at">filters =</span> <span class="dv">32</span>, <span class="at">kernel_size =</span> <span class="dv">3</span>, <span class="at">activation =</span> <span class="st">"relu"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_gru</span>(<span class="at">units =</span> <span class="dv">32</span>, <span class="at">recurrent_dropout =</span> <span class="fl">0.5</span>, <span class="at">return_sequences =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dropout</span>(<span class="fl">0.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_dense</span>(<span class="at">units =</span> <span class="dv">1</span>)                                                 <span class="co"># Default: Linear Activation</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">keras_model</span>(inputs, outputs)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "model_7"
________________________________________________________________________________________________________________________________________________________________________________________________________
 Layer (type)                                                                             Output Shape                                                                    Param #                       
========================================================================================================================================================================================================
 input_8 (InputLayer)                                                                     [(None, 12, 12)]                                                                0                             
 conv1d_3 (Conv1D)                                                                        (None, 7, 32)                                                                   2336                          
 max_pooling1d_1 (MaxPooling1D)                                                           (None, 3, 32)                                                                   0                             
 conv1d_2 (Conv1D)                                                                        (None, 1, 32)                                                                   3104                          
 gru_3 (GRU)                                                                              (None, 1, 32)                                                                   6336                          
 dropout_2 (Dropout)                                                                      (None, 1, 32)                                                                   0                             
 dense_8 (Dense)                                                                          (None, 1, 1)                                                                    33                            
========================================================================================================================================================================================================
Total params: 11809 (46.13 KB)
Trainable params: 11809 (46.13 KB)
Non-trainable params: 0 (0.00 Byte)
________________________________________________________________________________________________________________________________________________________________________________________________________</code></pre>
</div>
</div>
<p><code>코드 설명</code></p>
<ol type="1">
<li><code>layer_conv_1d(filters = 32, kernel_size = 6, activation = "relu")</code>: 1D 컨볼루션 계층
<ul>
<li><code>filters</code>: 콘벌루션 필터 개수를 입력한다.
<ul>
<li>필터 수가 많을수록 더 복잡한 특징을 학습할 수 있지만 계산 비용 증가한다.</li>
</ul></li>
<li><code>kernel_size</code>: 모형이 학습할 데이터 패턴의 시간적 범위(시계열 윈도우 크기)를 결정한다.<br>
</li>
<li><code>activation</code>: 활성화 함수를 입력한다.</li>
</ul></li>
<li><code>layer_max_pooling_1d(pool_size = 2)</code>: 1D Max Pooling 계층 → 시계열 데이터의 차원을 축소
<ul>
<li><code>pool_size</code>(= Max Pooling Window Length)를 “2”로 지정한다.</li>
<li><code>strides</code>의 경우 옵션 <code>pool_size</code>에 입력한 값이 Default(여기서는 2)이다.</li>
<li>두 옵션을 통해 해당 계층에서 입력 데이터의 차원을 절반으로 축소한다.</li>
<li>함수 <code>layer_max_pooling_1d()</code> 다음에 입력한 함수 <code>layer_conv_1d()</code>의 옵션 <code>kernel_size</code>는 절반으로 축소한 “3”으로 지정한다.</li>
</ul></li>
<li><code>layer_gru(units = 32, recurrent_dropout = 0.5, return_sequences = TRUE)</code>: GRU 계층
<ul>
<li><code>units = 32</code>: GRU 계층의 출력 공간 차원은 32차원이다.
<ul>
<li>시계열 데이터를 압축된 32차원 벡터로 표현.<br>
</li>
</ul></li>
<li><code>recurrent_dropout = 0.5</code>: 순환 상태 업데이트 시 50% 뉴런을 무작위로 비활성화하여 과적합 방지한다.<br>
</li>
<li><code>return_sequences = TRUE</code>: 모든 시점(Time Step)에 대한 은닉 상태 출력을 반환한다.
<ul>
<li>이 출력은 다음 계층(드롭아웃 계층)에서 사용된다.</li>
</ul></li>
</ul></li>
<li><code>layer_dropout(0.1)</code>: 드롭아웃 계층
<ul>
<li><code>rate = 0.1</code>: 전체 뉴런 중 10%를 무작위로 비활성화하여 과적합을 방지한다.</li>
</ul></li>
<li><code>layer_dense(units = 1)</code>: Dense 계층
<ul>
<li>회귀 문제(연속형 값 예측)를 해결하기 위해 <code>units = 1</code>로 설정한다.</li>
<li>활성화 함수가 지정되지 않았으므로 선형 활성화 함수(Linear Activation)를 사용한다.</li>
</ul></li>
</ol>
</section>
</section>
<section id="model-compile" class="level3" data-number="16.5.2">
<h3 data-number="16.5.2" class="anchored" data-anchor-id="model-compile"><span class="header-section-number">16.5.2</span> Model Compile</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>model <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compile</span>(<span class="at">optimizer =</span> <span class="st">"rmsprop"</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">loss =</span> <span class="st">"mse"</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">metrics =</span> <span class="st">"mae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fit" class="level3" data-number="16.5.3">
<h3 data-number="16.5.3" class="anchored" data-anchor-id="model-fit"><span class="header-section-number">16.5.3</span> Model Fit</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>history <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(train_dataset,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">epochs =</span> <span class="dv">100</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">validation_data =</span> val_dataset,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">callbacks =</span> callbacks_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
4/4 - 3s - loss: 3015755.5000 - mae: 1729.6298 - val_loss: 3510547.5000 - val_mae: 1867.4125 - lr: 0.0010 - 3s/epoch - 670ms/step
Epoch 2/100
4/4 - 0s - loss: 3011951.5000 - mae: 1728.5303 - val_loss: 3506447.2500 - val_mae: 1866.3142 - lr: 0.0010 - 143ms/epoch - 36ms/step
Epoch 3/100
4/4 - 0s - loss: 3008031.5000 - mae: 1727.3945 - val_loss: 3502763.7500 - val_mae: 1865.3269 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 4/100
4/4 - 0s - loss: 3004926.5000 - mae: 1726.4961 - val_loss: 3499602.5000 - val_mae: 1864.4791 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 5/100
4/4 - 0s - loss: 3002021.5000 - mae: 1725.6591 - val_loss: 3496844.7500 - val_mae: 1863.7393 - lr: 0.0010 - 107ms/epoch - 27ms/step
Epoch 6/100
4/4 - 0s - loss: 2999773.0000 - mae: 1725.0037 - val_loss: 3494691.7500 - val_mae: 1863.1616 - lr: 0.0010 - 102ms/epoch - 26ms/step
Epoch 7/100
4/4 - 0s - loss: 2997919.0000 - mae: 1724.4734 - val_loss: 3492967.7500 - val_mae: 1862.6989 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 8/100
4/4 - 0s - loss: 2996537.0000 - mae: 1724.0734 - val_loss: 3491554.7500 - val_mae: 1862.3195 - lr: 0.0010 - 113ms/epoch - 28ms/step
Epoch 9/100
4/4 - 0s - loss: 2995356.2500 - mae: 1723.7346 - val_loss: 3490382.0000 - val_mae: 1862.0045 - lr: 0.0010 - 106ms/epoch - 26ms/step
Epoch 10/100
4/4 - 0s - loss: 2993795.0000 - mae: 1723.2834 - val_loss: 3489416.7500 - val_mae: 1861.7454 - lr: 0.0010 - 108ms/epoch - 27ms/step
Epoch 11/100
4/4 - 0s - loss: 2993752.2500 - mae: 1723.2705 - val_loss: 3488636.0000 - val_mae: 1861.5358 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 12/100
4/4 - 0s - loss: 2992527.0000 - mae: 1722.9133 - val_loss: 3487957.7500 - val_mae: 1861.3534 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 13/100
4/4 - 0s - loss: 2991723.5000 - mae: 1722.6765 - val_loss: 3487336.5000 - val_mae: 1861.1865 - lr: 0.0010 - 117ms/epoch - 29ms/step
Epoch 14/100
4/4 - 0s - loss: 2991444.0000 - mae: 1722.5984 - val_loss: 3486740.2500 - val_mae: 1861.0264 - lr: 0.0010 - 111ms/epoch - 28ms/step
Epoch 15/100
4/4 - 0s - loss: 2990621.0000 - mae: 1722.3628 - val_loss: 3486084.5000 - val_mae: 1860.8502 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 16/100
4/4 - 0s - loss: 2990892.5000 - mae: 1722.4348 - val_loss: 3485462.0000 - val_mae: 1860.6829 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 17/100
4/4 - 0s - loss: 2989982.5000 - mae: 1722.1741 - val_loss: 3484911.5000 - val_mae: 1860.5350 - lr: 0.0010 - 108ms/epoch - 27ms/step
Epoch 18/100
4/4 - 0s - loss: 2989754.5000 - mae: 1722.1096 - val_loss: 3484394.7500 - val_mae: 1860.3961 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 19/100
4/4 - 0s - loss: 2988716.7500 - mae: 1721.8124 - val_loss: 3483891.0000 - val_mae: 1860.2607 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 20/100
4/4 - 0s - loss: 2988231.0000 - mae: 1721.6699 - val_loss: 3483394.7500 - val_mae: 1860.1274 - lr: 0.0010 - 100ms/epoch - 25ms/step
Epoch 21/100
4/4 - 0s - loss: 2987860.5000 - mae: 1721.5620 - val_loss: 3482908.2500 - val_mae: 1859.9966 - lr: 0.0010 - 100ms/epoch - 25ms/step
Epoch 22/100
4/4 - 0s - loss: 2987233.0000 - mae: 1721.3765 - val_loss: 3482422.5000 - val_mae: 1859.8661 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 23/100
4/4 - 0s - loss: 2987370.7500 - mae: 1721.4136 - val_loss: 3481946.0000 - val_mae: 1859.7379 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 24/100
4/4 - 0s - loss: 2986856.0000 - mae: 1721.2600 - val_loss: 3481468.2500 - val_mae: 1859.6096 - lr: 0.0010 - 114ms/epoch - 28ms/step
Epoch 25/100
4/4 - 0s - loss: 2985938.5000 - mae: 1721.0059 - val_loss: 3480990.5000 - val_mae: 1859.4812 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 26/100
4/4 - 0s - loss: 2985030.7500 - mae: 1720.7338 - val_loss: 3480509.0000 - val_mae: 1859.3516 - lr: 0.0010 - 102ms/epoch - 25ms/step
Epoch 27/100
4/4 - 0s - loss: 2985316.5000 - mae: 1720.8207 - val_loss: 3480035.7500 - val_mae: 1859.2242 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 28/100
4/4 - 0s - loss: 2985155.7500 - mae: 1720.7756 - val_loss: 3479565.0000 - val_mae: 1859.0977 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 29/100
4/4 - 0s - loss: 2984509.0000 - mae: 1720.5854 - val_loss: 3479091.5000 - val_mae: 1858.9703 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 30/100
4/4 - 0s - loss: 2984135.5000 - mae: 1720.4786 - val_loss: 3478618.2500 - val_mae: 1858.8430 - lr: 0.0010 - 109ms/epoch - 27ms/step
Epoch 31/100
4/4 - 0s - loss: 2983686.0000 - mae: 1720.3494 - val_loss: 3478145.2500 - val_mae: 1858.7158 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 32/100
4/4 - 0s - loss: 2983551.7500 - mae: 1720.3069 - val_loss: 3477675.0000 - val_mae: 1858.5892 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 33/100
4/4 - 0s - loss: 2982203.5000 - mae: 1719.9174 - val_loss: 3477195.2500 - val_mae: 1858.4601 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 34/100
4/4 - 0s - loss: 2982147.2500 - mae: 1719.8997 - val_loss: 3476721.7500 - val_mae: 1858.3330 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 35/100
4/4 - 0s - loss: 2981973.5000 - mae: 1719.8481 - val_loss: 3476249.7500 - val_mae: 1858.2058 - lr: 0.0010 - 100ms/epoch - 25ms/step
Epoch 36/100
4/4 - 0s - loss: 2981239.0000 - mae: 1719.6362 - val_loss: 3475774.0000 - val_mae: 1858.0778 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 37/100
4/4 - 0s - loss: 2980859.0000 - mae: 1719.5327 - val_loss: 3475302.0000 - val_mae: 1857.9507 - lr: 0.0010 - 106ms/epoch - 27ms/step
Epoch 38/100
4/4 - 0s - loss: 2980679.0000 - mae: 1719.4746 - val_loss: 3474832.2500 - val_mae: 1857.8245 - lr: 0.0010 - 137ms/epoch - 34ms/step
Epoch 39/100
4/4 - 0s - loss: 2980071.0000 - mae: 1719.2957 - val_loss: 3474356.0000 - val_mae: 1857.6963 - lr: 0.0010 - 118ms/epoch - 29ms/step
Epoch 40/100
4/4 - 0s - loss: 2979003.0000 - mae: 1718.9803 - val_loss: 3473879.0000 - val_mae: 1857.5677 - lr: 0.0010 - 107ms/epoch - 27ms/step
Epoch 41/100
4/4 - 0s - loss: 2978961.0000 - mae: 1718.9763 - val_loss: 3473404.7500 - val_mae: 1857.4402 - lr: 0.0010 - 111ms/epoch - 28ms/step
Epoch 42/100
4/4 - 0s - loss: 2978741.5000 - mae: 1718.9108 - val_loss: 3472931.5000 - val_mae: 1857.3129 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 43/100
4/4 - 0s - loss: 2978480.5000 - mae: 1718.8389 - val_loss: 3472461.2500 - val_mae: 1857.1862 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 44/100
4/4 - 0s - loss: 2977611.0000 - mae: 1718.5801 - val_loss: 3471985.2500 - val_mae: 1857.0579 - lr: 0.0010 - 109ms/epoch - 27ms/step
Epoch 45/100
4/4 - 0s - loss: 2977508.2500 - mae: 1718.5557 - val_loss: 3471512.7500 - val_mae: 1856.9307 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 46/100
4/4 - 0s - loss: 2976562.0000 - mae: 1718.2742 - val_loss: 3471039.2500 - val_mae: 1856.8033 - lr: 0.0010 - 106ms/epoch - 26ms/step
Epoch 47/100
4/4 - 0s - loss: 2976689.0000 - mae: 1718.3075 - val_loss: 3470570.0000 - val_mae: 1856.6769 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 48/100
4/4 - 0s - loss: 2976037.0000 - mae: 1718.1287 - val_loss: 3470096.2500 - val_mae: 1856.5493 - lr: 0.0010 - 153ms/epoch - 38ms/step
Epoch 49/100
4/4 - 0s - loss: 2975215.5000 - mae: 1717.8835 - val_loss: 3469620.5000 - val_mae: 1856.4211 - lr: 0.0010 - 109ms/epoch - 27ms/step
Epoch 50/100
4/4 - 0s - loss: 2975328.0000 - mae: 1717.9236 - val_loss: 3469149.5000 - val_mae: 1856.2942 - lr: 0.0010 - 101ms/epoch - 25ms/step
Epoch 51/100
4/4 - 0s - loss: 2974362.5000 - mae: 1717.6335 - val_loss: 3468673.7500 - val_mae: 1856.1661 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 52/100
4/4 - 0s - loss: 2974627.0000 - mae: 1717.7124 - val_loss: 3468205.0000 - val_mae: 1856.0399 - lr: 0.0010 - 100ms/epoch - 25ms/step
Epoch 53/100
4/4 - 0s - loss: 2973422.0000 - mae: 1717.3574 - val_loss: 3467730.0000 - val_mae: 1855.9119 - lr: 0.0010 - 106ms/epoch - 26ms/step
Epoch 54/100
4/4 - 0s - loss: 2973426.5000 - mae: 1717.3634 - val_loss: 3467259.0000 - val_mae: 1855.7852 - lr: 0.0010 - 113ms/epoch - 28ms/step
Epoch 55/100
4/4 - 0s - loss: 2972886.0000 - mae: 1717.2109 - val_loss: 3466784.7500 - val_mae: 1855.6572 - lr: 0.0010 - 112ms/epoch - 28ms/step
Epoch 56/100
4/4 - 0s - loss: 2972549.7500 - mae: 1717.1045 - val_loss: 3466313.7500 - val_mae: 1855.5303 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 57/100
4/4 - 0s - loss: 2972050.5000 - mae: 1716.9619 - val_loss: 3465840.2500 - val_mae: 1855.4028 - lr: 0.0010 - 102ms/epoch - 25ms/step
Epoch 58/100
4/4 - 0s - loss: 2971238.5000 - mae: 1716.7275 - val_loss: 3465365.2500 - val_mae: 1855.2747 - lr: 0.0010 - 103ms/epoch - 26ms/step
Epoch 59/100
4/4 - 0s - loss: 2971871.2500 - mae: 1716.9055 - val_loss: 3464897.0000 - val_mae: 1855.1484 - lr: 0.0010 - 108ms/epoch - 27ms/step
Epoch 60/100
4/4 - 0s - loss: 2970549.2500 - mae: 1716.5258 - val_loss: 3464422.7500 - val_mae: 1855.0206 - lr: 0.0010 - 136ms/epoch - 34ms/step
Epoch 61/100
4/4 - 0s - loss: 2970675.0000 - mae: 1716.5710 - val_loss: 3463953.0000 - val_mae: 1854.8940 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 62/100
4/4 - 0s - loss: 2970028.0000 - mae: 1716.3696 - val_loss: 3463480.2500 - val_mae: 1854.7666 - lr: 0.0010 - 117ms/epoch - 29ms/step
Epoch 63/100
4/4 - 0s - loss: 2969632.0000 - mae: 1716.2531 - val_loss: 3463010.0000 - val_mae: 1854.6398 - lr: 0.0010 - 120ms/epoch - 30ms/step
Epoch 64/100
4/4 - 0s - loss: 2969028.5000 - mae: 1716.0813 - val_loss: 3462535.7500 - val_mae: 1854.5121 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 65/100
4/4 - 0s - loss: 2968761.5000 - mae: 1716.0060 - val_loss: 3462064.7500 - val_mae: 1854.3851 - lr: 0.0010 - 104ms/epoch - 26ms/step
Epoch 66/100
4/4 - 0s - loss: 2967757.0000 - mae: 1715.7211 - val_loss: 3461590.0000 - val_mae: 1854.2570 - lr: 0.0010 - 109ms/epoch - 27ms/step
Epoch 67/100
4/4 - 0s - loss: 2967677.7500 - mae: 1715.6912 - val_loss: 3461116.5000 - val_mae: 1854.1294 - lr: 0.0010 - 119ms/epoch - 30ms/step
Epoch 68/100
4/4 - 0s - loss: 2967094.5000 - mae: 1715.5277 - val_loss: 3460642.7500 - val_mae: 1854.0016 - lr: 0.0010 - 119ms/epoch - 30ms/step
Epoch 69/100
4/4 - 0s - loss: 2966265.7500 - mae: 1715.2784 - val_loss: 3460166.0000 - val_mae: 1853.8732 - lr: 0.0010 - 124ms/epoch - 31ms/step
Epoch 70/100
4/4 - 0s - loss: 2966430.7500 - mae: 1715.3225 - val_loss: 3459696.0000 - val_mae: 1853.7463 - lr: 0.0010 - 105ms/epoch - 26ms/step
Epoch 71/100
4/4 - 0s - loss: 2965965.7500 - mae: 1715.1929 - val_loss: 3459226.0000 - val_mae: 1853.6195 - lr: 0.0010 - 106ms/epoch - 26ms/step
Epoch 72/100
4/4 - 0s - loss: 2965601.5000 - mae: 1715.0746 - val_loss: 3458754.7500 - val_mae: 1853.4924 - lr: 0.0010 - 108ms/epoch - 27ms/step
Epoch 73/100
4/4 - 0s - loss: 2965912.5000 - mae: 1715.1731 - val_loss: 3458287.0000 - val_mae: 1853.3662 - lr: 0.0010 - 110ms/epoch - 27ms/step
Epoch 74/100
4/4 - 0s - loss: 2964489.0000 - mae: 1714.7600 - val_loss: 3457813.2500 - val_mae: 1853.2383 - lr: 0.0010 - 106ms/epoch - 26ms/step
Epoch 75/100
4/4 - 0s - loss: 2964205.5000 - mae: 1714.6759 - val_loss: 3457341.0000 - val_mae: 1853.1108 - lr: 0.0010 - 136ms/epoch - 34ms/step
Epoch 76/100
4/4 - 0s - loss: 2963915.7500 - mae: 1714.5992 - val_loss: 3456870.0000 - val_mae: 1852.9839 - lr: 0.0010 - 121ms/epoch - 30ms/step
Epoch 77/100
4/4 - 0s - loss: 2963873.0000 - mae: 1714.5830 - val_loss: 3456401.0000 - val_mae: 1852.8572 - lr: 0.0010 - 114ms/epoch - 28ms/step
Epoch 78/100
4/4 - 0s - loss: 2963063.0000 - mae: 1714.3423 - val_loss: 3455927.5000 - val_mae: 1852.7295 - lr: 0.0010 - 109ms/epoch - 27ms/step
Epoch 79/100
4/4 - 0s - loss: 2962893.5000 - mae: 1714.2915 - val_loss: 3455456.0000 - val_mae: 1852.6023 - lr: 0.0010 - 107ms/epoch - 27ms/step
Epoch 80/100
4/4 - 0s - loss: 2961861.5000 - mae: 1713.9924 - val_loss: 3454981.5000 - val_mae: 1852.4741 - lr: 0.0010 - 118ms/epoch - 30ms/step
Epoch 81/100
4/4 - 0s - loss: 2961676.0000 - mae: 1713.9305 - val_loss: 3454507.5000 - val_mae: 1852.3463 - lr: 0.0010 - 118ms/epoch - 29ms/step
Epoch 82/100
4/4 - 0s - loss: 2962104.7500 - mae: 1714.0554 - val_loss: 3454041.0000 - val_mae: 1852.2202 - lr: 0.0010 - 163ms/epoch - 41ms/step
Epoch 83/100
4/4 - 0s - loss: 2960754.2500 - mae: 1713.6653 - val_loss: 3453566.5000 - val_mae: 1852.0923 - lr: 0.0010 - 132ms/epoch - 33ms/step
Epoch 84/100
4/4 - 0s - loss: 2960101.0000 - mae: 1713.4835 - val_loss: 3453092.5000 - val_mae: 1851.9642 - lr: 0.0010 - 112ms/epoch - 28ms/step
Epoch 85/100
4/4 - 0s - loss: 2960013.2500 - mae: 1713.4487 - val_loss: 3452621.2500 - val_mae: 1851.8369 - lr: 0.0010 - 111ms/epoch - 28ms/step
Epoch 86/100
4/4 - 0s - loss: 2959677.7500 - mae: 1713.3535 - val_loss: 3452150.2500 - val_mae: 1851.7100 - lr: 0.0010 - 157ms/epoch - 39ms/step
Epoch 87/100
4/4 - 0s - loss: 2958939.7500 - mae: 1713.1428 - val_loss: 3451677.7500 - val_mae: 1851.5823 - lr: 0.0010 - 113ms/epoch - 28ms/step
Epoch 88/100
4/4 - 0s - loss: 2958942.2500 - mae: 1713.1335 - val_loss: 3451208.7500 - val_mae: 1851.4557 - lr: 0.0010 - 118ms/epoch - 29ms/step
Epoch 89/100
4/4 - 0s - loss: 2957843.5000 - mae: 1712.8151 - val_loss: 3450735.2500 - val_mae: 1851.3278 - lr: 0.0010 - 160ms/epoch - 40ms/step
Epoch 90/100
4/4 - 0s - loss: 2957929.7500 - mae: 1712.8333 - val_loss: 3450264.7500 - val_mae: 1851.2006 - lr: 0.0010 - 123ms/epoch - 31ms/step
Epoch 91/100
4/4 - 0s - loss: 2957277.2500 - mae: 1712.6523 - val_loss: 3449792.2500 - val_mae: 1851.0731 - lr: 0.0010 - 121ms/epoch - 30ms/step
Epoch 92/100
4/4 - 0s - loss: 2957049.0000 - mae: 1712.5824 - val_loss: 3449321.0000 - val_mae: 1850.9458 - lr: 0.0010 - 115ms/epoch - 29ms/step
Epoch 93/100
4/4 - 0s - loss: 2955694.5000 - mae: 1712.1943 - val_loss: 3448846.0000 - val_mae: 1850.8174 - lr: 0.0010 - 121ms/epoch - 30ms/step
Epoch 94/100
4/4 - 0s - loss: 2955342.2500 - mae: 1712.0889 - val_loss: 3448371.2500 - val_mae: 1850.6891 - lr: 0.0010 - 115ms/epoch - 29ms/step
Epoch 95/100
4/4 - 0s - loss: 2955005.5000 - mae: 1711.9946 - val_loss: 3447898.7500 - val_mae: 1850.5615 - lr: 0.0010 - 120ms/epoch - 30ms/step
Epoch 96/100
4/4 - 0s - loss: 2955957.0000 - mae: 1712.2617 - val_loss: 3447433.5000 - val_mae: 1850.4358 - lr: 0.0010 - 113ms/epoch - 28ms/step
Epoch 97/100
4/4 - 0s - loss: 2954982.5000 - mae: 1711.9825 - val_loss: 3446963.7500 - val_mae: 1850.3088 - lr: 0.0010 - 115ms/epoch - 29ms/step
Epoch 98/100
4/4 - 0s - loss: 2954086.7500 - mae: 1711.7157 - val_loss: 3446490.0000 - val_mae: 1850.1808 - lr: 0.0010 - 118ms/epoch - 29ms/step
Epoch 99/100
4/4 - 0s - loss: 2953425.2500 - mae: 1711.5334 - val_loss: 3446017.7500 - val_mae: 1850.0532 - lr: 0.0010 - 112ms/epoch - 28ms/step
Epoch 100/100
4/4 - 0s - loss: 2953116.0000 - mae: 1711.4209 - val_loss: 3445544.7500 - val_mae: 1849.9253 - lr: 0.0010 - 111ms/epoch - 28ms/step</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(history, <span class="at">metrics =</span> <span class="st">"mae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DL_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">local</span>({</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">plot</span>(history, <span class="at">metrics =</span> <span class="st">"mae"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  p<span class="sc">$</span>data <span class="sc">%&lt;&gt;%</span> .[.<span class="sc">$</span>epoch <span class="sc">&gt;</span> <span class="dv">1</span>, ]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DL_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 훈련된 최종 모형 저장</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save_model_tf</span>(model, <span class="at">filepath=</span><span class="st">"model1.keras"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-evaluate" class="level3" data-number="16.5.4">
<h3 data-number="16.5.4" class="anchored" data-anchor-id="model-evaluate"><span class="header-section-number">16.5.4</span> Model Evaluate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Test MAE: %.2f"</span>, <span class="fu">evaluate</span>(model, test_dataset)[<span class="st">"mae"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 - 0s - loss: 3609287.5000 - mae: 1895.1899 - 58ms/epoch - 58ms/step</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test MAE: 1895.19"</code></pre>
</div>
</div>
</section>
<section id="prediction" class="level3" data-number="16.5.5">
<h3 data-number="16.5.5" class="anchored" data-anchor-id="prediction"><span class="header-section-number">16.5.5</span> Prediction</h3>
<ul>
<li>함수 <code>predict()</code>를 이용하여 Test Dataset에 대한 예측을 수행한다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 훈련된 최종 모형에 대한 예측</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> model <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(test_dataset)                     <span class="co"># In 3-1. test_dataset: (Input, Target) Dataset으로 분할된 TeD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 - 0s - 344ms/epoch - 344ms/step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1

          [,1]
 [1,] 18.70679
 [2,] 18.70679
 [3,] 18.70679
 [4,] 18.70679
 [5,] 18.70679
 [6,] 18.70679
 [7,] 18.70679
 [8,] 18.70679
 [9,] 18.70679</code></pre>
</div>
</div>
<p><code>Caution!</code> 딥러닝 기법을 시계열 데이터에 적용할 때 Training Dataset 뿐만 아니라 Test Dataset도 <code>(Input, Target) Dataset으로 분할</code>한다. 그리고 Test Dataset의 모든 Index에 대해 예측을 수행하는 것이 아니라 Target에 해당하는 Index에 대해서만 예측값을 생성한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best Model Loading</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">load_model_tf</span>(<span class="st">"Amtrack.keras"</span>)    <span class="co"># 자동 저장된 Best model Loading</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Best Model에 대한 예측</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>predictions1 <span class="ot">&lt;-</span> model1 <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(test_dataset)                     <span class="co"># In 3-1. test_dataset: (Input, Target) Dataset으로 분할된 TeD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 - 0s - 327ms/epoch - 327ms/step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>predictions1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>, , 1

          [,1]
 [1,] 18.70679
 [2,] 18.70679
 [3,] 18.70679
 [4,] 18.70679
 [5,] 18.70679
 [6,] 18.70679
 [7,] 18.70679
 [8,] 18.70679
 [9,] 18.70679</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Actual Values Corresponding to Prediction Values </span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>num_last <span class="ot">&lt;-</span> <span class="fu">NROW</span>(test_df<span class="sc">$</span>Ridership) <span class="sc">-</span> <span class="fu">NROW</span>(predictions) <span class="sc">-</span> delay         </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> test_df<span class="sc">$</span>Ridership <span class="sc">%&gt;%</span>                                          <span class="co"># test_df$Ridership : Target</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="sc">-</span>delay) <span class="sc">%&gt;%</span>                                                       <span class="co"># Drop First Delay Samples Because Index of Target Starts from 1+delay            </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="sc">-</span>num_last)                                                        <span class="co"># Drop Last 11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Caution!</code> 위에서 언급했듯이 Test Dataset의 모든 Index에 대해 예측을 수행하는 것이 아니라 (Input, Target) Dataset으로 분할하고, Target에 해당하는 Index에 대해서만 예측값을 생성한다. 그래서 함수 <code>predict()</code>을 통해 생성한 예측값에 대응하는 실제값만 남겨두기 위해 위의 코드를 수행한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NROW</span>(predictions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">NROW</span>(test_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy using MAE</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>MAE <span class="ot">&lt;-</span> <span class="fu">mean</span>( <span class="fu">abs</span>(predictions<span class="sc">-</span>test_y) )</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>MAE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1895.19</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy using MSE</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>( (predictions<span class="sc">-</span>test_y)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>MSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3609287</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction Result Plot</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(predictions, <span class="at">type =</span> <span class="st">"l"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( test_y, <span class="at">col=</span><span class="st">"blue"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DL_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(test_y, predictions, <span class="at">xlab =</span> <span class="st">"Observation"</span>, <span class="at">ylab =</span> <span class="st">"Prediction"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="DL_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ML.html" class="pagination-link" aria-label="Machine Learning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Machine Learning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Imputation.html" class="pagination-link" aria-label="Imputation using Kalman Smoothing">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Imputation using Kalman Smoothing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/JJJJYE/TS/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>